[
  {
    "number": 5742,
    "title": "Users suddenly not able to load Admin Managed Add-Ins",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC Desktop\n* Host [Excel, Word, PowerPoint, etc.]: Word\n* Operating System: Windows\n* Browser (if using Office on the web): Chrome\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nOffice Add-Ins load successfully or users are able to add their Admin-Managed add-ins.\n\n## Current behavior\nStarting from a few months ago but increasing in volume since late last week, we've had several users have issues with their Word Add-In disappearing and being unable to add the add-in back in. For two of our users, we know that they got an error **\"Add in error. You don't have permission to use this add-in. Contact your system administrator to request access\"** initially, but nothing has changed in terms of permissions for them. After they get this error, they are unable to retrieve any admin managed add-ins and the add-ins are removed from the ribbon bar.\n\n## Steps to reproduce\n1. Distribute Add-In via Integrated Apps to entire organization.\n2. Attempt to load the Add-In in Word\n3. Either the user gets an error that they don't have permissions or they cannot add the Add-In.\n\n# Provide additional details\nUsers have cleared their office cache, logged out and logged back in, and nothing has worked. We have also tried to use Word Online and some of the users see the add-in online but others do not.\n\n## Context\nUsers are unable to use the Word Add-In and affected by their productivity currently.\n",
    "created_at": "2025-05-21T05:58:36Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Word",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "richard6094",
    "comments": [
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "Thank you for letting us know about this issue. We will take a look shortly. Thanks.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-21T05:58:51Z"
      },
      {
        "author": "github-actions[bot]",
        "body": "## Regression Analysis Needs Your Input\n\nOur automated system analyzed this issue but couldn't determine with confidence if this is a regression bug.\n\nA regression bug is when **functionality that previously worked properly no longer works** after a recent change.\n\n**If you believe this is a regression issue, please confirm below:**\n\n- [ ] Yes, confirm this is a regression issue\n\n<!-- comment_id:5742:OfficeDev:office-js -->\n\n> Note: Once confirmed, the issue will be labeled as regression.\n> After selecting the option, your choice will be automatically processed.\n\n---\n",
        "created_at": "2025-05-21T05:59:13Z"
      },
      {
        "author": "richard6094",
        "body": "Test issue",
        "created_at": "2025-05-21T05:59:41Z"
      },
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #5737\n- #5708\n- #5736\n- #1128\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nCheck the permission for your end user. It seems that the central deploy scenario works well for others, so verifying permissions might resolve the issue.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5708#issuecomment-2882833430\n### Solution 2:\nThe issue has been put on the backlog for internal tracking. It is being monitored for updates, so staying informed about any progress or fixes from the development team might be helpful.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5708#issuecomment-2893151859\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-05-21T06:00:37Z"
      }
    ]
  },
  {
    "number": 5737,
    "title": "[Test]Users suddenly not able to load Admin Managed Add-Ins_1",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC Desktop\n* Host [Excel, Word, PowerPoint, etc.]: Word\n* Operating System: Windows\n* Browser (if using Office on the web): Chrome\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nOffice Add-Ins load successfully or users are able to add their Admin-Managed add-ins.\n\n## Current behavior\nStarting from a few months ago but increasing in volume since late last week, we've had several users have issues with their Word Add-In disappearing and being unable to add the add-in back in. For two of our users, we know that they got an error **\"Add in error. You don't have permission to use this add-in. Contact your system administrator to request access\"** initially, but nothing has changed in terms of permissions for them. After they get this error, they are unable to retrieve any admin managed add-ins and the add-ins are removed from the ribbon bar.\n\n## Steps to reproduce\n1. Distribute Add-In via Integrated Apps to entire organization.\n2. Attempt to load the Add-In in Word\n3. Either the user gets an error that they don't have permissions or they cannot add the Add-In.\n\n# Provide additional details\nUsers have cleared their office cache, logged out and logged back in, and nothing has worked. We have also tried to use Word Online and some of the users see the add-in online but others do not.\n\n## Context\nUsers are unable to use the Word Add-In and affected by their productivity currently.\n",
    "created_at": "2025-05-20T08:14:55Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Word",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "richard6094",
    "comments": [
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "Thank you for letting us know about this issue. We will take a look shortly. Thanks.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-20T08:15:11Z"
      },
      {
        "author": "github-actions[bot]",
        "body": "## Regression Analysis Needs Your Input\n\nOur automated system analyzed this issue but couldn't determine with confidence if this is a regression bug.\n\nA regression bug is when **functionality that previously worked properly no longer works** after a recent change.\n\n**If you believe this is a regression issue, please confirm below:**\n\n- [ ] Yes, confirm this is a regression issue\n\n<!-- comment_id:5737:OfficeDev:office-js -->\n\n> Note: Once confirmed, the issue will be labeled as regression.\n> After selecting the option, your choice will be automatically processed.\n\n---\n",
        "created_at": "2025-05-20T08:15:35Z"
      },
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #5736\n- #5708\n- #1128\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nI tested the central deploy scenario. It works well. And no other developer reported this issue. Could you please check the permission for your end user?\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5708#issuecomment-2882833430\n### Solution 2:\nThanks for reporting this issue. It has been put on our backlog<incident#631749556> for internal track. We will keep track of this issue and let you know if there are any updates.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5708#issuecomment-2893151859\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-05-20T08:16:15Z"
      },
      {
        "author": "richard6094",
        "body": "Test complete and close.",
        "created_at": "2025-05-20T08:16:40Z"
      }
    ]
  },
  {
    "number": 5736,
    "title": "[Test]Users suddenly not able to load Admin Managed Add-Ins",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC Desktop\n* Host [Excel, Word, PowerPoint, etc.]: Word\n* Operating System: Windows\n* Browser (if using Office on the web): Chrome\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nOffice Add-Ins load successfully or users are able to add their Admin-Managed add-ins.\n\n## Current behavior\nStarting from a few months ago but increasing in volume since late last week, we've had several users have issues with their Word Add-In disappearing and being unable to add the add-in back in. For two of our users, we know that they got an error **\"Add in error. You don't have permission to use this add-in. Contact your system administrator to request access\"** initially, but nothing has changed in terms of permissions for them. After they get this error, they are unable to retrieve any admin managed add-ins and the add-ins are removed from the ribbon bar.\n\n## Steps to reproduce\n1. Distribute Add-In via Integrated Apps to entire organization.\n2. Attempt to load the Add-In in Word\n3. Either the user gets an error that they don't have permissions or they cannot add the Add-In.\n\n# Provide additional details\nUsers have cleared their office cache, logged out and logged back in, and nothing has worked. We have also tried to use Word Online and some of the users see the add-in online but others do not.\n\n## Context\nUsers are unable to use the Word Add-In and affected by their productivity currently.\n",
    "created_at": "2025-05-20T08:12:28Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Word",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "richard6094",
    "comments": [
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "Thank you for letting us know about this issue. We will take a look shortly. Thanks.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-20T08:12:40Z"
      },
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #5708\n- #1128\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nI tested the central deploy scenario. It works well. And no other developer reported this issue. Could you please check the permission for your end user?\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5708#issuecomment-2882833430\n### Solution 2:\nThanks for reporting this issue. It has been put on our backlog for internal track. We will keep track of this issue and let you know if there are any updates.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5708#issuecomment-2893151859\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-05-20T08:13:43Z"
      },
      {
        "author": "richard6094",
        "body": "Test issue.",
        "created_at": "2025-05-20T08:14:52Z"
      }
    ]
  },
  {
    "number": 5735,
    "title": "getAnnotations reported as not implemented",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: macOS\n* Host [Excel, Word, PowerPoint, etc.]: Word\n* Office version number: 16.96.2\n* Operating System: MacOS Sonoma 14.6.1\n* Browser (if using Office on the web): -\n \n## Expected behavior\n`getAnnotations()` should be available. \n\n\n## Current behavior\nWe check if the user has WordAPI 1.8 or higher like that:\n```\nconst isSupported = Office.context.requirements.isSetSupported( \"WordApi\", \"1.8\");\n```\nThis is retuned as true. Also, according to [the version overview](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/word/word-api-requirement-sets?view=common-js-preview), this should be supported im Office 16.96.2 on macOS. \n\nBut one of our users gets a this error any-ways: \n\n![Image](https://github.com/user-attachments/assets/fc159164-0d5f-4d54-93c1-4fe4a9843e63)\n\n\n## Steps to reproduce\nJust open that addin on that OS/Word version combination: https://appsource.microsoft.com/de-de/product/office/wa200005451?tab=overview  \n\n## Link to live example(s)\n- version check: https://github.com/farscrl/spellchecker-addin-office/blob/main/src/app/app.component.ts#L29\n- `getAnnotations` call: https://github.com/farscrl/spellchecker-addin-office/blob/f231904726790d74327460893987ba285ad7ed04/src/app/services/word-api.service.ts#L175 \n\n# Provide additional details\n- \n\n## Context\nThis leads to a crash in the add-in. We have introduced a special check for this and show a version of the addin not using the `getAnnotations` API. But if the isSetSupported API reports wrong information, the fallback is not used.\n\nCan you clarify, if the isSetSupported() return value is wrong on that Word Version, or if the error that `getAnnations` is not implemented is wrong? Both can't be right at the same time. \n\n## Useful logs\nSee screenshot \n",
    "created_at": "2025-05-20T07:58:34Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Word",
      "Similar-Issue"
    ],
    "author": "richard6094",
    "comments": [
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "Thank you for letting us know about this issue. We will take a look shortly. Thanks.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-20T07:58:50Z"
      },
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #5701\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-05-20T07:59:16Z"
      },
      {
        "author": "richard6094",
        "body": "test issue. closed.",
        "created_at": "2025-05-20T07:59:42Z"
      }
    ]
  },
  {
    "number": 5722,
    "title": "Outlook addin not working in Outlook for Android",
    "body": "Hello,\n\nthis is a continuation of issue number #5352 which got wrongly closed for inactivity and i am not able to reopen the issue myself. This issue still persists, i tested it again yesterday.\n\nAll the info regarding this problem is in the linked issue above, could you please reopen it and close this one so we can continue our solution in the previous ticket?\n\nThanks!\n",
    "created_at": "2025-05-16T08:07:20Z",
    "state": "closed",
    "labels": [
      "Area: Outlook"
    ],
    "author": "ZeeCapp",
    "comments": [
      {
        "author": "mmanjaree-msft",
        "body": "@ZeeCapp Please share the credentials. Let us followup on https://github.com/OfficeDev/office-js/issues/5352 and close this one as duplicate",
        "created_at": "2025-05-16T10:23:39Z"
      }
    ]
  },
  {
    "number": 5720,
    "title": "Differentiating OS and App type for New Outlook for Javascript Addin",
    "body": "If Addin needs to work on Windows / Mac and native application, getting those info from Office variables is needed.\n\n## Your Environment\n* Platform : Windows, Mac, Browser\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Office version number: \n\n**Microsoft Outlook Version: 1.2025.506.300 (Production)\nClient Version: 20250502003.08\nWebView2 Version: 136.0.3240.64\nSession ID: f1e762a5-c80d-fc4d-8d23-7d041fb46ab7**\n\n* Operating System: Windows, Mac\n* Browser (if using Office on the web): Firefox, Chrome, Microsoft Edge\n \n## Expected behavior\n\nAre these the right variables to get below data ?\nOr any other variables available ?\n\n## Current behavior\n\nOffice.context.platform ( Mac or OfficeOnline )\nOffice.context.mailbox.diagnostics.hostName ( OutlookWebApp )\nOffice.context.mailbox.diagnostics.hostVersion ( 20250502003.08 )\n",
    "created_at": "2025-05-15T20:39:19Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Outlook"
    ],
    "author": "mkondadg",
    "comments": [
      {
        "author": "millerds",
        "body": "Those should be the right things to look at.",
        "created_at": "2025-05-16T18:21:01Z"
      }
    ]
  },
  {
    "number": 5719,
    "title": "Comments Before Class Method Errors",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Adding Comments Before Class Methods ONLY that use ExcelScript / console.log() are causing errors\n\n> This issue provides more context to [a previously marked resolved bug](https://github.com/OfficeDev/office-js/issues/4005)\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform: PC Desktop\n* Host Excel\n* Office version number:  2502\n* Operating System: Windows\n \n## Expected behavior\nComments shouldn't change functionality of code\n\n## Current behavior\nPre-method comments/JSDocs cause a crash with a non-useful error message \"Unexpected Identifier\". **This always happens when the method includes `console.log`** and occurs seemingly randomly when using anything from the *ExcelScript* namespace. The method works when the comment is not there, and other methods (Not using ExcelScript/console) have no problems with comments in front.\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. Copy the following code into an Office Script. It will run successfully\n\n```ts\nclass DataFrame {\n    values: string[];\n\n    constructor() {\n        this.values = [];\n    }\n    \n    //Methods that don't use console or ExcelScript are fine with comments\n    append(val:string){\n        this.values.push(val);\n    }\n    \n    print() {\n        console.log(this.values)\n    }\n}\nfunction main(workbook: ExcelScript.Workbook) {\n    \n}\n```\n2. Add a comment on line 12 before the `print()` method. This will cause an error on run.\n3. I couldn't reproduce the error with ExcelScript methods in a small case, but I am facing similar issues for some ExcelScript method calls with no console interaction. *See Original Error Context Image below*\n\n> Notes:\n>No Data is needed to reproduce this, and the crash occurs even if the class is never constructed/the method is never called.\n>\n>Errors persist whether the class is defined inside or outside of `main`\n\n\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\nI have built a [pandas-like DataFrame for Excel Scripts](https://joeyrussoniello.github.io/frosts/), and was adding JSDocs for its methods when I encountered this error. Obviously this concept is definitely pushing it for office-js, but I work with a client that uses PowerAutomate as their sole ETL pipelineand I found myself frequently writing similar code to clean dirty Excel Data, so I built this! The fact that the error is reproducible in small cases is why I submitted the issue. \n\nFor more examples of failure, you can try adding a comment before ANY of the methods that don't have a JSDoc in [frosts.ts](https://github.com/JoeyRussoniello/frosts/blob/main/frosts.ts) or [frosts.osts](https://github.com/JoeyRussoniello/frosts/blob/main/frosts.osts), such as `print`, `to_worksheet`, `snapshot`, `to_table`, etc. They almost all have a different `unexpected identifier`.\n\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [X] Console errors: I've gotten `Unexpected identifier this`, `unexpected identifier: values`, `unexpected identifier: ___engine`, and `unexpected identifier: console` \n- [X] Screenshots\n\n### Working Comment for non logging method\n\n![Image](https://github.com/user-attachments/assets/5a06682b-be1f-499f-9989-6a3d717305bf)\n\n### Adding Comment\n\n![Image](https://github.com/user-attachments/assets/565af400-85eb-4e6a-96c9-074900f75f85)\n\n### Changing Line Spacing and Semi-Colons for easier parsing doesn't fix\n![Image](https://github.com/user-attachments/assets/08d89897-ce1c-4224-8474-f430f437518e)\n\n### Error persists in main\n![Image](https://github.com/user-attachments/assets/99881a4b-b779-4a96-bcb4-f1752a5b1113)\n\n### Helper Methods Don't Solve the issue either\n\n![Image](https://github.com/user-attachments/assets/c2fd791b-8d14-44b7-9940-aad161b6b0a3)\n\n### Original Error Context\n\n![Image](https://github.com/user-attachments/assets/096b9c23-0095-4f9b-acc5-fe7b9a492d94)\n",
    "created_at": "2025-05-15T18:44:26Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "JoeyRussoniello",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #4005\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nWe have a super annoying bug in our infrastructure. While we work on a fix, here are some unappealing workarounds:\n\n- Skip adding comments before class methods that use Office Script APIs.\n- Mark class methods in which you use Office Script APIs as `async`. (see example)\n\nExample modified to mark method `bar` as `async`.\n\n```typescript\nclass Foo {\n    range: ExcelScript.Range;\n\n    // Comment\n    // MODIFY: mark as async\n    async bar() {\n        return this.range.getValues();\n    }\n}\n\n// MODIFY: mark as async\nasync function main(workbook: ExcelScript.Workbook) {\n    const foo = new Foo();\n    foo.range = workbook.getActiveCell();\n\n    // MODIFY: example call with async\n    const values = await foo.bar();\n    console.log(values);\n\n    console.log(\"Success\");\n}\n```\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4005#issuecomment-1898846635\n### Solution 2:\nThanks for the response! I can confirm that changing the methods to async does solve the issue but would still be better if it worked as expected.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4005#issuecomment-1904412850\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-05-15T19:04:32Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi Could you please try the above workaround?",
        "created_at": "2025-05-21T05:18:57Z"
      },
      {
        "author": "JoeyRussoniello",
        "body": "Yep! The workaround does still work. It's not great for my desired use-case since it's a pretty large class designed to make scripting a little easier and adding seeming random await calls instead of just not having JSDocs seems worse. Just wanted to share the issue to give more context on when the annoying bug with method comments happens (only before ExcelScript / console method calls)",
        "created_at": "2025-05-21T15:43:18Z"
      }
    ]
  },
  {
    "number": 5716,
    "title": "Word JavaScript API: Fails to load shape properties with GeneralException.",
    "body": "Platform : PC desktop\nHost: Word\nOffice version number: Microsoft® Word for Microsoft 365 MSO (Version 2420) 64-bit\nOperating System: Microsoft Windows 11 pro\n\nHi team,\n\nI'm encountering a GeneralException when attempting to load shape properties using the Word JavaScript API. Specifically, after calling context.sync(), the operation fails with a general error.\n\nInterestingly, the same code works as expected on a newer version of Word:\nMicrosoft® Word for Microsoft 365 MSO (Version 2504 Build 16.0.18730.20122) 64-bit.\n\nThis discrepancy makes it challenging for us to maintain consistent support across client environments, as requesting frequent version changes is not a viable solution. We kindly request the team to investigate this behavior and help us understand why the issue occurs in Version 2420 but not in Version 2504.\n\nCODE SNIPPET:\n```\nawait Word.run(async (context) => {\n    const shapes = context.document.body.shapes;\n    shapes.load(\"items/name,items/type\");\n    await context.sync();\n});\n\n```\n\nSample Document:-\n\n[TestDoc_GeneralException.docx](https://github.com/user-attachments/files/20228670/TestDoc_GeneralException.docx)\n\nThanks for your support!\n",
    "created_at": "2025-05-15T13:11:47Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Word"
    ],
    "author": "GajananVadekar",
    "comments": [
      {
        "author": "GajananVadekar",
        "body": "Just following up on this issue — it has been 4 days since the ticket was raised, and we haven't received any updates or acknowledgments yet.\nWe would greatly appreciate it if someone from the team could take a look and provide any insights, possible workarounds, or an update on this.\n\nThank you in advance for your support.",
        "created_at": "2025-05-19T07:00:47Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi @GajananVadekar  \n\nWe're work at this issue, will let you know once we have any progress.",
        "created_at": "2025-05-21T03:59:57Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi @GajananVadekar \n\nI tried the API in the latest version. It works well. Could you please develop your solution in the latest version to unblock you first?",
        "created_at": "2025-05-21T04:05:18Z"
      },
      {
        "author": "GajananVadekar",
        "body": "Hi @penglongzhaochina \nCould you please confirm whether you were able to test this specifically on Microsoft® Word for Microsoft 365 MSO (Version 2420) 64-bit?\n\nWe are facing the issue consistently in this version, and it would be helpful to know if you've been able to reproduce or investigate it on the same build.\n\nLooking forward to your response.",
        "created_at": "2025-05-21T05:37:23Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi @GajananVadekar ,\n\n This is the doc for Shape:https://learn.microsoft.com/en-us/javascript/api/word/word.shape?view=word-js-preview The shape belongs to API set: WordApiDesktop 1.2.  It is applicable since 2502 as below picture:\n\n![Image](https://github.com/user-attachments/assets/5545c1ba-18cd-4611-8215-f262b3052a0b)\n\nSo you can't get this object from a 24xx version.",
        "created_at": "2025-05-21T06:05:22Z"
      },
      {
        "author": "GajananVadekar",
        "body": "@penglongzhaochina  Thank you for the clarification.\n\nAppreciate your support and confirmation — closing this ticket now.\n\n",
        "created_at": "2025-05-21T06:17:24Z"
      }
    ]
  },
  {
    "number": 5702,
    "title": "Addin crashing on Current Channel Preview - Version 2505 Build 16.0.18827.20008",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\nOur addin is crashing for users on Current Channel (Preview), Version 2505 Build 16.0.18827.20008. We are still conducting investigations to figure out more details as to what's breaking, but it's affecting a number of customers on this build version on Windows. Prior versions are unaffected.\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC\n* Host [Excel, Word, PowerPoint, etc.]: Excel\n* Office version number: Version 2505 Build 16.0.18827.20008\n* Operating System: Windows\n* Browser (if using Office on the web): ______\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nAddin runs successfully.\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nOur addin is crashing for users on Current Channel (Preview), Version 2505 Build 16.0.18827.20008. We are still conducting investigations to figure out more details as to what's breaking, but it's affecting a number of customers on this build version on Windows. Prior versions are unaffected.\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\nWe are still working on finding a specific reproduction case\n\n## Link to live example(s)\n<!--- Ideally, provide a link to a live example, created and shared using -->\n<!--- [Script Lab](https://aka.ms/scriptlab). If relevant, create two buttons, -->\n<!--- one that sets up data in the document, and another that exemplifies the issue. -->\n\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\nOur addin is crashing for users on Current Channel (Preview), Version 2505 Build 16.0.18827.20008.Release notes for this version don't point to any breaking changes but we can reproduce consistently and have around 50 customers affected currently. Any insight into what potentially breaking changes may have been introduced would be greatly appreciated.\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [ ] Screenshots\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-05-12T19:12:33Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Excel"
    ],
    "author": "jroycroft",
    "comments": [
      {
        "author": "jroycroft",
        "body": "We also have customer reports with Version 2504 (Build 18730.20122), Version 2504 (Build 18730.20072), and Version 2504 (Build 18730.20142), although our developers have only been able to reproduce on Version 2505 Build 16.0.18827.20008",
        "created_at": "2025-05-12T19:20:16Z"
      },
      {
        "author": "jwhite-venacorp",
        "body": "Some additional details while we're trying to figure out how to demonstrate this. It seems to always happen after EdgeWebView has reported that garbage collection is complete. We think it might be related to calculations or getting the used range, but still investigating. Regardless, this is affecting a wide number of our users, and more as they update to newer versions of Excel (unrelated to changes we have made.)",
        "created_at": "2025-05-12T20:50:25Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi @jroycroft  @jwhite-venacorp  Could you please tell me how to reproduce your issue?",
        "created_at": "2025-05-13T04:36:51Z"
      },
      {
        "author": "jwhite-venacorp",
        "body": "We narrowed it down to the range.values API. We have to set a large number of cells, but not in a clean rectangle of cells -- some cells we want to leave as they are.\n\nPrevious versions of this API let us use `null` in the array where we want the cell value to be unchanged, we would do something like this:\n\n```JavaScript\nconst range = worksheet.getRange(\"A1:B2\");\nrange.values = [[ 1, null], [null, 2]]\n```\n\nThis would set cell A1 to 1 and B2 to 2, but would leave A2 and B1 unchanged. This allowed us to optimize our calls -- rather than getting one range for each rectangle of cells that needed to be changed, we could get the bounding rectangle of the cells we need to set and use a single values set.\n\nWhat we found is that this API still \"works\" -- we don't get an exception on `range.values = ...` or on subsequent `context.sync()` but we do see Excel crashing when the WebView garbage collector finishes.",
        "created_at": "2025-05-15T13:24:46Z"
      },
      {
        "author": "yongkhor-forbury",
        "body": "Hello everyone, \nI would like to confirm this issue as well.\n\nWe also have several customers reporting with Version 2504 (Build 18730.20122) (Build 18730.20142) (Build 18730.20168), when setting large scale of values which involving null and non-null values into Excel.\n\nAt the moment, we have to communicate with our customers so that they revert the Excel version to Version 2503 (Build 18623.20208).\n\nI managed to reproduce the issue on my machine Version 2504 (Build 18730.20168).\nFeel free to reach out for more context.\n\nSome snippets of Application Log Error Report:\n\n> Version=1\n> EventType=OFFICE_MODULE_VERSION_MISMATCH\n> EventTime=133917330721438667\n> ReportType=2\n> Consent=1\n> UploadTime=133917330732661702\n> ReportStatus=268435456\n> ReportIdentifier=760e453e-8101-42d5-8ace-a25b3a893074\n> IntegratorReportIdentifier=896c3dad-6415-477f-84e8-a7bf66a308e3\n> Wow64Host=34404\n> OriginalFilename=Excel.exe\n> AppSessionGuid=00003f54-0001-0004-73c0-380f1ac5db01\n> TargetAppId=W:0000e628acb8408a237ac73fd24a09587ef00000ffff!0000bc384b969fd553f470557916790388c5e27fcad6!EXCEL.EXE\n> TargetAppVer=2025//05//08:07:52:32!441b761!EXCEL.EXE\n> BootId=4294967295\n> TargetAsId=1436\n> UserImpactVector=269484304\n> IsFatal=4294967295",
        "created_at": "2025-05-16T03:12:15Z"
      },
      {
        "author": "SiruiSun-MSFT",
        "body": "Hi @jwhite-venacorp, @yongkhor-forbury and @jroycroft , Thanks for your reporting and valuable information!\nWe've located the root cause and already fixed this issue which will take effect in a few hour at most. We would be grateful if you could help us verify whether this issue has been resolved on your end later! Looking forward to your reply! Thanks again for your patience here!",
        "created_at": "2025-05-16T06:32:16Z"
      },
      {
        "author": "jwhite-venacorp",
        "body": "@SiruiSun-MSFT  thanks so much! Can you clarify the way we are using the range.values with null values is a supported behaviour? [The docs](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range?view=excel-js-preview#excel-excel-range-values-member) don't say explicitly this is supported and we are hesitant to use it in this way.",
        "created_at": "2025-05-16T13:21:50Z"
      },
      {
        "author": "andrewtsybulia",
        "body": "same issue for our customers",
        "created_at": "2025-05-17T13:43:42Z"
      },
      {
        "author": "SiruiSun-MSFT",
        "body": "Hi @jwhite-venacorp , Thanks for your feedback! This problem is caused by a bug in another feature we are enabling, and has nothing to do with the implementation of range.values. The way of setting range.values ​​to null is currently supported at the code level. We have not made any changes to the supported behavior of range.values.\nAnd @andrewtsybulia, do you mean this crash issue still happens on your customers? Since the rolling out of the new feature has been rolled back, could you provide the detailed version and channel to us to locate the root cause? Thanks!",
        "created_at": "2025-05-19T02:46:08Z"
      },
      {
        "author": "yongkhor-forbury",
        "body": "Hi @SiruiSun-MSFT,\n\nWill the fix be released to people in the Current Release Channel? How can our users tell whether they have the version that includes the fix?",
        "created_at": "2025-05-20T02:22:21Z"
      },
      {
        "author": "SEYOUN-LIM",
        "body": "Hi @SiruiSun-MSFT,\n\nCould you please tell me what was the another feature causing issue and is there a way can turn off that from user side?",
        "created_at": "2025-05-20T02:23:19Z"
      },
      {
        "author": "SiruiSun-MSFT",
        "body": "Hi @yongkhor-forbury and @SEYOUN-LIM, the new feature's feature gate has been shut down on the Production Current Channel, then this crash should be disappear based on our test result. And since the new feature is not yet GA, we couldn't share more information here. I'm sorry for that. Considering the FG was turned off last Friday, could you verify whether this issue has been mitigated now?",
        "created_at": "2025-05-20T02:30:01Z"
      },
      {
        "author": "SEYOUN-LIM",
        "body": "@SiruiSun-MSFT It seems that the issue has been resolved. However, I wanted to know more about how to handle this situation if it happens again, as well as more detailed information. thank you for your quick response.",
        "created_at": "2025-05-20T02:58:10Z"
      },
      {
        "author": "SiruiSun-MSFT",
        "body": "@SEYOUN-LIM Thanks for your quick confirmation. I'm fully understand your situation, however since the Feature gate controller is on our side, I'm afraid there isn't any better solution. In the future, we will do a more deeply investigation and validation on each new feature roll out process to avoid these issue. Thanks again for your patience and support! Will close this issue. Thanks again!",
        "created_at": "2025-05-20T03:04:38Z"
      },
      {
        "author": "SEYOUN-LIM",
        "body": "@SiruiSun-MSFT is the feature gate opened for other channels? We just got another information that one of our customer experiencing crash issue on version 2408 (build 17928.20512) Semi-Annual Enterprise Channel. ",
        "created_at": "2025-05-20T03:46:18Z"
      },
      {
        "author": "SiruiSun-MSFT",
        "body": "@SEYOUN-LIM , I just got a confirmation that this FG should be OFF for all channels on Prod, including Semi-Annual. Thus, we might be inclined to believe that this is not the same problem that caused the crash. Could you help us to gather more information and Repro steps for the crash case on Semi-Annual? Also, could anyone of you reproduce this issue?",
        "created_at": "2025-05-20T05:56:06Z"
      },
      {
        "author": "SEYOUN-LIM",
        "body": "@SiruiSun-MSFT Sorry for the late reply. The delay was due to waiting for a response from the support team. As you mentioned, this does seem to be a different issue. Thank you for your help.",
        "created_at": "2025-05-22T04:24:03Z"
      },
      {
        "author": "SiruiSun-MSFT",
        "body": "@SEYOUN-LIM Thanks for your reply! Since this issue is used to track the regression crash and already got fixed. If there is another issue need us support, please feel free to open another one! Thanks~",
        "created_at": "2025-05-22T06:32:40Z"
      }
    ]
  },
  {
    "number": 5700,
    "title": "True silent Graph SSO (no backend) in Office add-ins via OfficeRuntime.auth.getAccessToken()",
    "body": "I’m building an Outlook add-in that needs to call Microsoft Graph entirely from the browser —no backend. I’d like to leverage Office SSO (`OfficeRuntime.auth.getAccessToken`) to get a Graph access token silently, with zero pop-ups, but today it only returns an ID/OBO token (“aud” = my app), which I must then exchange on a server.\n\n# What I want:\n\n- A client-only pattern where `OfficeRuntime.auth.getAccessToken({ forMSGraphAccess: true })` returns a Graph-audience token (aud=https://graph.microsoft.com/) scoped for the Graph permissions declared in <WebApplicationInfo>, without any interactive prompts or need for our own backend OBO endpoint.\n\n- Ideally, this would use a hidden silent-iframe under the covers (like msal-browser’s ssoSilent) or some equivalent Office host capability.\n\n# What I have today:\n1. Manifest with\n```\n<VersionOverrides \n  xmlns=\"http://schemas.microsoft.com/office/mailappversionoverrides/1.1\"\n  xsi:type=\"VersionOverridesV1_1\">\n  <Requirements>\n    <Sets DefaultMinVersion=\"1.8\">\n      <Set Name=\"Mailbox\"      MinVersion=\"1.8\" />\n    </Sets>\n  </Requirements>\n  <WebApplicationInfo>\n    <Id>[id]</Id>\n    <Resource>api://[id]</Resource>\n    <Scopes>\n      <Scope>User.Read</Scope>\n      <Scope>Mail.Read</Scope>\n    </Scopes>\n  </WebApplicationInfo>\n</VersionOverrides>\n```\n2. Client code that does:\n```\n// Try Office SSO first\nconst tokenA = await OfficeRuntime.auth.getAccessToken({\n  allowSignInPrompt: true,\n  allowConsentPrompt: true,\n  forMSGraphAccess: true\n});\nconsole.log(\"got token A:\", tokenA);\nconst jwt = JSON.parse(atob(tokenA.split('.')[1]));\n// jwt.aud === \"[id]\"\n// jwt.scp === \"mail.read User.Read\"\n// jwt.iss === \"...//v2.0\"\n```\nThat token is intended for an OBO exchange—but I have no backend to exchange it on, so I can’t call Graph directly. When I pass it to Graph, I get 401 Unauthorized.\n3. As a fallback I implemented a full MSAL-browser PKCE flow in the client:\n```\nconst pca = new PublicClientApplication({ /* common/organizations authority */ });\nawait pca.initialize();\nconst accounts = pca.getAllAccounts();\nif (!accounts.length) {\n  await pca.loginPopup({ scopes });\n}\nconst result = await pca.acquireTokenSilent({ scopes, account: pca.getAllAccounts()[0] });\n// result.accessToken has aud=https://graph.microsoft.com/\n```\nThis works, but I must show a popup at least once, and I lose the seamless “no-login” Office SSO experience.\n\n# Expected behavior:\n\n- OfficeRuntime.auth.getAccessToken({ forMSGraphAccess: true }) should silently return a Graph-scoped access token that can be used directly with @microsoft/microsoft-graph-client in the browser.\n- If the user has already consented and is signed into Office, no pop-ups should appear.\n- This should be available in Outlook on Windows/Mac and new Outlook on the web (PWA), matching the experience in the classic desktop client.\n\n# Actual behavior:\n\n- In all hosts, getAccessToken returns a token whose aud is my add-in’s App ID URI, intended for an OBO exchange.\n- I must send that token to my server (or Azure Function) to run the On-Behalf-Of flow, get a Graph token, then return it to the client.\n- There is no way today to do it in the browser without a backend.\n\n# Proposed solution:\n\n- Enhance the Office SSO service so that when forMSGraphAccess: true is passed, Office will silently call the Graph audience endpoint and return a Graph token directly to the add-in.\n- Under the covers this could use a hidden iframe and existing AAD cookies (similar to MSAL’s ssoSilent).\n- The token should respect the scopes declared in <WebApplicationInfo> and the user’s consent.\n\n# Environment:\n\n- office-js version: 1.15.0 (hosted CDN)\n- Outlook desktop Windows: 16.0.18730.20122 (Mailbox 1.8, IdentityAPI 1.3 supported)\n- Outlook on the web (PWA) & new Outlook client\n- No backend available in our scenario—pure client-side add-in",
    "created_at": "2025-05-12T12:59:52Z",
    "state": "closed",
    "labels": [
      "Area: Outlook"
    ],
    "author": "Dpio",
    "comments": [
      {
        "author": "David-Barrett-MS",
        "body": "You can never guarantee in delegated flow that the user won't need to respond to a prompt.  If MFA is enabled for example (which it should be).\n\nI've recently written a pure client-side NAA add-in (adapted from our other samples, but implemented using JavaScript - no TypeScript or framework dependencies) and it obtains a token silently in most scenarios (I have MFA enabled) that can be used directly against Graph: https://github.com/David-Barrett-MS/Outlook-Add-in-SSO",
        "created_at": "2025-05-13T11:19:11Z"
      },
      {
        "author": "Dpio",
        "body": "Thanks for the sample! Here’s exactly how I’ve configured—and what I’m seeing in Outlook Desktop:\n\n1. AAD App Registration\n- Client (Application) ID: process.env.REACT_APP_AAD_CLIENT_ID\n- Supported account types: “Multitenant”\n- Redirect URIs (SPA):\n  - https://localhost:3000/auth.html\n\n2. Authentication settings in Azure Portal\n- Allow public client flows: Enabled\n- Implicit grant & hybrid flows: (unused for nested-app, but SPA redirect is set)\n\n3. MSAL config in code \n```\nconst msalConfig: msal.Configuration = {\n  auth: {\n    clientId: CLIENT_ID,\n    authority: `https://login.microsoftonline.com/${TENANT_ID}`,   // TENANT_ID = 'common'\n    redirectUri: REDIRECT_URI,                                    // createLocalUrl('auth.html')\n    supportsNestedAppAuth: true,\n  }\n};\n```\n4. Manifest WebApplicationInfo\n```\n<WebApplicationInfo>\n  <Id>[CLIENT-ID]</Id>\n  <Resource>api://[CLIENT-ID]</Resource>\n  <Scopes>\n    <Scope>openid</Scope>\n    <Scope>profile</Scope>\n    <Scope>email</Scope>\n    <Scope>offline_access</Scope>\n    <Scope>user.read</Scope>\n    <Scope>mail.read</Scope>\n  </Scopes>\n</WebApplicationInfo>\n```\n5. Console output in Outlook Desktop\n```\n[GraphService] Initializing...\n[GraphService] Silent SSO failed, trying popup ServerError\n    at NestedAppAuthAdapter.fromBridgeError ...\n[GraphService] Popup SSO failed, falling back to OfficeRuntime ClientAuthError: user_canceled: User cancelled the flow.\n[GraphService] OfficeRuntime SSO failed OSF.DDA.Error { name: 'API Not Supported', code: 13012 }\nGraph initialization failed: OSF.DDA.Error { message: 'API is not supported in this platform.' }\n```\n\nDoes anything above still look off, or is there another portal setting I might have missed?",
        "created_at": "2025-05-13T12:35:20Z"
      },
      {
        "author": "David-Barrett-MS",
        "body": "[WebApplicationInfo](https://learn.microsoft.com/en-us/javascript/api/manifest/webapplicationinfo?view=common-js-preview) is used to authenticate with your own API, I believe - you don't need that to use NAA and obtain a Graph token.  I don't have that element configured in my manifest at all.  Which sample were you following?",
        "created_at": "2025-05-13T12:52:04Z"
      },
      {
        "author": "Dpio",
        "body": "Thanks - I was testing the MSAL AccountManager path from your sample in my add-in, so I assumed the manifest wouldn’t matter. I added the <WebApplicationInfo> block just to be safe, but I’m still seeing the same bridge errors in both silent and pop-up flows.\n\nAt this point, I’ve got:\n\n1. authority: \"https://login.microsoftonline.com/common\" and also \"https://login.microsoftonline.com/tenant-id\" for the auth app (not the add-in)\n2. supportsNestedAppAuth: true\n3. redirectUri pointing at my auth.html and registered as an SPA URI in Azure\n4. “Allow public client flows” turned on in the portal\n\nShouldn’t the pure client-side nested-app flow succeed with that config? What else could I be missing?",
        "created_at": "2025-05-13T13:51:01Z"
      },
      {
        "author": "tomaskukk",
        "body": "@Dpio not sure if you have checked the [docs for NAA](https://learn.microsoft.com/en-us/office/dev/add-ins/develop/enable-nested-app-authentication-in-your-add-in), but you need some special things set up in the App Registration, most importantly the `brk-multihub` SPA URI.\n\nThe WebApplicationInfo element in the manifest is helpful, as it will ensure admins grant admin-consent for the add-in during installation. Otherwise you need to provide the admin consent URI directly for a tenant admin.",
        "created_at": "2025-05-14T14:19:04Z"
      },
      {
        "author": "shighosh-msft",
        "body": "Hi @Dpio, please consider using Nested App Authentication (NAA) for your use-case. Here is the doc - https://learn.microsoft.com/en-us/office/dev/add-ins/develop/enable-nested-app-authentication-in-your-add-in\n\nThe NAA flow ensures that you don't need to have a middle-tier server\n\n![Image](https://github.com/user-attachments/assets/1c058168-f6f6-4aa0-ace7-b18562fda84a)\n\n\nAlso, having a graph-scoped accessToken in the front channel (the browser) is not secure, hence the getAccessToken() OBO flow recommends the token exchange on the server-side.  ",
        "created_at": "2025-05-16T04:00:53Z"
      },
      {
        "author": "Dpio",
        "body": "@tomaskukk @shighosh-msft I finally got it working—thanks so much for your patience and guidance! It turned out I was over-focusing on the OfficeRuntime.auth path when the real fix was to switch to the MSAL.js nested-app authentication (NNA) flow. Once I:\n\nRegistered the brk-multihub://localhost:3000 (and production) redirect URIs under SPA in AAD\n\nEnabled Allow public client flows in the app registration\n\nPointed my MSAL config at https://login.microsoftonline.com/common with supportsNestedAppAuth: true\n\n…acquireTokenSilent({ scopes }) began returning a Graph token directly in Outlook desktop, with zero pop-ups or backend OBO exchange.\n\nSorry for the delay—the cycle of releasing and testing on our staging environment slowed me down. One improvement I’d suggest is expanding the NNA examples and configuration notes in the docs. Discovering the exact redirect-URI scheme and portal settings needed wasn’t obvious. Otherwise, this approach works beautifully. Thanks again!",
        "created_at": "2025-05-22T05:37:51Z"
      }
    ]
  },
  {
    "number": 5698,
    "title": "Is there a way to export all selected slides as a base64?",
    "body": "Hi Team,\n\nDoes exportAsBase64() method support for exporting multiple slides into a single ppt file? Basically I want to export the user selected slides as a new ppt file.",
    "created_at": "2025-05-12T09:16:17Z",
    "state": "closed",
    "labels": [
      "Needs: triage :mag:"
    ],
    "author": "MariaLawrenceAntony",
    "comments": [
      {
        "author": "EsterBergen",
        "body": "@MariaLawrenceAntony - Thanks for reaching out! Currently the functionality is only to export a single slide. This would be new functionality. Please make a feature request here [Microsoft 365 Developer Platform Ideas Forum](https://aka.ms/m365dev-suggestions). Please add your request there. Feature requests on are considered when we go through our planning process. Thanks for highlighting this!",
        "created_at": "2025-05-19T16:39:05Z"
      }
    ]
  },
  {
    "number": 5685,
    "title": "The window opened by Office.context.ui.displayDialogAsync is not centered.",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC desktop, Office on the web\n* Host [Excel, Word, PowerPoint, etc.]: New Outlook\n* Office version number: New Outlook 1.2025.430.200\n* Operating System: Windows 11\n* Browser (if using Office on the web): Microsoft Edge (Version 136.0.3240.50)\n \n## Expected behavior\nWhen invoking Office.context.ui.displayDialogAsync within the OnMessageSend event of an Outlook add-in, the dialog should appear centered on the screen, regardless of the monitor configuration.​\n\n## Current behavior\nIn the new Outlook for Windows, the dialog does not appear centered on the screen; instead, it opens offset from the center. Additionally, in Outlook on the web, when using a multi-monitor setup, the dialog centers correctly on the primary monitor but appears misaligned on secondary monitors.​\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. Develop an Outlook add-in with an OnMessageSend event handler defined in the manifest.xml.\n2. Within the event handler, call Office.context.ui.displayDialogAsync to open a dialog.\n3. Deploy and sideload the add-in in the new Outlook for Windows and Outlook on the web.\n4. Compose a new email and send it to trigger the OnMessageSend event.\n5. Observe the positioning of the dialog on both primary and secondary monitors.​\n\n## Link to live example(s)\n<!--- Ideally, provide a link to a live example, created and shared using -->\n<!--- [Script Lab](https://aka.ms/scriptlab). If relevant, create two buttons, -->\n<!--- one that sets up data in the document, and another that exemplifies the issue. -->\n1. ______\n2. ______\n3. ______\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\nThis issue affects user experience, especially for those using multi-monitor setups. The misalignment of the dialog can cause confusion and disrupt workflow.​\n\n## Context\nThe add-in is designed to perform validations and display a dialog to the user before sending an email. The misplacement of the dialog affects the clarity and effectiveness of these validations, potentially leading to user errors or missed information.​\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [ 1] Screenshots\n\n<img width=\"1276\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/5d7fa301-e72b-44e8-8291-0070481119d6\" />\n\n<img width=\"1272\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/94108cf6-f1dd-4e5e-b4bf-374885c7532a\" />\n\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-05-06T09:53:24Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "SaberTome",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #3515\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\nThere isn't really a good solution here. For the ItemSend Event or really any 'ExecuteFunction' 'UIless' action. The Webview that runs your add-in is created in a hidden window that doesn't move around with the active window, and it can easily be on a different monitor than the actual dialog. The % input to dialog is intended to somewhat mitigate this issue, by allowing you to adjust the size of the dialog to adjust to the size of the screen.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3515#issuecomment-1698328921\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-05-06T09:54:06Z"
      },
      {
        "author": "SaberTome",
        "body": "\n> Here are some similar issues that might help you. Please check if they can solve your problem.\n> \n> * [Screen size in window object gives incorrect width and height #3515](https://github.com/OfficeDev/office-js/issues/3515)\n> \n> **Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n> \n> There isn't really a good solution here. For the ItemSend Event or really any 'ExecuteFunction' 'UIless' action. The Webview that runs your add-in is created in a hidden window that doesn't move around with the active window, and it can easily be on a different monitor than the actual dialog. The % input to dialog is intended to somewhat mitigate this issue, by allowing you to adjust the size of the dialog to adjust to the size of the screen.\n> \n> **Reference**:\n> \n> * [Screen size in window object gives incorrect width and height #3515 (comment)](https://github.com/OfficeDev/office-js/issues/3515#issuecomment-1698328921)\n> \n> _Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_\n\nThank you for your response and suggestions. So, to confirm, there is currently no way to guarantee that the dialog popped up via Office.context.ui.displayDialogAsync will be 100% centered, correct?\nBut the URL below mentions:\n'The dialog box always opens in the center of the screen.'\nThis indicates that according to official documentation, the pop-up dialog should at least always appear centered on the screen.\nhttps://learn.microsoft.com/en-us/office/dev/add-ins/develop/dialog-api-in-office-add-ins\nHowever, in the scenario of the new Outlook, even with a single monitor, the pop-up dialog does not appear centered.",
        "created_at": "2025-05-06T10:30:17Z"
      },
      {
        "author": "sivachandran-msft",
        "body": "Hi @SaberTome, \n\nThanks for sharing the details. Could you please share a simple addin that exhibit this behaviour.  It will help us the check the details & get back with expected details.",
        "created_at": "2025-05-07T13:14:52Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-11T14:50:07Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-14T17:49:32Z"
      }
    ]
  },
  {
    "number": 5684,
    "title": "Sideloading Rejected by Exchange",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Error when sideloading an add-in manifest - Sideloading Rejected by Exchange\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Office on the web\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Office version number: See below\n* Operating System: Windows 11\n* Browser (if using Office on the web): Chrome \n \nFull Outlook version details:\nMicrosoft Outlook Version: 1.2025.430.200 (Production)\nClient Version: 20250425004.11\nWebView2 Version: 135.0.3179.98\nSession ID: d8ed435e-12f2-8e43-926e-d73dc46439cd\n\n## Expected behavior\nI can side-load my add-in\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nSide-load fails and displays a dialog that reads \"Add-in installation fails\". \nInspection of the dev tools shows a 400 response with an error message in the response that reads \"Sideloading Rejected by Exchange\". \n\nI have validated the manifest with npx office-addin-manifest validate, and it is valid. \n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. Upload the attached manifest \n\n[manifest.txt](https://github.com/user-attachments/files/20054022/manifest.txt)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-05-06T07:12:38Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "ahofman",
    "comments": [
      {
        "author": "sivachandran-msft",
        "body": "Hi @ahofman,\n\nThanks for sharing the details & manifest. I tried sideloading the file and could repro the behavior. By removing the WebApplicationInfo element in manifest, the manifest is sideloading successfully. So could you please cross the parameters & validate the URL in the WebApplicationInfo and try it again.",
        "created_at": "2025-05-07T13:09:26Z"
      },
      {
        "author": "sivachandran-msft",
        "body": "Hi @ahofman ,\n\nI evaluated it further and could get the reason for the rejection. Please find the same below:\n\"All URLs in the Resources section must be from the same domain and subdomain as the Resource element under the WebApplicationInfo node in the manifest. The domain and subdomain of URL https://o365-outlook-test.xakiatech.com/ does not match the domain and subdomain of the Resource api://app-test.xakiatech.com/outlook-integration/d0cf29df-c5ae-41bf-aa29-0db97268b872.\"",
        "created_at": "2025-05-07T13:24:10Z"
      },
      {
        "author": "ahofman",
        "body": "@sivachandran-msft Thanks, can we have this validation built in to `npx office-addin-manifest validate` ?",
        "created_at": "2025-05-08T01:34:43Z"
      },
      {
        "author": "ahofman",
        "body": "@sivachandran-msft Also - does it not suffice to declare the domain under `AppDomain` s ?",
        "created_at": "2025-05-08T01:57:25Z"
      },
      {
        "author": "sivachandran-msft",
        "body": "@ahofman As per the current setup, the domain & subdomain of Resources should match with Resource element. \nRegarding, add this part of validation step, we will consider it and confirm with the right team on it. Thanks for your suggestion.",
        "created_at": "2025-05-08T08:13:15Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-12T10:34:21Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-15T13:08:48Z"
      }
    ]
  },
  {
    "number": 5682,
    "title": "getSharedPropertiesAsync not working if shared mailbox is added as account",
    "body": "# Provide required information needed to triage your issue\nCurrently, when adding a shared mailbox as an own account (instead of using the auto-mapping functionality), `Office.context.mailbox.item.getSharedPropertiesAsync` does not work / return any data. Instead, the email address of the shared mailbox needs to be fetched via the userProfile. The problem is, that we need to detect if the user is working in a shared mailbox environment, because we can't store any user-specific data in that might be shared with other users also working with the add-in and the mailbox.\n\nThis is going to get worse, since apparently Outlook will be moving to a model where adding the account explicitly is going to be encouraged: https://support.microsoft.com/en-us/office/preview-manage-shared-mailbox-settings-in-new-outlook-f6929a97-4fc6-4a52-b77d-5e596c6322b4?preview=true\n\nWould it be possible to make the getSharedPropertiesAsync work for shared mailboxes explicitly? Or at least add some property indicating this is not a user mailbox but a shared mailbox?\n\n## Your Environment\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\nMicrosoft Outlook Version: 1.2025.416.400 (Production)\nClient Version: 20250425004.10\nWebView2 Version: 135.0.3179.98\nSession ID: 40f98bc2-1d5f-2c48-be6f-619048d3e930\nRelease Channel: Targeted Release\n \n## Expected behavior\ngetSharedPropertiesAsync should work if the shared mailbox is added as an account as well.\n\n## Current behavior\ngetSharedPropertiesAsync only works if shared mailbox is auto-mapped from primary mailbox.\n",
    "created_at": "2025-05-05T08:07:20Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity",
      "Similar-Issue"
    ],
    "author": "tobiasviehweger",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #4836\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-05-05T08:07:53Z"
      },
      {
        "author": "mmanjaree-msft",
        "body": "@tobiasviehweger Is the issue you are facing for mail compose item or read surface as well? \nFor compose as of now it is something by design. Please raise a feature request. This will be considered as a new feature request. \nWe track Outlook add-in feature requests on our [Tech Community Page](http://aka.ms/M365dev-suggestions). Please submit your request there and choose the appropriate label(s). Feature requests on Tech Community are considered when we go through our planning process.",
        "created_at": "2025-05-09T05:52:48Z"
      },
      {
        "author": "tobiasviehweger",
        "body": "Hi @mmanjaree-msft this is for the read surface, should've mentioned this. We don't use the compose surface.",
        "created_at": "2025-05-09T05:54:44Z"
      },
      {
        "author": "mmanjaree-msft",
        "body": "Can you share a screenshot or repro video as we are not able to repro this on our side",
        "created_at": "2025-05-09T06:20:50Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-13T07:46:56Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-16T09:54:39Z"
      }
    ]
  },
  {
    "number": 5677,
    "title": "[Windows] New Outlook Desktop doesn't provide the openBrowserWindow API",
    "body": "On new Outlook Desktop Windows client, there's no `Office.context.ui.openBrowserWindow` API, that's available in other desktop clients (e.g. Outlook on Mac or legacy Outlook Desktop for Windows). I assume that's because new Outlook Desktop client uses the web client underneath, that doesn't support this feature.\nFor us that means that we have to use the `window.open` API that opens the new window as a popup inside the Outlook app, which is not optimal in our case from the UX standpoint.\nAre there any plans for adding the `Office.context.ui.openBrowserWindow` API to the new Outlook Desktop client? Or maybe there's any other option?",
    "created_at": "2025-05-02T09:12:04Z",
    "state": "closed",
    "labels": [
      "Area: Outlook"
    ],
    "author": "Suntechnick",
    "comments": [
      {
        "author": "megharai1302",
        "body": "@Suntechnick Thanks for reaching out. We do support [displayDialogAsync](https://learn.microsoft.com/en-us/javascript/api/office/office.ui?view=common-js-preview#office-office-ui-displaydialogasync-member(2)) . Could you please check if this meets your requirement? ",
        "created_at": "2025-05-08T12:37:03Z"
      },
      {
        "author": "Suntechnick",
        "body": "We would like to have an ability to open the separate browser window similarly to other Outlook clients",
        "created_at": "2025-05-12T08:48:07Z"
      },
      {
        "author": "megharai1302",
        "body": "Thank you for the input. This will be considered as a new feature request.\nWe track Outlook add-in feature requests on our [Tech Community Page](http://aka.ms/M365dev-suggestions). Please submit your request there and choose the appropriate label(s). Feature requests on Tech Community are considered when we go through our planning process.",
        "created_at": "2025-05-16T09:57:08Z"
      }
    ]
  },
  {
    "number": 5670,
    "title": "Outlook IOS and Mac lose network access occasionally, causing Add-in's to fail. [TypeError: Load failed]",
    "body": "## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Mac & IOS\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Office version number: 16.96.413.0\n* Operating System: Macintosh; Intel Mac OS X 10_15_7, IOS iPhone OS 18_3_2 like Mac OS X\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nNetwork requests complete normally and do not raise errors.\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nWe got reports that our Add-in fails to perform tasks in Mac and IOS environments. After testing, we were able to reproduce the problems occasionally. The error we observed was that mail-client seemed to lose internet connection and calls failed with `TypeError: Load failed`. This happened at the end of the add-in flow, so some network requests went through fine. However, the one that halts the process did not, and we did not receive any matching event in our servers, hinting towards the fact that request never left client successfully and manifests as error mentioned above. The error is not always present and occurs from time to time.\n\nWe struggled to reliably re-produce this, but what we find was:\n- This only happens on Mac or IOS\n- The likelihood of this happening raised the longer we kept add-in open before continuing operation. This would hint towards the fact that probability of losing connection raises over time for some reason.\n\nBy waiting a while, we get this happening semi-regularly.\n\n\n## Steps to reproduce\n- Add Add-in to Outlook Mac that executes any network request on click.\n- Open Add-in and inspect that initial requests work well\n- Wait for approx 3-4 minutes. Perform any action in add-in that causes network request\n- You should see network requests fail with a message \"Failed to load resource: The network connection was lost.\n\nNote that this is easiest way for us to reproduce it. Our customers have also experienced this within normal operation (not waiting explicitly couple minutes during add-in operation). So wait time seems to increase likelihood, but it is not necessity for this to happen.\n\n\nInterestingly I was not able to reproduce this with ScriptLab when I created function that simply calls public endpoint via click of a button. Apparently the url somehow dictates when this happens. \n\n[Possibly linked Issue.](https://github.com/OfficeDev/office-js/issues/4511)\n\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\nAdd-ins suddenly stop working due dropped network-connection, rendering them un-usable. \n\n",
    "created_at": "2025-04-29T11:47:22Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "RikuRuokonen",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #3760\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\nPlease share the following details with us:\n\n- Are you referring to a Task Pane add-in? It would be great if you share the exact steps.\n- Do you see any error in the console during the first run?\n- Please share the Incident ID from Outlook Mac \n  1.  Re-launch Outlook\n  2. Repro the issue \n  3. Navigate to Help->Collect Diagnostics and share the Incident ID generated.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3760#issuecomment-1767625816\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-04-29T11:47:56Z"
      },
      {
        "author": "whoanuragverma",
        "body": "@RikuRuokonen can you please share the addin manifest where you are encountering this issue? You can also share a minimal addin where you are able to repro this issue in a private repo on github and give access to @exextoc? ",
        "created_at": "2025-05-02T05:21:31Z"
      },
      {
        "author": "RikuRuokonen",
        "body": "Sure. Here is [link to the manifest.](https://officejs.hoxhunt.com/api/v1/manifest/default/manifest.xml)",
        "created_at": "2025-05-02T09:41:57Z"
      },
      {
        "author": "sivachandran-msft",
        "body": "Hi @RikuRuokonen, we are unable to repro the behavior using the shared manifest. Could you please follow [this ](https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues#outlook-mac)procedure and share the collected diagnostics on repro-ing the issue. \n\nAlso could you please confirm, how frequent are you facing this issue?",
        "created_at": "2025-05-07T12:27:41Z"
      },
      {
        "author": "RikuRuokonen",
        "body": "Hey! We got these reports from time to time so it is constant flow but volume is limited. I personally can reproduce this roughly with 80% confidence when waiting enough time (1-2 miins) after opening the add-in and initiating a action that performs network request.\n\nHere is Incident ID from Collected Diagnostics, during it I managed to produce this twice: MYNFNXPA",
        "created_at": "2025-05-08T09:41:19Z"
      },
      {
        "author": "sivachandran-msft",
        "body": "@RikuRuokonen , How are recovering from the network loss when you are using Addins? Will you restart the Add-in or outlook?",
        "created_at": "2025-05-08T10:06:09Z"
      },
      {
        "author": "RikuRuokonen",
        "body": "I can recover by restarting add-ing and trying again. No client-restart needed.",
        "created_at": "2025-05-08T10:20:32Z"
      },
      {
        "author": "sivachandran-msft",
        "body": "Could you please share a recording that help us understand the behaviour. From the diagnostics, we are not seeing any abnormalities from Add-in client end. Seondly, are you facing this issue with only one addin or all the addins in your env? ",
        "created_at": "2025-05-08T10:24:49Z"
      },
      {
        "author": "RikuRuokonen",
        "body": "The recording itself is literally only our Add-in opening and failing, so I am afraid that is really helpful (ofc I can provide it if really needed, but not sure what should be visible exactly here for it to be useful?). The main visible indicator is indeed that the network request suddenly fails and never leaves the client,\n\nSo far I have been able to reproduce this with our production Add-in, oddly the separate development Add-in does not yield this same behaviour, atleast as constitently as the prod-one. ",
        "created_at": "2025-05-08T10:48:18Z"
      },
      {
        "author": "sivachandran-msft",
        "body": "I would like to confirm whether the issue is occurring only in specific set of addins or all addins. Say for instance, are you facing this with VivaInsights addin if that is installed in your system?",
        "created_at": "2025-05-08T11:27:12Z"
      },
      {
        "author": "RikuRuokonen",
        "body": "Other Add-ins seem to work fine. Tested with VivaInsights right now and it worked fine.",
        "created_at": "2025-05-09T06:34:47Z"
      },
      {
        "author": "megharai1302",
        "body": "Hey @RikuRuokonen , This is the error we are getting in Mac. Could you please check if this is what you are referring to?\nAnd the error we see in console is 500 error where it is trying to hit your app server.\n\n![Image](https://github.com/user-attachments/assets/f32bf87b-d2a1-4e20-9cf7-652a7b3ee30c)",
        "created_at": "2025-05-13T05:59:23Z"
      },
      {
        "author": "RikuRuokonen",
        "body": "The Add-in does not work when ran as a standalone, as there are constraints such that organization initiating it being customer etc. So the errors in this case are expected, and not related to our case.\n\nI am curious what the diagnostics revealed when we collected them? Was there anything that hinted to any abnormal behavior of the Outlook Mac-client? ",
        "created_at": "2025-05-14T08:28:09Z"
      },
      {
        "author": "megharai1302",
        "body": "We checked the logs and don’t see any logs indicating network issue from client side. So to understand correctly from Add-in’s code you are trying to make a network call to your Add-in’s backend server and that fails? Can you help with following questions:\n1. Do you see this call in network trace? If yes, what is the response?\n2. Can you share the network trace in a har file along with Outlook diagnostics ? You can upload it in a git repo and give access to @exextoc \n3. Are any other network calls failing when this happens?\n4. Can you check sleep/battery settings of your system and see if that affects it.\n5. Can you also test and check if same issue happens if you open Outlook Web in Safari browser in same machine?",
        "created_at": "2025-05-14T09:54:16Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-18T15:08:44Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-21T17:23:33Z"
      }
    ]
  },
  {
    "number": 5669,
    "title": "OnSend Add-in Triggered in Loop on Outlook for Mac 16.91 (Legacy UI) — Email Send Blocked",
    "body": "We are experiencing a recurring issue on specific Mac machines running Outlook for Mac (version 16.91, legacy UI), where the OnSend event in our Outlook Add-in is invoked multiple times in a loop, causing the email send operation to fail entirely.\n\nKey Observations:\n- Only a small subset of users (approximately 4–5 out of Thousands) are affected.\n- The same user accounts function normally in Outlook Web App (OWA) — the OnSend event is triggered only once, and emails are sent successfully.\n- Outlook displays the error: \"Outlook can't send this message because there's a problem with the add-in <addin-name>\"\n\nExpected Behavior:\n- The OnSend event should trigger only once per email send action.\n- The email should be sent successfully if add-in validation passes.\n\nActual Behavior (on affected Mac clients):\n- Outlook repeatedly invokes the OnSend event, entering a loop.\n- Email fails to send.\n- This behavior is specific to Outlook for Mac 16.91 (legacy UI) on macOS Catalina.\n\nSteps to Reproduce (on affected machines):\n1. Open Outlook for Mac (legacy UI), version 16.91.\n2. Compose a new email.\n3. Click “Send”.\n4. Observe:\n     - Add-in's OnSend handler is triggered multiple times.\n     - Email is not sent.\n     - Outlook displays an error related to the add-in.\n\nEnvironment:\n\n- OS: macOS Catalina\n- Outlook for Mac version: 16.91 (legacy UI)\n- Affected users: 4–5 of thousands\n- Outlook Web App: Works normally with no issues\n\nTroubleshooting Attempted:\n\n- Reinstalled Microsoft Office (full reinstall)\n- Cleared all Outlook/Office caches\n- Issue still persists on affected machines\n\nImpact:\n\n- Affected users are unable to send emails via Outlook for Mac.\n- Users must resort to OWA as a workaround.\n\nSimilar Issues Referenced:\nGitHub Issues: \n\n- [#5520](https://github.com/OfficeDev/office-js/issues/5520)\n- [#1367](https://github.com/OfficeDev/office-js/issues/1367)\n\n**Request:** Please investigate the possibility of a regression or compatibility issue between the Outlook for Mac legacy UI and the OnSend add-in framework. A workaround or hotfix is urgently needed to restore email functionality for affected users.",
    "created_at": "2025-04-29T08:56:25Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Resolution: won't fix",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "saranshj44",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #5363\n- #4409\n- #1367\n- #4608\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nPlease provide the following details to help us investigate: 1. A video demonstrating the issue. 2. Logs collected using the steps mentioned [here](https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues#outlook-mac) 3. A sample add-in where we can reproduce the issue. Please create a private Git repository and share the files. Also, can you switch to New Outlook on Mac and check if it works?\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5363#issuecomment-2642982891\n### Solution 2:\nCould you please provide us the manifest URL of the add-in you are using? If possible, share a test account where this issue is reproducible. Also, please provide logs from Outlook using the below steps: 1. Launch Outlook (start a new session) 2. Wait for Add-ins to load 3. Reproduce the On-Send issue 4. Click on Help -> Collect Diagnostics. This will generate an Incident ID. Note the same and share it.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/1367#issuecomment-687138511\n- https://github.com/officedev/office-js/issues/1367#issuecomment-773827454\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-04-29T08:57:26Z"
      },
      {
        "author": "whoanuragverma",
        "body": "Can you please confirm if this bug is only in Legacy UI for Mac?\n\nIf no, then please capture the incident Id and share with us.\n\nSteps to generate Diagnostics/incident ID:\n\nRe-launch Outlook\nRepro the issue mentioned\nClick on Help->Collect Diagnostics\nShare the ID generated.",
        "created_at": "2025-04-29T09:49:00Z"
      },
      {
        "author": "saranshj44",
        "body": "Unfortunately, we are unable to capture diagnostics, videos, or screenshots from the affected users as the issue is occurring in a secured customer environment with strict compliance policies that prohibit external recording or data capture.\n\nHowever, the behavior is consistent with previously reported issues such as #5520, where OnSend is invoked in a loop. While that specific issue was related to the OnSend command, the symptoms are nearly identical in our case.",
        "created_at": "2025-04-29T13:21:00Z"
      },
      {
        "author": "whoanuragverma",
        "body": "Thank you for sharing this issue. As a workaround, users can switch to the [New Outlook for Mac](https://support.microsoft.com/en-gb/office/the-new-outlook-for-mac-6283be54-e74d-434e-babb-b70cefc77439?ui=en-us&rs=en-gb&ad=gb) experience which works as expected. We are not prioritizing this fix on classic Mac UI; please reopen the issue in case the workaround does not solve your scenario.",
        "created_at": "2025-04-30T05:05:51Z"
      }
    ]
  },
  {
    "number": 5666,
    "title": "(on-premise) getCallbackTokenAsync returns a token for the user account instead of the shared mailbox",
    "body": "I'm using a adding that uses OfficeJs and when I'm using getCallbackTokenAsync (Rest false) to generate a token on a shared mailbox, it looks like it's generating a token for the main's mailbox (not the shared one).\n\n## Your Environment\n* Platform PC\n* Hosted Outlook Web (on-premise)\n* Operating System: Windows 11\n* Browser : Chrome\n \n## Expected behavior\nI expect getCallbackTokenAsync to return a token for the shared mailbox I accessed, so I can authenticate actions specific to that mailbox.\n\n## Current behavior\ngetCallbackTokenAsync returns a token associated to my main mailbox instead of the shared mailbox.\n\n## Steps to reproduce\n- Go to the webview on a on-premise environnemnt (for me it's https://ex4.mail.ovh.net/ as the on-premise exchange is hosted here)\n- Add a shared mailbox on the left menu (so you must see 2 mailbox or more). To do so, rlight click on the main mailbox and click on \"Add shared folder\" : \n\n![Image](https://github.com/user-attachments/assets/68ecb96f-ecfc-4c9b-a329-7152da444570)\n\n- starts the addin and uses getCallbackTokenAsync (with isRest: false as it's for EWS).\n\nError when trying the make a soap request with that token: \n_Office extension have no permissions to access any other mailboxes then the mailbox provided in the user context._\n\n![Image](https://github.com/user-attachments/assets/201f6ac8-d414-4f82-b7aa-62fab131c132)\n\nI've also added on the addin manifest:\n```\n<SupportsSharedFolders>true</SupportsSharedFolders> \n```\n\nother post related but closed: https://github.com/OfficeDev/office-js/issues/5136",
    "created_at": "2025-04-28T14:29:26Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Resolution: by design",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "jervalles",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #5136\n- #1292\n- #4626\n- #1140\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nEnsure that the add-in manifest contains the SupportsSharedFolder for the ribbon button used to open the taskpane. This setting is crucial for accessing shared mailboxes correctly.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5136#issuecomment-2540292026\n### Solution 2:\nThe issue might be related to the deployment method of the add-in. If the add-in is deployed using centralized deployment, it might cause issues with accessing shared mailboxes. This has been reported and fixed in the backlog, but depending on the release channel, getting an updated build can take anywhere from 4-6 weeks.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/1140#issuecomment-627885643\n- https://github.com/officedev/office-js/issues/1140#issuecomment-662954944\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-04-28T14:30:26Z"
      },
      {
        "author": "Oleg-O",
        "body": "Can you please confirm the client you're testing with - sounds like Outlook Web? ",
        "created_at": "2025-04-28T17:43:20Z"
      },
      {
        "author": "jervalles",
        "body": "@Oleg-O \n> Can you please confirm the client you're testing with - sounds like Outlook Web?\n\nYes it's Outlook Web.\n\nI'm adding this:\nI'm using this code to load OfficeJs: \n`<script type=\"text/javascript\" src=\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\"></script>`\n",
        "created_at": "2025-04-28T18:19:36Z"
      },
      {
        "author": "whoanuragverma",
        "body": "@jervalles can you please confirm if you are talking about shared mailbox or shared folders? \n\nShared mailboxes aren't supported on Exchange on-prem, you can read more about it [here](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/delegate-access?tabs=windows%2Cxmlmanifest).\n\n![Image](https://github.com/user-attachments/assets/720fed39-ce83-4b7f-a458-382f8b4ff89b)",
        "created_at": "2025-04-29T10:18:47Z"
      },
      {
        "author": "jervalles",
        "body": "> [@jervalles](https://github.com/jervalles) can you please confirm if you are talking about shared mailbox or shared folders?\n> \n> Shared mailboxes aren't supported on Exchange on-prem, you can read more about it [here](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/delegate-access?tabs=windows%2Cxmlmanifest).\n> \n> ![Image](https://github.com/user-attachments/assets/720fed39-ce83-4b7f-a458-382f8b4ff89b)\n\n@whoanuragverma Yes, it is about shared mailbox...\nI've didn't see that.\n\nI saw that I didnt have any functions/keys in the Office.js related to shared mailboxes (ex: isFromSharedFolder or getSharedPropertiesAsync were absent).\nBut I just wanted to use getCallbackTokenAsync (with isRest: false) to get a token from that mailbox.\n\nI guess it's not really because it's a shared mailbox that I did get a token related to that specific mailbox.\nIf I could add a 2nd mailbox on the left collumn (not a shared one), I would have the same problem: \ngetCallbackTokenAsync would anyway retrieve a token for the userProfile, not for the current (openned) mailbox.",
        "created_at": "2025-04-29T13:08:21Z"
      },
      {
        "author": "whoanuragverma",
        "body": "@jervalles I am closing this issue as it is by design, feel free to reopen if you need help with anything else. ",
        "created_at": "2025-04-30T10:47:31Z"
      }
    ]
  },
  {
    "number": 5657,
    "title": "appointmentSending handler is never triggered in new windows outlook or web outlook when deployed from Office 365 admin center",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\nI have an outlook addin that uses the new Unified Json Manifest. The addin consists of two parts - a task pane and a smart alert handler for appointmentSending. The addin was initially generated using yeoman office. When I run this addin in development, (side-loading using npm start) everything works great on all platforms. When I deploy the zip file manifest through integrated apps in Office 365 admin center, I have the following:\n\n- Outlook Windows Classic - Taskpane and Smart Alert - both work fine\n- Outlook Windows New - Taskpane works. Smart Alert never fires - outlook never makes a call to download commands.html and so my launchevent.js is never downloaded and executed\n- Outlook Web - Taskpane works. Smart Alert never fires - outlook never makes a call to download commands.html and so my launchevent.js is never downloaded and executed\n- Outlook for Mac - Untested\n\nI have verified that the build with webpack is correctly putting files where they need to be and on my production server, I can see the files for commands.html and launchevent.js by directly accessing the urls in browser.\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC desktop + web\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Office version number:\nMicrosoft Outlook Version: 1.2025.416.400 (Production)\nClient Version: 20250411007.09\nWebView2 Version: 135.0.3179.98\n\n* Operating System: Windows 11\n* Browser (if using Office on the web): Firefox/Chrome\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nSmart Alert files should be downloaded and run\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nSmart Alert files are not downloaded and therefore not run.\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. Use Yeoman office generator to create a new project\n2. Follow the steps here to add the smart alert https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/smart-alerts-onmessagesend-walkthrough?tabs=jsonmanifest\n3. Verify functionality using dev sideloading\n4. Deploy to production environment using Integrated Apps in Microsoft 265 admin center\n5. Observe that smart alert is never fired\n\n## Link to live example(s)\n<!--- Ideally, provide a link to a live example, created and shared using -->\n<!--- [Script Lab](https://aka.ms/scriptlab). If relevant, create two buttons, -->\n<!--- one that sets up data in the document, and another that exemplifies the issue. -->\n1. ______\n2. ______\n3. ______\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\n1. ______\n2. ______\n3. ______\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [ ] Screenshots\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-04-27T20:22:25Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "renrutsirhc",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #5256\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\nCollect HAR files and console logs following the procedure outlined in the GitHub wiki for Outlook Add-ins issues. This can help in diagnosing why the Smart Alert or LaunchEvent is not being triggered.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5256#issuecomment-2595871543\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-04-27T20:23:02Z"
      },
      {
        "author": "whoanuragverma",
        "body": "@renrutsirhc we are not able to reproduce this issue with the steps you mentioned, can you please share the addin manifest in a private repo and provide access to @exextoc?",
        "created_at": "2025-04-30T10:50:54Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-04T11:29:48Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-07T12:21:15Z"
      }
    ]
  },
  {
    "number": 5656,
    "title": "SmartAlerts manifest doesn't work in Outlook for Mac app.",
    "body": "Related issue: #4283 \nSame issue with the same steps is reproducing again.\n\nFor more info:\nhttps://github.com/DanilKorotenko/OutlookAddin_ItemSend_SmartAlerts\n\nManifest:\n[manifest_smartAlerts.xml.zip](https://github.com/OfficeDev/office-js/files/14694983/manifest_smartAlerts.xml.zip)\n\n### Description\n\nSmartAlerts manifest doesn't work in Mac New Outlook.\n\n### Hardware & Software\n\nMacBook Air M1 2020\nOS: macOs 15.4.1 (24E263)\nOutlook: \nMicrosoft® Outlook for Mac\nVersion 16.96.1 (25042021)\n\n### Steps to reproduce\n\n1. Open Mac New Outlook app.\n2. Go to \"Get Add-ins\" -> \"My Add-ins\"\n3. Install \"manifest_smartAlerts.xml\" from file.\n4. Close window.\n5. Select any message in inbox.\n6. Try to find addin icon on toolbar.\n7. Start composing new message.\n8. Try to find addin icon on toolbar in composing mode.\n9. Send message to any address.\n\nExpected result:\n1. On step 6, addin icon should be present on toolbar.\n2. On step 8, addin icon should be present on toolbar.\n3. On step 9, addin should block message.\n\nActual result:\nInstallation is successfull. But, when reopen manifest installation window, manifest doesn't displayed, like it didn't install.",
    "created_at": "2025-04-27T15:35:55Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Outlook",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "DanilKorotenko",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #4283\n- #4574\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nLooks like having the same resid for launch events and taskpane is causing the issue. Please try using an updated manifest with different resid for launch events and taskpane, it should fix the issue.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4283#issuecomment-2504134420\n- https://github.com/officedev/office-js/issues/4283#issuecomment-2504162627\n### Solution 2:\nAfter investigating, I found that the manifest contains resid=\"lauchEvent\", but lauchEvent is not defined. Replacing it with an already defined resid resolved the issue. Could you try defining it and see if it resolves the issue for you?\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4574#issuecomment-2490411650\n- https://github.com/officedev/office-js/issues/4574#issuecomment-2532095924\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-04-27T15:36:25Z"
      },
      {
        "author": "whoanuragverma",
        "body": "I checked the manifest you shared in the issue, looks it has both the issues - larger icon in the manifest and same resid for launch events and taskpane.\n\nCan you try the manifest shared in this comment https://github.com/OfficeDev/office-js/issues/4283#issuecomment-2504134420?\n\nIf this does not work please capture the incident Id and share with us.\n\nSteps to generate Diagnostics/incident ID:\n\nRe-launch Outlook\nRepro the issue mentioned\nClick on Help->Collect Diagnostics\nShare the ID generated.",
        "created_at": "2025-04-29T06:49:46Z"
      },
      {
        "author": "DanilKorotenko",
        "body": "Sorry, my bad. Everything is working.",
        "created_at": "2025-05-05T10:55:51Z"
      }
    ]
  },
  {
    "number": 5667,
    "title": "Followed the instructions but did not work",
    "body": "### Type of issue\n\nCode doesn't work\n\n### Feedback\n\nI followed the instructions in the documentation:\n\n- `npm install -g yo generator-office`\n- `yo office` (Excel Custom Functions using a Shared Runtime, Javascript, named it \"test\")\n- cd into the dir and run `npm run build`\n- `npm run start -- web --document {url}` where the url is in my sharepoint\n\nIf I do `=CONTOSO.ADD(1,2)`, it shows as `#VALUE!` and not the number. Clicking on \"Show Task Pane\" shows:\n\n```\nCompiled with problems:\nERROR\nConflict: Multiple assets emit different content to the same filename functions.json\n```\n\nCan you please assist?\n\n(node version v22.15.0, npm version 10.9.2, Mac OS Sequoia 15.4.1, Safari 18.4)\n\n### Page URL\n\nhttps://learn.microsoft.com/en-us/office/dev/add-ins/quickstarts/excel-custom-functions-quickstart?tabs=excel-online\n\n### Content source URL\n\nhttps://github.com/OfficeDev/office-js-docs-pr/blob/main/docs/quickstarts/excel-custom-functions-quickstart.md\n\n### Author\n\n@o365devx\n\n### Document Id\n\nd860aff2-60ad-c008-2d10-b046f3198f44\n\n### Platform Id\n\naed5087f-9e24-3632-fb05-4a5e2e569613",
    "created_at": "2025-04-27T05:17:39Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Excel",
      "Type: product bug",
      "Needs: author feedback",
      "Area: custom functions",
      "Status: no recent activity"
    ],
    "author": "douwekiela",
    "comments": [
      {
        "author": "AlexJerabek",
        "body": "Hi @douwekiela,\n\nThanks for reporting this. @alison-mk and I both tried to repo this and got different errors (the add-in never actually sideloaded and an error stating 'Error: Unable to start debugging. Error: The current platform is not supported\"). I'm going to transfer this issue to the product team, since it seems like a tooling bug.\n\nIn the meantime, were you able to get this working on the Mac desktop client? \n ",
        "created_at": "2025-04-28T22:42:18Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi \nWhat change do you made in your add-in? Or you just use a pure new add-in?",
        "created_at": "2025-04-29T10:22:18Z"
      },
      {
        "author": "douwekiela",
        "body": "At first I tried it with some changes and it didn't work, so I created an entirely new one with zero changes, and it did not work either.",
        "created_at": "2025-04-29T17:27:56Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Could you please npm run start to launch the webpack and then sideload the addin? What application do you use?",
        "created_at": "2025-04-30T07:26:36Z"
      },
      {
        "author": "douwekiela",
        "body": "I have been doing that, I ran `npm run start -- web --document {url}` and using the browser window that opens the spreadsheet with the add-in enabled (but the add-in doesn't work due to the aforementioned error).",
        "created_at": "2025-04-30T23:18:06Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Did you edit your question? Looks like your current error info different from the original one. Looks like your current error is caused by your own code. Could you please debug your to see what happened there?",
        "created_at": "2025-05-03T11:19:56Z"
      },
      {
        "author": "douwekiela",
        "body": "I did not edit my question except immediately after posting it. I did not make ANY changes to the code, so I don't know how it is caused by my code?",
        "created_at": "2025-05-03T16:50:33Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Sorry, I can't reproduce your issue. The custom function and Addin works well.\n\n![Image](https://github.com/user-attachments/assets/a6a2d43e-a7cc-4ecf-84ed-dc9d7f5f8b49)\n",
        "created_at": "2025-05-06T05:29:13Z"
      },
      {
        "author": "douwekiela",
        "body": "I just tried it again from scratch, and it did not work. Did you try the exact sequence of commands I shared?\n\nAnyway, you don't really seem interested in fixing this, so perhaps it is best to close this ticket.",
        "created_at": "2025-05-12T05:58:50Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi I can't reproduce your issue by following your sequence. We really want to contribute your success. Thanks.",
        "created_at": "2025-05-13T10:14:27Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-17T13:44:23Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-20T14:37:38Z"
      }
    ]
  },
  {
    "number": 5655,
    "title": "Outlook on-send addin is invoked for appointments, despite only \"ItemIs\"...\"Message\" declared in manifest.",
    "body": "## Environment\n* Platform: Mac\n* Host: Outlook\n* Version number: Outlook for Mac. Version 16.96.1 (25042021)\n* Operating System: macOS 15.4.1\n \n## Expected behavior\nThe appointment is sent.\n\n## Current behavior\nThe appointment is blocked to send.\n\n## Steps to reproduce\n1. Install manifest: [Manifest](https://github.com/DanilKorotenko/OutlookAddin_SimpleBlock/blob/main/manifest.xml)\n2. Create a new appointment. Add at least one person to it.\n3. Press the \"Send\" button.\n\n## Link to live example(s)\nhttps://github.com/DanilKorotenko/OutlookAddin_SimpleBlock\n",
    "created_at": "2025-04-25T19:36:07Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "DanilKorotenko",
    "comments": [
      {
        "author": "whoanuragverma",
        "body": "On-Send is triggered for both mail and appointments, you can read more about this [here](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/outlook-on-send-addins?tabs=windows), if you want your addin to only listen on message send - we would recomment using [Smart Alerts](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/onmessagesend-onappointmentsend-events). It is a newer version of the on-send feature. It was released in [requirement set 1.12](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/outlook/requirement-set-1.12/outlook-requirement-set-1.12) and introduced the OnMessageSend and OnAppointmentSend events. ",
        "created_at": "2025-04-29T09:34:49Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-03T11:20:44Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-06T11:48:36Z"
      }
    ]
  },
  {
    "number": 5654,
    "title": "insert omml into word, error: RichApi.Error: GeneralException",
    "body": "Developing Office Add-ins for Word \n\ninsert omml to word , error: \nword-win32-16.01.js:25  Uncaught (in promise) RichApi.Error: GeneralException\n    at new n (word-win32-16.01.js:25:270362)\n    at r.processRequestExecutorResponseMessage (word-win32-16.01.js:25:335524)\n    at word-win32-16.01.js:25:333585\n\ncode:\nimport {mml2omml} from \"mathml2omml\"\n\nOffice.onReady((info) => {\n\tif (info.host === Office.HostType.Word) {\n\t\tdocument.getElementById(\"sideload-msg\").style.display = \"none\";\n\t\tdocument.getElementById(\"app-body\").style.display = \"flex\";\n\t\tdocument.getElementById(\"run\").onclick = run;\n\t}\n});\n \nexport async function run() {\n\treturn Word.run(async (context) => {\n\n\t\tconst mml = `<math xmlns=\"http://www.w3.org/1998/Math/MathML\">\n\t\t\t<semantics>\n\t\t\t\t<mrow>\n\t\t\t\t\t<mn>2</mn>\n\t\t\t\t\t<mo>+</mo>\n\t\t\t\t\t<mn>2</mn>\n\t\t\t\t\t<mo>=</mo>\n\t\t\t\t\t<mn>4</mn>\n\t\t\t\t</mrow>\n\t\t\t</semantics>\n\t\t</math>`\n\n\t\tconst omml = mml2omml(mml)\n\n\t\tconsole.log(omml)\n\n\t\tcontext.document.body.insertOoxml(omml, Word.InsertLocation.end)\n\t\t\n\t\tawait context.sync();\n\t});\n}\n\nthe omml object is :\n<m:oMath xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"><m:r><m:t xml:space=\"preserve\">2+2=4</m:t></m:r></m:oMath>",
    "created_at": "2025-04-25T07:26:13Z",
    "state": "closed",
    "labels": [
      "Needs: author feedback",
      "Area: Word",
      "Status: no recent activity"
    ],
    "author": "jimesking",
    "comments": [
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "Thank you for letting us know about this issue. We will take a look shortly. Thanks.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-25T07:26:29Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Do I need to download some library?\n\n![Image](https://github.com/user-attachments/assets/7df31db1-fe0b-46b8-bc57-0009c8132eaa)",
        "created_at": "2025-04-29T11:45:53Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-03T16:51:17Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-06T20:06:47Z"
      }
    ]
  },
  {
    "number": 5653,
    "title": "Is there a way to add media files (video, audio) to slides programmatically via PowerPoint JavaScript API?",
    "body": "## Is there a way to add media files (video, audio) to slides programmatically via PowerPoint JavaScript API?\n\nWe are developing a PowerPoint Office.js add-in and working with media files (such as audio and video) in presentations.\n\nCurrently, the PowerPoint JavaScript API allows developers to insert text boxes via the following method:\n\n`addTextBox(text, options): PowerPoint.Shape\n`\n\nThis is extremely helpful for managing text-based content, but there is no equivalent method for adding media files programmatically.\n\nPlease help, is it possible to add media files (video, audio) to slides programmatically via current tools in PowerPoint JavaScript API?",
    "created_at": "2025-04-24T13:26:09Z",
    "state": "closed",
    "labels": [
      "Needs: triage :mag:"
    ],
    "author": "AlexHalynskyi",
    "comments": [
      {
        "author": "EsterBergen",
        "body": "Thank you highlighting this! This would be a new feature. Please make a feature request here [Microsoft 365 Developer Platform Ideas Forum](https://aka.ms/m365dev-suggestions). Please add your request there. Feature requests on are considered when we go through our planning process. Thanks for highlighting this!",
        "created_at": "2025-05-19T16:48:46Z"
      }
    ]
  },
  {
    "number": 5652,
    "title": "Unable to Send Emails in Outlook for Mac After AD Password Change + Add-in Error on Launch",
    "body": "\n## Issue Description:\n\nAfter changing my Active Directory (AD) password and updating macOS, I encountered issues with Outlook for Mac—both with sending emails and with an installed add-in.\n\nHere’s a full breakdown:\n\n## Scenario:\n\n- Changed AD password.\n- Updated Mac to the latest macOS version.\n- Restarted the system. Outlook (which was open before restart) launched automatically.\n- Outlook prompted for authentication — entered new AD password.\n- After signing in:\n  - Could not send new emails or meeting invites — got an error message.\n  - Installed Outlook Add-in showed an error on launch (screenshot attached).\n  - OWA (Outlook Web App) was working fine, including the same Add-in.\n- Closed and reopened Outlook:\n  - Email sending started working again.\n  - Add-in also started functioning normally.\n\n## Ask:\n\n- What caused this temporary failure in email sending and Add-in loading?\n- Is this a known issue with Outlook caching sessions or auth tokens after an AD password change?\n- Any recommendations or known fixes to prevent this in future scenarios?\n\n## Environment:\n\n- Outlook for Mac (latest version as of update)\n- macOS (latest version)\n- Exchange Online (Microsoft 365)\n\n<img width=\"1470\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/a7703ae4-f5cb-471c-b49c-2efe1e4c1084\" />",
    "created_at": "2025-04-24T09:00:03Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "harshitgoyal1711",
    "comments": [
      {
        "author": "shighosh-msft",
        "body": "Hi @harshitgoyal1711, can you please share the following:\n\n1. Diagnostics id if outlook session is still active?\n2. What is meant by unable to send mails, was it blocked by add-in? What was the error you were getting?",
        "created_at": "2025-04-25T06:35:49Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-02T05:22:12Z"
      }
    ]
  },
  {
    "number": 5651,
    "title": "Is adding just a Hosts element as a child element under version 1.0 of VersionOverrides a valid way to prevent our addin from appearing in Outlook for Mac?",
    "body": "By accident, we found that if we add a Hosts element as a child element of VersionOverrides version 1.0 in the manifest, it will appear in all Outlook platforms EXCEPT Outlook for Mac and classic Outlook for Windows.\n\nSee below\n\n```\n...\n  <VersionOverrides xmlns=\"http://schemas.microsoft.com/office/mailappversionoverrides\" xsi:type=\"VersionOverridesV1_0\">\n      <Hosts>\n        <Host xsi:type=\"MailHost\">\n        </Host>\n      <Hosts>\n    <VersionOverrides xmlns=\"http://schemas.microsoft.com/office/mailappversionoverrides/1.1\" \n  xsi:type=\"VersionOverridesV1_1\">\n  ...\n    </VersionOverrides>\n  </VersionOverrides>\n```\n\nIs this a valid and acceptable way to achieve our goal of preventing the addin from appearing in Outlook for Mac or classic Outlook for Windows? Why?\n\nThere doesn't seem to be any documentation out there referring to this and we want to make sure we are doing it properly.\n\nP.s.\nIf we remove the Hosts element like below, it will show up in all platforms including Outlook for Mac and classic Outlook for Windows\n```\n...\n  <VersionOverrides xmlns=\"http://schemas.microsoft.com/office/mailappversionoverrides\" xsi:type=\"VersionOverridesV1_0\">\n    <VersionOverrides xmlns=\"http://schemas.microsoft.com/office/mailappversionoverrides/1.1\" \n  xsi:type=\"VersionOverridesV1_1\">\n  ...\n    </VersionOverrides>\n  </VersionOverrides>\n```",
    "created_at": "2025-04-24T06:36:16Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback"
    ],
    "author": "markdii",
    "comments": [
      {
        "author": "whoanuragverma",
        "body": "A manifest can implement multiple versions of the <VersionOverrides> element which support different versions of the VersionOverrides schema. This can be done to optionally support new features in a newer schema while still supporting older clients that don't support the new features.\n\nThe manifest is designed to support multiple VersionOverrides versions to handle different client capabilities, for example:\n- VersionOverridesV1_0 supports general add-in commands and later versions of the Office JavaScript API.\n- VersionOverridesV1_1 is specific to Outlook and adds newer features like pinnable task panes and mobile add-ins.\n\nUnfortunately, it is not possible to hide addins on specific platforms. You can read more here: [VersionOverrides element](https://learn.microsoft.com/en-us/javascript/api/manifest/versionoverrides?view=common-js-preview)\n\n\n\n",
        "created_at": "2025-04-28T11:13:46Z"
      },
      {
        "author": "markdii",
        "body": "Hi @whoanuragverma , I understand that but my question is why does adding the Hosts element there makes the addin not appearing in Outlook for Mac?",
        "created_at": "2025-05-02T13:59:04Z"
      },
      {
        "author": "sivachandran-msft",
        "body": "Hi @markdii, one probable reason could be validation of the add-in manifest is failing. Could you please check you add-in manifest following [this](https://learn.microsoft.com/en-us/office/dev/add-ins/testing/troubleshoot-manifest#validate-your-manifest-with-the-validate-command). ",
        "created_at": "2025-05-07T12:20:32Z"
      }
    ]
  },
  {
    "number": 5646,
    "title": "CSS Not Loading Properly for Add-in in Outlook for Mac (New and Old Versions) – Issue on Single Mac, Resolved Only After Outlook Reinstallation",
    "body": "## Description:\nWe observed an issue with our Outlook Add-in on a single Mac system (affecting both New and Old Outlook versions) where the Add-in's CSS failed to load properly, causing the UI to break.\n\n- Relogging into Outlook (even multiple times) did not resolve the issue.\n\n- Restarting Outlook also did not help.\n\n- Only reinstalling Outlook fixed the problem.\n\n- On other Mac systems, the Add-in is loading correctly without any issues.\n\n- No such issue is reported on Windows systems.\n\nThis suggests a possible cache corruption or resource loading issue specific to that system/environment on Mac.\n\n## Steps to Reproduce (Observed on Single Mac):\n\n- Open Outlook for Mac (New or Old version) on the affected system.\n\n- Load the Add-in.\n\n- Notice the Add-in UI appears broken (CSS not applied).\n\n- Attempt relogin — issue persists.\n\n- Reinstall Outlook — issue gets resolved.\n\n## Impact:\n\n- User experience was severely impacted on the affected system.\n\n- Hard to troubleshoot because regular actions (relogin, restart) did not help.\n\n- Problem appears isolated but may indicate a potential cache management bug in Outlook for Mac.\n\n## Environment Details:\n\n![Image](https://github.com/user-attachments/assets/6223c245-fff9-45e6-9295-83dc32a7a526)\n![Image](https://github.com/user-attachments/assets/3add3211-6b13-432f-b690-e5eeba526910)\n\nOutlook: Both New and Old Outlook (latest available versions)\n\nAffected Systems: Only one Mac (others working fine)\n\nWindows Systems: No issues observed\n\nRequest:\nPlease investigate cache handling or static resource loading mechanisms for Add-ins in Outlook for Mac, particularly for isolated cache corruptions.",
    "created_at": "2025-04-23T11:48:37Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "harshitgoyal1711",
    "comments": [
      {
        "author": "shighosh-msft",
        "body": "Hi @harshitgoyal1711 - this seems like an issue with caching, in such cases users can clear the above cache to get unblocked. \nPlease refer the following doc: https://learn.microsoft.com/en-us/office/dev/add-ins/testing/clear-cache#clear-the-office-cache-on-mac",
        "created_at": "2025-04-24T13:29:10Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-28T14:02:39Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-01T14:53:17Z"
      }
    ]
  },
  {
    "number": 5637,
    "title": "Erratic behavior in addFileAttachmentAsync and removeAttachmentAsync in Outlook New UI for Mac",
    "body": "# Erratic behavior in addFileAttachmentAsync and removeAttachmentAsync in Outlook New UI for Mac\n\n## Your Environment\n* Platform: Mac\n* Host: Outlook New UI\n* Office version number: Tested on 16.95.3\n* Operating System: Tested on macOS 15.1\n\n## Expected behavior\n`addFileAttachmentAsync` and `removeAttachmentAsync` should consistently add and remove file attachments, respectively, and return a success status only when the operation is completed successfully.\n\n## Current behavior\nOn Mac with the new Outlook UI:\n- Sometimes, attachments are not added despite receiving an `OK` status from `addFileAttachmentAsync`.\n- Similarly, attachments are not removed even when `removeAttachmentAsync` returns a success response.\n\n## Steps to reproduce\n1. Create an Outlook add-in that uses `addFileAttachmentAsync` and `removeAttachmentAsync` wrapped in JavaScript promises.\n2. Test the functionality on different platforms:\n   - Web: Works as expected (Mac and Windows: Edge, Chrome, Safari, Firefox...).\n   - Windows: Works as expected (Outlook classic and new UI).\n   - Mac New UI: Erratic behavior observed.\n3. Observe that:\n   - Attachments occasionally fail to be added or removed, even though the functions report success.\n\n## Link to live example(s)\nUnfortunately, this issue occurs inconsistently, making it difficult to provide a reliable live example. Related issues:\n- [Issue 2680](https://github.com/OfficeDev/office-js/issues/2680)\n- [Issue 2490](https://github.com/OfficeDev/office-js/issues/2490)\n\n# Provide additional details\n1. We encapsulate these calls (`addFileAttachmentAsync` and `removeAttachmentAsync`) in JavaScript promises instead of using callbacks for better control and readability in our codebase.\n2. The inconsistent behavior is specific to Mac New UI and does not manifest on other platforms.\n\n## Context\nThis issue affects our users who rely on Mac with the new Outlook UI. The inability to consistently add or remove attachments reduces trust in the add-in's functionality and impacts the user experience.\n\n## Useful logs\n- [ ] Console errors:\n- [ ] Screenshots:\n- [ ] Test file:\n",
    "created_at": "2025-04-22T09:27:08Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "iosebyte",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #2680\n- #2490\n- #2721\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nThis issue has been put on our backlog. We unfortunately have no timelines to share at this point. Internal tracking id: Office: 6211967\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/2680#issuecomment-1174665283\n- https://github.com/officedev/office-js/issues/2680#issuecomment-1756734226\n### Solution 2:\nThe product bug is resolved as we are not able to reproduce the issue at our end.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/2490#issuecomment-1266764796\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-04-22T09:27:58Z"
      },
      {
        "author": "shighosh-msft",
        "body": "Hi @iosebyte, we are not able to repro this issue at our end? Can you please share a repro video showing your use-case. Also consider sharing a minimal add-in that we can use to repro this issue if possible. You can create a private repo on GitHub and share it with us with all the resources. Thanks!",
        "created_at": "2025-04-23T12:28:48Z"
      },
      {
        "author": "iosebyte",
        "body": "You can follow the steps described at https://github.com/OfficeDev/office-js/issues/2680. It is the same case.",
        "created_at": "2025-04-24T03:34:23Z"
      },
      {
        "author": "whoanuragverma",
        "body": "We are still not able to repro this issue; can you please share a repro video with steps needed to repro this bug. Also consider sharing a minimal add-in that we can use to repro this issue if possible. You can create a private repo on GitHub and give access to @exextoc .",
        "created_at": "2025-04-29T09:41:25Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-03T11:20:45Z"
      },
      {
        "author": "iosebyte",
        "body": "> We are still not able to repro this issue; can you please share a repro video with steps needed to repro this bug. Also consider sharing a minimal add-in that we can use to repro this issue if possible. You can create a private repo on GitHub and give access to [@exextoc](https://github.com/exextoc) .\n\nOk, I'm, working on it",
        "created_at": "2025-05-06T08:29:05Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-09T08:55:44Z"
      }
    ]
  },
  {
    "number": 5634,
    "title": "MSAL v3 library return expired tokens",
    "body": "\nI have implemented NAA using the link (https://learn.microsoft.com/en-us/office/dev/add-ins/develop/enable-nested-app-authentication-in-your-add-in) with the below code using the MSAL library version v3.28.1 :\n\ninitializeMSALv3:function(){\n    const msalConfig = {\n        auth:\n        {\n            clientId: xxx ,\n            authority: \"https://login.microsoftonline.com/common\"\n        }\n    };\n    msal.createNestablePublicClientApplication(msalConfig).then(function(response){\n        msalInstance=response;\n       acquireTokensUsingMSALv3();\n    });\n}\nacquireTokensUsingMSALv3:function(){\nvar tokenRequest={ scopes:\"Mail.Read, offline_access, openid, profile, User.Read\",forceRefresh:true };\nmsalInstance.acquireTokenSilent(tokenRequest).then( function(tokenResponse) {\nif(tokenResponse.idToken!=null && tokenResponse.idToken!=\"\"){\nconsole.log(tokenResponse);\n}\n}).catch(\nmsalInstance.acquireTokenPopup(tokenRequest).then(function(tokenResponse){\nif(tokenResponse.idToken!=null && tokenResponse.idToken!=\"\"){\nconsole.log(tokenResponse);\n}\n})\n);\n}\n\nBut I'm getting expired tokens, how can I make sure the tokens returned are always valid despite of giving **forceRefresh:true** ??\n\n",
    "created_at": "2025-04-21T07:50:55Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: authentication"
    ],
    "author": "e-vidyaraghavi",
    "comments": [
      {
        "author": "mattgeim",
        "body": "Hello, \n\nTo get a non-expired token every time, use the access token, not the ID token.  More information is available in our FAQ on NAA for Outlook: https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/faq-nested-app-auth-outlook-legacy-tokens#why-is-the-id-token-not-refreshed",
        "created_at": "2025-05-20T16:48:41Z"
      }
    ]
  },
  {
    "number": 5632,
    "title": "Outlook fetches old addin javascript while triggering SendMail event from ItemSend",
    "body": "ItemSend Addin was deployed earlier and SendMail callback worked fine with Javascript hosted on cloud URL. \nLater uninstalled Addin and cloud JS files are updated (due to a fix) in same cloud URL.\nDeployed Addin again and now Outlook fetches old Javascript from cloud URL.\n\nIf we access same cloud URL from browser, it fetches latest Javascript.\nStarted using \"olk.exe --devtools\" and enabled \"Disable caching\" in Outlook. Now SendMail callback fetches latest javascript.\n\n## Your Environment\n\n* Platform [PC desktop, Mac, iOS, Office on the web]:  Windows\n* Host [Excel, Word, PowerPoint, etc.]:  Outlook\n* Office version number: \n\nMicrosoft Outlook Version: 1.2025.411.300 (Production)\nClient Version: 20250411007.06\nWebView2 Version: 135.0.3179.73 (Stable)\nSession ID: c12cd3f0-357b-4a42-a200-d20e19566345\n\n* Operating System:  Windows 11\n* Browser (if using Office on the web):  Chrome (for only testing addin files from cloud URL)\n \n## Expected behavior\nAddin should fetch latest files from cloud URL\n\n## Current behavior\nAddin fetches OLD files from cloud URL\n\n## Steps to reproduce\n1. ItemSend Addin was deployed earlier and SendMail callback worked fine with Javascript hosted on cloud URL. \n2. Later uninstalled Addin\n3.  Update cloud JS files are updated (due to a fix) in same cloud URL.\n4. Deploy Addin again\n5. now Outlook fetches old Javascript from cloud URL when sendmail is clicked\n\n## Context\nGetting old Addin files causes latest version not working properly.\n\n## Useful logs\nOutlook app doesnt provide logs.\n\n",
    "created_at": "2025-04-18T16:42:38Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "mkondadg",
    "comments": [
      {
        "author": "shighosh-msft",
        "body": "Hi @mkondadg, can you please confirm the following:\n\n- Are you seeing this behavior only in New Outlook app? \n- Is the correct version of the JS file is getting fetched while using OWA with the same user account?\n- \"Deployed Addin again\" - how was the add-in re-deployed?\n- Was there any change to the manifest of the add-in? This is to confirm that whether the users had to re-install the add-in after the changes were made.",
        "created_at": "2025-04-21T10:24:05Z"
      },
      {
        "author": "mkondadg",
        "body": "Hi @shighosh-msft  Thanks for getting back to us on this. Find answers below.\n\n- Yes. Seeing this behavior with only New Outlook App. We use COM sensor for Old outlook and hence we cant test addin with Old outlook.\n- We didnt check with OWA when the issue reproduced.\n- Sideloading deploy, sideloading undeploy and sideloading deployment again.\n- No change in manifest xml. Only Javascript modified during 1st and 2nd deployment. The users were re-installing the sideloaded addin",
        "created_at": "2025-04-21T15:41:48Z"
      },
      {
        "author": "shighosh-msft",
        "body": "Hi @mkondadg - thanks for confirming the details. Can you please confirm if doing \"olk.exe --devtools\" and enabled \"Disable caching\" in Outlook - unblocks your users. Also, can you please check if this issue is only in New Outlook or you see this in OWA as well.",
        "created_at": "2025-04-23T12:37:34Z"
      },
      {
        "author": "shighosh-msft",
        "body": "Also, there is some guidance here that can help users clear the cache for any resources stored by office add-ins. [https://learn.microsoft.com/en-us/office/dev/add-ins/testing/clear-cache](https://learn.microsoft.com/en-us/office/dev/add-ins/testing/clear-cache) - let us know if this helps.",
        "created_at": "2025-04-23T12:45:13Z"
      },
      {
        "author": "mkondadg",
        "body": "@shighosh-msft Disabling the cache using \"olk.exe --devtools\" helped but is this the solution to address large no. of users (for admin managed addin) ? We are testing use sideloading for now but wanted to know your thoughts on admin managed addin.\n\nWe currently dont have the setup (with cloud hosting modifiable) to retest on Old outlook and OWA.\nWill post you when we have some updates.",
        "created_at": "2025-04-23T16:33:25Z"
      },
      {
        "author": "whoanuragverma",
        "body": "@mkondadg can you please share logs by following these steps [Collecting log files for Outlook Add‐ins issues](https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues) in a private repo and give access to @exextoc?",
        "created_at": "2025-05-01T14:59:48Z"
      },
      {
        "author": "mkondadg",
        "body": "@whoanuragverma We dont have environment now. Will keep you posted when I have some updates.",
        "created_at": "2025-05-02T19:31:04Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-09T05:53:33Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-12T07:18:29Z"
      }
    ]
  },
  {
    "number": 5629,
    "title": "[Word] Feature Request: Support for Range Start and End properties similar to C# Word Interop",
    "body": "I’d like to request a feature for the Word API: **exposing `start` and `end` properties on the `Range` object**, similar to what is available in C# Word Interop.\n\nIn C#, a `Range` object has `Start` and `End` properties that allow precise control over range manipulation, comparisons, and modifications. For example, this enables developers to:\n\n- Insert content at a specific location\n- Expand or shrink a range programmatically\n\nCurrently in Office-JS, the `Range` object abstracts away the positional information, making some of these scenarios much harder or impossible to implement.\n\n#### Feature suggestion\nIntroduce something like:\n```js\nrange.start; // Returns the position index from the beginning of the document\nrange.end;   // Returns the end index\n```\n\n#### Example use cases\n- Insert content at a specific location\n- Navigating document content by position\n\nThis would significantly improve the capabilities for building more sophisticated Word add-ins.\n\nThanks for considering this feature!",
    "created_at": "2025-04-18T10:19:49Z",
    "state": "closed",
    "labels": [
      "Needs: triage :mag:"
    ],
    "author": "fangd1997",
    "comments": [
      {
        "author": "EsterBergen",
        "body": "Thank you highlighting this! This would be a new feature. Please make a feature request here [Microsoft 365 Developer Platform Ideas Forum](https://aka.ms/m365dev-suggestions). Please add your request there. Feature requests on are considered when we go through our planning process. Thanks for highlighting this!",
        "created_at": "2025-05-19T16:51:23Z"
      }
    ]
  },
  {
    "number": 5627,
    "title": "Add-In always visible in Outlook (without additional clicking)",
    "body": "Hello,\n\nIs there a chance we can create an add-in in the Office JavaScript API library (Outlook) that will always be open even if the user selects another add-in or performs another action?",
    "created_at": "2025-04-18T08:46:28Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Resolution: by design"
    ],
    "author": "DarekOgorek",
    "comments": [
      {
        "author": "shighosh-msft",
        "body": "Hi @DarekOgorek - the use-case you mentioned -  _will always be open even if the user selects another add-in or performs another action_ is not clear from the description you provided. Can you please elaborate more on this? Are looking to run some officeJS api in background always irrespective of user action to launch some other addin?",
        "created_at": "2025-04-28T03:02:43Z"
      },
      {
        "author": "DarekOgorek",
        "body": "Hi @shighosh-msft , Sorry for the incomplete usage scenario. Generally, I need the open add-in to be visible at all times, regardless of whether the user is modifying an email or viewing another one. In short - once the add-in is opened, it does not disappear from the task pane and the user has access to it non-stop.",
        "created_at": "2025-04-29T14:03:25Z"
      },
      {
        "author": "whoanuragverma",
        "body": "Unfortunately, it's not possible to keep an Outlook add-in always visible when the user navigates between items or selects another add-in. \n\nYou can explore [pinnable task panes](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/pinnable-taskpane?tabs=jsonmanifest), which allow users to manually pin the add-in for specific item types. However, this must be done by the user and does not persist across all contexts.\n\nThis is by design, hence I am closing this issue.",
        "created_at": "2025-04-30T11:04:00Z"
      }
    ]
  },
  {
    "number": 5622,
    "title": "Unable to Read Image Layout After Changing from Inline to Square in Word Add-in",
    "body": "I have a requirement where I need to insert or update an image in Word. I'm currently able to insert and update the image inside the content control. However, when I change the image layout from \"inline\" to \"square\" (or any other layout) and reposition the image, it gets removed from the content control. As a result, the next time I update the content control, a new image is inserted instead of replacing the existing one.\n\nTo work around this, I modified the logic to insert the image directly as an inline picture, which also allows me to update it successfully. But when I change the layout of the image (e.g., from inline to square), I can no longer access it using the InlinePicture APIs. I noticed that I can still read the image using the Shapes collection, but I'm unable to determine the image’s layout property.\n\nIs there any API or property available in Office.js that allows me to read the layout type of an image (e.g., inline, square, tight, etc.)?\n\n## Your Environment\n\n* Platform [PC desktop, Mac, iOS]\n* Host [ Word, PowerPoint]\n* Office version number: Microsoft® Word for Microsoft 365 MSO (Version 2502 Build 16.0.18526.20168) 64-bit \n* Operating System:  Windows 11\n* Browser (if using Office on the web): Edge\n",
    "created_at": "2025-04-17T07:52:41Z",
    "state": "closed",
    "labels": [
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "shermaro91",
    "comments": [
      {
        "author": "penglongzhaochina",
        "body": "Hi @shermaro91  Thank you for reporting the issue. Could you please share your script which can reproduce your issue in ScriptLab? And Do your issue happen in  online or desktop?",
        "created_at": "2025-04-22T05:36:05Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-10T08:23:37Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-13T10:58:53Z"
      }
    ]
  },
  {
    "number": 5620,
    "title": "[Bug] Permission Denied (code 7000) when calling Graph API from Outlook Add-in on Mac New Outlook (v16.95.3)",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\nWhen using an Outlook Web Add-in that sends email via Microsoft Graph, the add-in works fine across Windows Classic Outlook, Windows New Outlook, and Outlook Web (OWA).\n\nHowever, on Mac New Outlook (Version 16.95.3, Build 25032931) the same add-in fails with the following error before reaching the Graph API call:\n```\n{\n  \"status\": \"failed\",\n  \"error\": {\n    \"name\": \"Permission Denied\",\n    \"message\": \"You don't have sufficient permissions for this action.\",\n    \"code\": 7000\n  }\n}\n\n```\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Outlook Mac: New Outlook\n* Host [Excel, Word, PowerPoint, etc.]: New Outlook\n* Office version number: Version: 16.95.3 (25032931)\n* Operating System: Mac OS\n* Browser (if using Office on the web): ______\n \n## Expected behavior\nThe add-in should behave consistently across platforms, allowing the user to send email using Microsoft Graph after a successful token acquisition, just as it does on Windows and OWA.\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\n\n## Steps to reproduce\n1. Create an Outlook Web Add-in that sends mail using fetch or PnPjs through the \n    /me/sendMail Graph API.\n\n2. Use OfficeRuntime.auth.getAccessToken() to acquire an access token.\n\n3. Try running the add-in on Outlook for Mac (New Outlook enabled) — version \n    16.95.3 (25032931).\n\n4. Observe the Permission Denied error with code 7000.\n\n## Link to live example(s)\n<!--- Ideally, provide a link to a live example, created and shared using -->\n<!--- [Script Lab](https://aka.ms/scriptlab). If relevant, create two buttons, -->\n<!--- one that sets up data in the document, and another that exemplifies the issue. -->\n1. ______\n2. ______\n3. ______\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\n1. ______\n2. ______\n3. ______\n\n## Context\nThis problem only occurs on Mac New Outlook. The same code works perfectly:\n\n1. On Windows Classic Outlook.\n2. On Windows New Outlook.\n3. In Outlook Web (OWA).\n\n<img width=\"1053\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/56905ece-80bc-49a9-ad13-d1a92db36420\" />\n<img width=\"996\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/ce7ddf20-0719-4896-8c67-9ce776757ab1\" />\n\n\n\nIt looks like Mac's OfficeRuntime.auth.getAccessToken() is returning a token that lacks permission or the platform is blocking the API call before execution.\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [ ] Screenshots\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-04-17T05:38:55Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Resolution: external",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "VamseeAcc",
    "comments": [
      {
        "author": "neprasad-microsoft",
        "body": "Hi @VamseeAcc \nThis forum is limited to supporting office-js apis. For any MS API Graph specific queries and support, please explore options available at [Microsoft Graph Dev Center](https://developer.microsoft.com/en-us/graph)",
        "created_at": "2025-04-17T14:10:41Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-21T21:51:31Z"
      }
    ]
  },
  {
    "number": 5619,
    "title": "compareLocationWith() requires both ranges to be created within the same request context, preventing valid comparisons across Word.run calls.",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Word (Office JS Add-in) - tested on PC desktop\n* Host [Excel, Word, PowerPoint, etc.]: Word for Windows Desktop\n* Office version number: Microsoft 365 (latest as of April 2025)\n* Operating System: Windows 11 Home\n* Browser (if using Office on the web): N/A\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nThe compareLocationWith() method should be able to compare two Range objects that have been created in different Word.run() calls, assuming both ranges have been tracked properly and passed into the same Word.run() call via an array of tracked objects.\n\nawait Word.run([range1, range2], async context => {\n          const relation = range1.compareLocationWith(range2);\n          await context.sync();\n          console.log(\"Relation:\", relation.value);\n      });\n\nThis should work if range1 and range2 are both valid, tracked Range objects.\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nIf range1 and range2 originate from different Word.run() contexts (which is common in event-based handlers), attempting to pass them together into a new Word.run([range1, range2], ...) results in a runtime error, even if both objects were tracked.\n\nTypical error: \"cannot use the object across different request contexts\"\n\nThis prevents the use of compareLocationWith() in many valid scenarios where both ranges exist and are tracked, but were created separately.\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1.   In Word.run(), create and track a range from the document body:\n\n      let range1;\n      await Word.run(async context => {\n          range1 = context.document.body.paragraphs.getLast().getRange(\"Whole\");\n          range1.track();\n          await context.sync();\n      });\n\n2.   In a second Word.run(), create and track another range:\n\n      let range2;\n      await Word.run(async context => {\n          range2 = context.document.body.paragraphs.getFirst().getRange(\"Whole\");\n          range2.track();\n          await context.sync();\n      });\n\n3.    Attempt to use both ranges in a third Word.run():\n\n       await Word.run([range1, range2], async context => {\n          const relation = range1.compareLocationWith(range2);\n          await context.sync();\n      });\n\n4.    Observe that this fails with an error:  \"cannot use the object across different request contexts\"\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\nThe inability to compare valid Range objects across Word.run() calls significantly limits the use of compareLocationWith(), especially in event-driven workflows.\n\nIdeally, tracked objects should remain compatible across contexts if they’re passed in properly, or an official mechanism should exist to safely promote or compare them across contexts.\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n\"cannot use the object across different request contexts\"\n",
    "created_at": "2025-04-16T13:07:25Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Word"
    ],
    "author": "binteract",
    "comments": [
      {
        "author": "xiruatms",
        "body": "Hi, @binteract , thanks for reporting this.\n\nIn this scenario, you're correct to call <object>.track() so that object can be accessed across Word.run.  But do remember to make sure when you tried to access those tracked objects in another Word.run, the tracked objects should all be in one context. That is, you need to put range1, range 2 in one Word.run, and use them in another Word.run. \n\nHope this can mitigate your usage.\n\nIf you do require tracked objects among different contexts, that'll be a change request to the current implementation (which is consistent among all Office.JS).",
        "created_at": "2025-04-21T02:13:25Z"
      },
      {
        "author": "binteract",
        "body": "The issue was related to needing to track 2 different objects across different contexts, otherwise it's useless to track objects in event driven workflows.",
        "created_at": "2025-05-02T06:24:48Z"
      }
    ]
  },
  {
    "number": 5617,
    "title": "Is there a way to detect that user has closed a smart alert dialog?",
    "body": "Let's say my event-based addin causes this dialog to appears after user clicks send because they haven't fulfilled certain conditions.\n\n![Image](https://github.com/user-attachments/assets/8643f2ee-d577-4d64-a4f2-01d2f1ff61d3)\n\nRef: https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/onmessagesend-onappointmentsend-events?tabs=windows#soft-block\n\nI would like a function in the taskpane to run immediately after user has closed the dialog e.g. by clicking 'x' or Don't Send.\n\nIs it possible? If not, are there plans to enable this and where can I read more of it?\n\nP.s., I'm developing my addin in React Typescript.",
    "created_at": "2025-04-15T15:06:48Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Type: product feature request"
    ],
    "author": "markdii",
    "comments": [
      {
        "author": "victoria-msft",
        "body": "Hello @markdii,\n\nThank you for reaching out to us. Currently, this is not supported by the platform. In a nutshell, this is because when the event handler calls the completed method of its event parameter, or five minutes have elapsed since the triggering event, or the user changes focus from the window where the event was triggered, the runtime ends. Below is some additional documentation on runtimes for your information if you'd like to read up on it. \n\nWe track Outlook add-in feature requests on our [Tech Community Page](http://aka.ms/M365dev-suggestions). If you would like this feature to be considered in our planning in the future, please submit your request there and choose the appropriate label(s). Feature requests on Tech Community are considered when we go through our planning process.\n\n[Understanding the Office Add-ins runtime](https://learn.microsoft.com/en-us/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins)\n[Browsers and webview controls used by Office Add-ins](https://learn.microsoft.com/en-us/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins)\n[Runtimes in Office Add-ins](https://learn.microsoft.com/en-us/office/dev/add-ins/testing/runtimes)",
        "created_at": "2025-04-21T23:55:07Z"
      }
    ]
  },
  {
    "number": 5615,
    "title": "Office.context.mailbox.getCallbackTokenAsync Error 9042",
    "body": "I am getting this error every time I run \"Office.context.mailbox.getCallbackTokenAsync\", but I can't find any description for this error.\n\n![Image](https://github.com/user-attachments/assets/7cf12804-f6ea-4c13-9996-3b2b331ecdab)\n\n![Image](https://github.com/user-attachments/assets/2238073e-77ba-4835-989a-8ffe4ab0f740)",
    "created_at": "2025-04-15T10:25:43Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: authentication",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "CodeCube0",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #4156\n- #3703\n- #5516\n- #4626\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nWe don't support getCallbackTokenAsync for accounts that are not subscribed to M365.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4626#issuecomment-2205119824\n### Solution 2:\nThe issue is now resolved. Please feel free to comment and re-open if you still see the issue, with specific repro steps.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4156#issuecomment-1970464573\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-04-15T10:26:14Z"
      },
      {
        "author": "CodeCube0",
        "body": "I would like to understand if it is a permissions problem, expired exchange server certificates or something else. I did not find any description for this error on the following page\n\nhttps://learn.microsoft.com/en-us/office/dev/add-ins/reference/javascript-api-for-office-error-codes",
        "created_at": "2025-04-15T11:15:15Z"
      },
      {
        "author": "max-yushchuk",
        "body": "This method is already deprecated and turned off by default. Will be completely deprecated in June 2025.\nSee this: https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/authentication#callback-tokens\n\nBut it can be enabled by the tenant Admin manually - https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/turn-exchange-tokens-on-off",
        "created_at": "2025-04-15T12:50:05Z"
      },
      {
        "author": "mattgeim",
        "body": "Thanks @max-yushchuk - that is correct. \n\n@CodeCube0  You can find more information on the legacy token deprecation here:  https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/faq-nested-app-auth-outlook-legacy-tokens ",
        "created_at": "2025-05-20T16:53:38Z"
      }
    ]
  },
  {
    "number": 5614,
    "title": "On forward, method getAttachmentContentAsync() returns content as empty string on new outlook",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\nIn a scenario, where user forwards mail item with attachments, `item.getAttachmentContentAsync` returns `Office.AttachmentContent`, however `content` property has empty string instead of actual content data. This is intermittent issue. Does not happen every time, however does happen fairly regularly.\n\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: New Outlook - version 1.2025.404.500 (Production)\n* Office version number: Outlook 20250425004.11\n* Operating System: Windows 11 Enterprise\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nCalling `item.getAttachmentContentAsync` on forwarding item with attachments, should return `Office.AttachmentContent` that has content property with actual data.\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nCalling `item.getAttachmentContentAsync` on forwarding item with attachments, returns `Office.AttachmentContent` that has content property with empty string. This is intermittent issue. Does not happen every time.\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. Send yourself mail item with few attachments on it.\n2. Forward this item, add some body, and press send.\n3. Check the content value that was returned during onSend function.\n4. If above steps did not work, try again, eventually the condition will happen. (Intermittent issue)\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\nEssentially, we are trying to process the attachment data before sending. Where the content property has empty string instead, this leads to situations, where we can't process these attachments.\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\nW use `@types/office-js` version 1.0.401.\nHere is example code how we get attachment content:\n```\nfunction getMailbox() : Office.Mailbox {\n\tconst result = getContext().mailbox;\n\tif (result) {\n\t\treturn Office.context.mailbox;\n\t}\n\tthrow new Error();\n}\n\nfunction getMailboxItem() : MailboxItem {\n\tconst result = getMailbox().item;\n\tif (result) {\n\t\treturn result;\n\t}\n\tthrow new Error();\n}\n\ngetAttachmentContentAsync(id: string): Promise<Office.AttachmentContent> {\n\treturn new Promise((resolve, reject) => {\n\t\tthis.getMailboxItem().getAttachmentContentAsync(id, (asyncResult) => {\n\t\t\tif (asyncResult.status === Office.AsyncResultStatus.Failed) {\n\t\t\t\treject(asyncResult.error);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tresolve(asyncResult.value);\n\t\t});\n\t});\n}\n```\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-04-15T10:03:00Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "GirtsJermacans",
    "comments": [
      {
        "author": "sanchitagarwal-msft",
        "body": "@GirtsJermacans The issue could not be reproduced using the details provided. Can you please provide a repro using ScriptLab, and we can investigate further. ",
        "created_at": "2025-04-21T03:48:32Z"
      },
      {
        "author": "GirtsJermacans",
        "body": "@sanchitagarwal-msft thanks for a quick response. I'll double check this using ScriptLab, but might be a little while as person who was able to repro this regularly is currently on A/L. I will follow up on this once the person is back.",
        "created_at": "2025-04-24T09:12:16Z"
      },
      {
        "author": "GirtsJermacans",
        "body": "@sanchitagarwal-msft Hey! The person is back from A/L so will have a look at ScriptLab for this. However, I did notice that my initial post had a mistake in office version. It is updated now.\n\n- Office version - 20250425004.11.\n- New Outlook version - 1.2025.404.500 (Production).\n\nCan you please double check if it is possible to repro it with this setup?\n",
        "created_at": "2025-05-06T16:25:43Z"
      },
      {
        "author": "megharai1302",
        "body": "@GirtsJermacans , with the office version mentioned also. I am not able to repro this , For me I am able to get the content when run this api with attachment attached.",
        "created_at": "2025-05-14T08:15:38Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-18T15:08:46Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-21T17:23:34Z"
      }
    ]
  },
  {
    "number": 5613,
    "title": "Missing HKCU Office WEF Registry Key Despite Functioning Centrally Deployed Add-in, Preventing Runtime Logging Setup",
    "body": "\n# Missing HKCU Office WEF Registry Key Despite Functioning Centrally Deployed Add-in, Preventing Runtime Logging Setup\n\n## Your Environment\n* Platform [PC desktop, Mac, iOS, Office on the web]: **PC desktop** (Inferred from GPO, Registry Editor use)\n* Host [Excel, Word, PowerPoint, etc.]: **Outlook**\n* Office version number: **Microsoft 365 Apps, Version 2408 (Build 17928.20440), Semi-Annual Enterprise Channel**\n* Operating System: **Windows** (Inferred from context, specific version not provided)\n* Browser (if using Office on the web): N/A\n\n## Expected behavior\nWhen a centrally deployed Office Web Add-in is running successfully within Outlook, the associated user-specific registry keys under `HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\16.0\\WEF\\` should be present. This includes the base `WEF` key, which is required to subsequently create the necessary keys (`Developer\\<Add-in ID>\\UseRuntimeLogging`) to enable the runtime logging feature for debugging purposes.\n\n## Current behavior\nThe Office Web Add-in, deployed via Centralized Deployment, is confirmed to be running correctly within the Outlook client. Evidence of this includes the add-in's functionality being available and the existence of the corresponding cache/data folder structure at `%LocalAppData%\\Microsoft\\Office\\16.0\\WEF\\<Add-in ID>\\`.\nHowever, when inspecting the registry using `regedit.exe`, the key `HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\16.0\\WEF\\` is completely missing. This absence prevents the creation of the `Developer\\<Add-in ID>\\UseRuntimeLogging` DWORD value, thus blocking the ability to enable runtime logging using the standard documented method.\n\n## Steps to reproduce\n1.  Deploy an Office Web Add-in using **Centralized Deployment** via the M365 Admin Center.\n2.  Ensure the target environment is using Office M365 Apps (specifically tested on **Version 2408, Semi-Annual Channel**) on a Windows desktop, potentially managed via GPO.\n3.  Launch Outlook and verify the centrally deployed add-in loads and is operational.\n4.  (Optional) Confirm the existence of the add-in's cache folder at `%LocalAppData%\\Microsoft\\Office\\16.0\\WEF\\<Add-in ID>\\`.\n5.  Open Registry Editor (`regedit.exe`).\n6.  Navigate to `HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\16.0\\`.\n7.  Observe that the `WEF` subkey is **not present** under the `16.0` key.\n\n## Link to live example(s)\n1.  N/A - Issue relates to registry state in a specific corporate/deployment environment rather than a shareable code sample.\n\n# Provide additional details\n1.  The Office installation is managed via **Group Policy Objects (GPO)**.\n2.  It is strongly suspected, but not yet confirmed by user's IT, that **profile virtualization/redirection technology** (e.g., FSLogix, Citrix UPM, VMware DEM) might be in use, potentially redirecting registry writes intended for HKCU and causing them to appear missing in the standard registry view.\n3.  Attempting to manually create the `WEF\\Developer\\<Add-in ID>` keys and the `UseRuntimeLogging` value under `HKCU\\Software\\Microsoft\\Office\\16.0\\` was suggested as a potential workaround to enable logging, but the success of this is pending confirmation.\n\n## Context\nThe user is the **developer of the specific web add-in** deployed via Centralized Deployment. The primary impact of this issue is the **inability to enable runtime logging** for the add-in using the standard registry method. This significantly hinders debugging efforts for issues occurring within the add-in in this specific user environment.\n\n## Useful logs\n- [ ] Console errors (Not applicable for missing registry key)\n- [ ] Screenshots (Issue is absence of a key, easily described)\n- [ ] Test file (Not applicable)",
    "created_at": "2025-04-15T09:28:23Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "ttuyen1529",
    "comments": [
      {
        "author": "millerds",
        "body": "Did the manual workaround work?  If there is something else that is redirecting the registry interaction that the tool may not work right.",
        "created_at": "2025-04-25T23:52:43Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-11T23:27:58Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-15T02:41:05Z"
      }
    ]
  },
  {
    "number": 5611,
    "title": "_xldudf_ error appearing in front of custom functions",
    "body": "## Environment\n* Platform [PC desktop, Mac, iOS, Office on the web]: Office 365\n* Host [Excel, Word, PowerPoint, etc.]: Excel Online\n* Operating System: Windows 11\n* Browser (if using Office on the web): Reproducible in both Edge and Chrome\n \n## Expected behavior\nNo additional characters added to custom functions\n\n## Current behavior\nAfter using a custom function in Excel Online `_xldudf_` is prepended to each custom function which breaks our application's functionality. This is mainly visible after clearing the cache and reopening the workbook, but as our application allows users to upload workbooks from the add-in, we are seeing errors in converting the workbook for upload because of these characters before the workbook is even closed.\n\n![Image](https://github.com/user-attachments/assets/e5e32eac-db4f-4d01-b50b-463cfb9bae5c)\n\n\n## Steps to reproduce\nSteps to reproduce included in the README of the sample app repo I created. It can be accessed here:\nhttps://github.com/lisawilliamsISW/custom-function-xldudf_error\n\nIn this sample app, I created a basic task pane add-in using the Yeoman generator as recommended by [this doc](https://learn.microsoft.com/en-us/office/dev/add-ins/tutorials/excel-tutorial?tabs=jsonmanifest).\n\n## Context\nOur application allows users to upload reports that contain certain custom functions we have created. Because of this bug, our custom functions are no longer recognized because of the extra `_xldudf_` characters.\n\nIn this video, you can see that just using the custom function from the Yeoman generated code (as opposed to our application's custom functions), I am able to reproduce this error:\n\nhttps://github.com/user-attachments/assets/abc01137-337a-4854-be9f-ddafd62e3d62",
    "created_at": "2025-04-14T19:32:34Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Excel"
    ],
    "author": "lisawilliamsISW",
    "comments": [
      {
        "author": "lisawilliamsISW",
        "body": "I've found a few similar issues while researching this:\nhttps://github.com/OfficeDev/office-js/issues/2568\nhttps://github.com/OfficeDev/office-js/issues/2051\nhttps://github.com/OfficeDev/office-js/issues/4811#issuecomment-2445733612",
        "created_at": "2025-04-14T19:35:30Z"
      },
      {
        "author": "lisawilliamsISW",
        "body": "For what it's worth, I've also noticed that this does not happen if you:\nA) type a custom function into a cell in Excel Online _before_ loading the manifest.xml file. Instead the cell populates with `#NAME` but it does not alter the inner text\nB) create a workbook with custom functions in Excel Desktop and then upload to Excel Online.\n\nIdeally for our use case Excel Online would have the same behavior as the Excel Desktop.",
        "created_at": "2025-04-14T20:28:14Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi @lisawilliamsISW ,\n\nYour add-in doesn't loaded after you clear the cache. Your add-in doesn't show up in the ribbon after you clear the cache from your video. So the Excel can't recognize the user-defined-formula which make it show \"_xldudf_\". Please reload your add-in after you clear the cache if you still want the functionality of that add-in work. thanks.",
        "created_at": "2025-04-16T09:22:58Z"
      },
      {
        "author": "lisawilliamsISW",
        "body": "We are still trying to figure out how to handle this. We understand that we need to reload the manifest file. But what if you save the report and open in Excel Desktop. We are still seeing the error there.",
        "created_at": "2025-04-22T18:49:17Z"
      },
      {
        "author": "lisawilliamsISW",
        "body": "Following up here @penglongzhaochina @guoms1",
        "created_at": "2025-05-05T15:58:34Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Thanks for reporting this issue.  \n\nIt has been put on our backlog<Bug#10014385> for internal track. We will keep track of this issue and let you know if there are any updates. ",
        "created_at": "2025-05-06T06:40:33Z"
      },
      {
        "author": "lisawilliamsISW",
        "body": "@penglongzhaochina @guoms1 would it be possible to get a link to the bug ticket so we can track it on our end as well? Thanks.",
        "created_at": "2025-05-08T13:58:03Z"
      },
      {
        "author": "SiruiSun-MSFT",
        "body": "Hi @lisawilliamsISW, based on the scenario you mentioned, I'm afraid this may be a By-design behavior. As my colleague mentioned, the _xldudf_ error is due to the add-in cannot be loaded successfully. In your scenario, the add-in you use is a local add-in, which is loaded by upload manifest to Add-in Store. If you clear the web cache, the manifest you use will be deleted, and the add-in cannot by loaded until you upload it again. Thus, the _xldudf_ error will keep in your cell content. To verify this, you could use a Store add-in which contains custom function to test the same scenario after clearing web cache. The _xldudf_ will be mitigated quickly. Thanks!",
        "created_at": "2025-05-09T09:00:47Z"
      },
      {
        "author": "lisawilliamsISW",
        "body": "@SiruiSun-MSFT - thank you for the follow up. I understand the need for the manifest to be loaded to clear the error in the web browser. However consider the following:\n\nOur application started out as an Excel Desktop add-in with many custom functions. We are trying to use OfficeJS to create the same functionality of our desktop add-in, but online. However, due to this xldudf prefix, if a user creates a workbook with the online add-in and saves it, upon opening it in the Excel Desktop version, the custom function is not recognized.\n\nSo does that mean that it is a by-design behavior that custom function functionality in Online Add-ins is NOT compatible with Desktop Add-ins?\n\n![Image](https://github.com/user-attachments/assets/1c02ad2b-a041-4f4a-b9cb-c43476be54cc)\n\n![Image](https://github.com/user-attachments/assets/1c331769-5475-4b91-9e62-9188be539fee)",
        "created_at": "2025-05-09T14:27:05Z"
      },
      {
        "author": "SiruiSun-MSFT",
        "body": "Hi @lisawilliamsISW , thanks for your reply here! \nBased on your scenario, I do a validation through the below steps:\n_1. Install JS add-in and its related COM add-in into my account( The add-in I use here is from Store).\n2. Input a JS custom function in a cell on Excel Web.\n3. Save this file to desktop.\n4. Open this file on Excel desktop.\n5. Verify this JS function could be recognized into the COM one with the same function name._\nHowever, I couldn't repro the issue you mentioned. My result is \"this function could be recognized as the COM one without _xldudf_\".\nNot sure what is the difference between my steps and yours. Please feel free to remind me if I missed some steps or important information.",
        "created_at": "2025-05-12T07:00:18Z"
      },
      {
        "author": "lisawilliamsISW",
        "body": "@SiruiSun-MSFT I apologize for the delay. We are currently testing a dev only manifest and are hoping some of the behavior might go away once we publish the manifest to AppSource. ",
        "created_at": "2025-05-16T15:50:07Z"
      },
      {
        "author": "SiruiSun-MSFT",
        "body": "@lisawilliamsISW Thanks for your reply! The current behavior maybe a By-design one since the add-in you use here is a local-host dev one and the manifest is the important resource for identifying the add-in custom function. Will close this issue firstly. If you also encounter some issues after publishing to Store, please feel free to open a new issue. Thanks for your reporting again!",
        "created_at": "2025-05-19T03:15:23Z"
      }
    ]
  },
  {
    "number": 5605,
    "title": "How to Delete a Composing Email Attachment via Outlook Add-in?",
    "body": "The following details are provided for context:\n\nServer: Exchange Server 2019 on premise\n\nClient: OWA\n\nCategory: Outlook Add-in\n\nOffice JS API Set: Supported up to 1.5 only\n\nChallenge: How to delete a composing email attachment using an Outlook add-in?\n\nAny way to get access token and call DeleteAttachment EWS operation or\n\nConvert the EWS Attachment ID to Office js UUID?",
    "created_at": "2025-04-13T18:26:52Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "kapil603",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #5581\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\nIf you are trying to remove attachments not added by your add-in, otherwise `removeAttachmentAsync` should work in the same session. [removeAttachmentAsync](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/add-and-remove-attachments-to-an-item-in-a-compose-form#remove-an-attachment)\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5581#issuecomment-2796372493\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-04-13T18:27:18Z"
      },
      {
        "author": "whoanuragverma",
        "body": "You can follow [this documentation](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/get-attachments-of-an-outlook-item?tabs=exchange-on-prem) for on-prem, although the example uses GetAttachment call it can be modified to DeleteAttachments as well. ",
        "created_at": "2025-04-30T08:55:29Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-04T11:29:49Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-07T12:21:16Z"
      }
    ]
  },
  {
    "number": 5604,
    "title": "Add-in Signature Insertion broken on Outlook for Android",
    "body": "Our add-in (event-based) is unable to insert email signatures due to a change in the latest Outlook for Android release (Version 4.2511.0). Our add-in can be discussed in more detail per this previous request: https://github.com/OfficeDev/office-js/issues/5124.\n\n## Your Environment\n* Platform [PC desktop, Mac, iOS, Office on the web]: Android\n* Host [Excel, Word, PowerPoint, etc.]: Outlook Mobile\n* Office version number: 4.2511.0\n* Operating System: Android\n \n## Expected behavior\nSignature insertion would be automatic when composing a new email. Same functionality as Web Add-in on Outlook Online / New Outlook.\n\n## Current behavior\nNo signature is inserted, and the add-in cannot be loaded.\n\n## Steps to reproduce\nOccurs on the latest version of Outlook mobile for Android. Version 4.2422.0 was also tested (released in June 2024) and this previous version allowed the add-in to function as normal.\n\n",
    "created_at": "2025-04-11T19:42:36Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Possible-Solution"
    ],
    "author": "jasonhershaft",
    "comments": [
      {
        "author": "sanchitagarwal-msft",
        "body": "Thank you for reporting this issue. We are currently investigating and reproducing this in-house. Once we have an update, we will share it.",
        "created_at": "2025-04-17T06:26:37Z"
      },
      {
        "author": "sanchitagarwal-msft",
        "body": "Thank you for reaching out, we have taken the request.\nIt has been put on our backlog. We unfortunately have no timelines to share at this point\n\nInternal tracking id: Office: 5633733",
        "created_at": "2025-04-17T09:30:55Z"
      },
      {
        "author": "jasonhershaft",
        "body": "@sanchitagarwal-msft I'm not sure why this was marked as stale -- do you need anything further from me and my team to investigate the issue here?",
        "created_at": "2025-04-21T13:47:32Z"
      },
      {
        "author": "ykhanapure",
        "body": "@jasonhershaft Could you please update your Outlook Android app and check if the issue still persists? We're also working on debugging it, but since we don't have a consistent repro, it's taking a bit longer than expected. Also, could you confirm the name of the add-in you're using so we can ensure we're testing the right scenario?",
        "created_at": "2025-04-24T04:42:32Z"
      },
      {
        "author": "jasonhershaft",
        "body": "@ykhanapure I updated to Outlook Android version 4.2514.1 and the issue still persists. The add-in I'm using is Templafy.",
        "created_at": "2025-04-24T14:35:17Z"
      },
      {
        "author": "ykhanapure",
        "body": "Alright, thanks. Could you please share the logs? You can refer to this link: https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues",
        "created_at": "2025-04-25T03:07:42Z"
      },
      {
        "author": "jasonhershaft",
        "body": "@ykhanapure the Incident ID from the logs is UBGAJTJH",
        "created_at": "2025-04-25T16:02:16Z"
      },
      {
        "author": "ykhanapure",
        "body": "Hi @jasonhershaft, We’ve analyzed the logs and identified that the issue is caused by the inclusion of a trailing '/' in the appDomain. Please avoid adding any URL segments past the domain, including the full URL of a page, such as https://login.microsoftonline.com/. Additionally, please ensure that the appDomain value does not have a trailing slash ('/'), as this is causing the issue.\nFor reference, please refer the official documentation: https://learn.microsoft.com/en-us/javascript/api/manifest/appdomain?view=common-js-preview.",
        "created_at": "2025-04-28T07:05:50Z"
      },
      {
        "author": "jasonhershaft",
        "body": "Thanks @ykhanapure! I will verify and get back to you",
        "created_at": "2025-04-28T14:33:47Z"
      },
      {
        "author": "jasonhershaft",
        "body": "Hey @ykhanapure - we confirmed that the update solved the issue. Thanks for the help!",
        "created_at": "2025-05-08T14:14:03Z"
      },
      {
        "author": "ykhanapure",
        "body": "Thats' great to hear @jasonhershaft ",
        "created_at": "2025-05-09T03:51:39Z"
      }
    ]
  },
  {
    "number": 5602,
    "title": "NAA stopped working on Safari browser",
    "body": "# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Mac\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Office version number: OWA\n* Operating System: Mac OS\n* Browser (if using Office on the web): Safari\n \n## Expected behavior\nUser can authenticate to the Outlook Add-in using NAA in Safari browser.\n\n## Current behavior\nUser cannot use NAA in Safari browser.\nThe NAA flow fails on a fallback with the error \"Unhandled Promise Rejection: Error: Unable to acquire access token: ServerError: user_cancelled: User cancelled the flow.\"\n\n\n## Steps to reproduce\nThe easiest way is to use \"Send to OneNote\" add-in. Users cannot authenticate. It shows this error on UI:\nWe're having trouble signing you in. Please try again later. Details\nError: \"This Outlook account is not authorized. Try signing in again later.\"\nDate: 2025-04-11T16:14:07.879Z\nSession ID: 590c9a7e-138c-4b48-bf93-9f111f197048\n\nOr use the Add-in from MS examples.\n\n1. Use the code from NAA example (https://github.com/OfficeDev/Office-Add-in-samples/tree/main/Samples/auth/Outlook-Add-in-SSO-NAA)\n2. Register the application in AAD\n3. Accepts Graph scopes in your tenant\n4. Run dev server with the application and Sideload the Add-in.\n6. Open the Add-in in Safari browser and click \"Get user data\" in the Add-in\n7. Some MS dialog with a white screen will appear and console will show that token wasn't retrieved neither silently nor interactively and will fail with the error \"user_cancelled\" the flow which is not caught by the code.\n\n\n## Link to live example(s)\nhttps://github.com/OfficeDev/Office-Add-in-samples/tree/main/Samples/auth/Outlook-Add-in-SSO-NAA\n\n# Provide additional details\nNAA in Safari has been working but now it does not work for all add-ins that I tested: \"Send to OneNote\", \"Share to Teams\", and the Add-in which we own.\nBesides, I tried to catch this error and run a fallback (getTokenWithDialogApi function). This flow works but also show this strange dialog with a white screen. \n\nAlso, the fallback doesn't cache tokens in the storage described in \"cacheLocation\" in msalconfig file. So, every time the Add-in is closed, the user should authenticate again which gives a bad UX and our users cannot use the Add-in in Safari.\n\nWe tried to update msal-browser to the latest but the issue persists.\n\n\n## Context\nOur customers cannot use the Add-in in Safari browser.\n\n## Useful logs\n[Log] Trying to acquire token silently... (taskpane.js, line 272)\n[Info] Successfully preconnected to https://login.microsoftonline.com/\n[Warning] Unable to acquire token silently: InteractionRequiredAuthError: login_required: AADSTS50058: A silent sign-in request was sent but no user is signed in. The cookies used to represent the user's session were not sent in the request to Azure AD. This can happen if the user is using Internet Explorer or Edge, and the web app sending the silent sign-in request is in different IE security zone than the Azure AD endpoint (login.microsoftonline.com). Trace ID: d84ee838-65eb-44cb-ba0a-3132b9973300 Correlation ID: 0196259e-3ac7-774c-942c-04a4818dbc80 Timestamp: 2025-04-11 16:10:50Z (taskpane.js, line 277)\n[Log] Trying to acquire token interactively... (taskpane.js, line 282)\n[Info] Successfully preconnected to https://login.microsoftonline.com/\n[Error] Unable to acquire token interactively: ServerError: user_cancelled: User cancelled the flow.\n\t(anonymous function) (taskpane.js:300)\n[Error] Unhandled Promise Rejection: Error: Unable to acquire access token: ServerError: user_cancelled: User cancelled the flow.\n\t(anonymous function) (taskpane.js:591)\n",
    "created_at": "2025-04-11T16:17:22Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Status: fixed",
      "Platform: Online"
    ],
    "author": "max-yushchuk",
    "comments": [
      {
        "author": "mmcalynnproof",
        "body": "@max-yushchuk Safari Settings -> Privacy -> \"Turn off Prevent cross-site tracking\" fixed the error when acquiring token silently for me.",
        "created_at": "2025-04-14T14:03:48Z"
      },
      {
        "author": "max-yushchuk",
        "body": "@mmcalynnproof Thanks. I know this workaround but it's not applicable for us. The problem is for the users who use our Add-in. We cannot ask everyone to disable this. This is not secure and it's annoying for them. Besides, I've tested NAA in Safari a month or two ago and it has been working well without any issues. It wasn't able to get it silently but was able to get it interactively without prompting a user to enter credentials (just popup appeared and disappeared immediately automatically). But now NAA does not work neither interactively nor using a fallback (OfficeJS Dialog). So, no way to use NAA in Safari browser in a normal way.",
        "created_at": "2025-04-14T15:04:43Z"
      },
      {
        "author": "salaman",
        "body": "Thanks for the detailed report. We're gradually rolling out a fix for this. I'll update here when it has fully rolled out.",
        "created_at": "2025-04-23T00:38:51Z"
      },
      {
        "author": "salaman",
        "body": "The popup issue should be resolved now; can someone who was affected let me know if the experience has improved?",
        "created_at": "2025-04-26T00:44:45Z"
      },
      {
        "author": "ottD",
        "body": "Thanks for the quick turnaround! Works for both Outlook add-in and Teams add-in with NAA in Safari  👍 ",
        "created_at": "2025-04-27T23:19:57Z"
      },
      {
        "author": "salaman",
        "body": "Based on the confirmations in https://github.com/AzureAD/microsoft-authentication-library-for-js/issues/7692, marking this as resolved.",
        "created_at": "2025-04-27T23:28:25Z"
      },
      {
        "author": "myushchuk",
        "body": "Thanks. Yes, it works now in Safari",
        "created_at": "2025-04-28T08:07:38Z"
      }
    ]
  },
  {
    "number": 5598,
    "title": "Need to view apps in delegates calender",
    "body": "Delegates typically cannot directly interact with or install apps that are specific to the calendar owner's account How to get access to view the apps in Delegates calendar",
    "created_at": "2025-04-11T04:58:12Z",
    "state": "closed",
    "labels": [
      "Needs: author feedback",
      "Needs: triage :mag:",
      "Status: no recent activity"
    ],
    "author": "ReddyBhargavi18",
    "comments": [
      {
        "author": "EsterBergen",
        "body": "@ReddyBhargavi18 - Can you share more details on the issue to help us triage? What host and platform are you experiencing this issue? Thanks!",
        "created_at": "2025-05-19T16:55:50Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-24T00:27:28Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-27T03:28:06Z"
      }
    ]
  },
  {
    "number": 5596,
    "title": "How to inspect elements inside Outlook JS Addin in Mobile devices?",
    "body": "We have an Outlook Js Addin supported on multiple platforms. For which are working on UI automation testing using Appium. We are trying to inspect elements inside Outlook Js addin web view using Appium Inspector and Safari inspector, But we are not able to inspect elements inside Outlook JS addin window on IPad and IOS device.\nFor same addin we can inspect elements on Windows and Mac Outlook desktop application. We are not getting how to inspect elements for Outlook Js Addin on mobile devices like iPad and iOS.\n\nWe enabled below settings on iPad \nDeveloper Mode \nSettings -> Developer -> Enable UI Automation\nSettings -> Safari -> Advanced -> Web Inspector\nSettings -> Safari -> Advanced -> Remote Automation.\n\n* Platform :IOS, IPad\n* Host :Outlook\n* Office version number:16.95\n*  Operating System:IOS\n* Browser (if using Office on the web): 15.3.2 (24D81)\n \n## Expected behavior\n\n1. Using safari inspector, We should get Outlook Webview in Safari->Develop->Device Name-> Microsoft Outlook\nUsing Appium inspector We should be able to inspect elements inside Addin Webview. Please find the attachment.\n\n## Current behavior\n1. We are seeing `No inspectable applications` \n\n![Image](https://github.com/user-attachments/assets/351f49a6-eaa2-43f4-809e-c222570297e6)\n![Image](https://github.com/user-attachments/assets/d5fe37e6-2e25-4be4-8524-99b23b07e6fc)",
    "created_at": "2025-04-10T12:31:34Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: in backlog",
      "Status: no recent activity"
    ],
    "author": "Amulyakr",
    "comments": [
      {
        "author": "mmanjaree-msft",
        "body": "@Amulyakr Thanks for bringing this up. This is included in our product roadmap for mobile but isn't prioritized due to the prioritization of other features. Internal tracking ID: 5629017",
        "created_at": "2025-04-11T06:40:13Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-15T09:29:02Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-18T12:13:33Z"
      }
    ]
  },
  {
    "number": 5585,
    "title": "In Outlook for Mac, AttachmentsChanged event doesn't fire if attachment was removed",
    "body": "In Outlook for Mac, `AttachmentsChanged` event doesn't fire consistently if attachment was removed\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Mac\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Office version number: Microsoft® Outlook for Mac Version 16.95.3 (25032931)\n* Operating System: MacOS\n* Browser (if using Office on the web): -\n \n## Expected behavior\nThe `AttachmentsChanged` event should fire consistently in case if attachment was removed from the email.\n\n## Current behavior\nThe `AttachmentsChanged` event doesn't fire consistently if the attachment was removed\n\n## Steps to reproduce\n1. Open the taskpane add-in that listens to `AttachmentsChanged` event\n2. Remove an attachment from the email\n3. Check the `AttachmentsChanged` event handler\n\n# Provide additional details\n- The issue is only present for the Outlook on Mac\n- If the attachment was added, the event fires as expected, so the issue seem to be relevant only if attachment is removed\n- Sometimes the event fires as expected\n\n",
    "created_at": "2025-04-09T09:14:31Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Resolution: duplicate"
    ],
    "author": "Suntechnick",
    "comments": [
      {
        "author": "Suntechnick",
        "body": "We noticed that sometimes the attachment that was removed is reported with wrong id in the `AttachmentChanged` event payload:\n\n![Image](https://github.com/user-attachments/assets/ae3d1fbe-af51-4d67-9e10-07a6b964c9c6)",
        "created_at": "2025-04-10T15:05:02Z"
      },
      {
        "author": "mmanjaree-msft",
        "body": "@Suntechnick Can you share a repro video and the sample js code handling the launch event. Make sure you call event.completed() for every launch event used",
        "created_at": "2025-04-11T08:55:53Z"
      },
      {
        "author": "Suntechnick",
        "body": "I'm not able to share a repro video or code sample due to the NDA.\nWe don't use an event-based activation, so I'm not sure what you mean by event.completed() in our case.\nIn short, in our taskpane we have a code that looks similar to this:\n```\nOffice.onReady(() => {\n  Office.context.mailbox.item.addHandlerAsync(Office.EventType.AttachmentsChanged, (args) => {\n    console.log(\"CHANGED:\", args);\n  });\n});\n```",
        "created_at": "2025-04-11T09:24:30Z"
      },
      {
        "author": "Suntechnick",
        "body": "We've gathered more details regarding this issue.\nIt seems that attachment id is not consistent in certain cases.\nSo far, the easiest way to reproduce this on macOS with the following sequence:\n1. Set the `AttachmentsChanged` handler similarly to how it is mentioned above.\n2. Add a couple attachments (check the added attachment ids)\n3. Call the `Office.context.mailbox.item.getAttachmentsAsync(console.log);` to get attachments list. Notice that in that case some ids might be different to the ones from the `AttachmentsChanges` handler call.\n\nThat's how it looks for us (notice that the id for the `modified.doc` is different):\n![Image](https://github.com/user-attachments/assets/ab3a0c6c-f5dc-4117-9e9d-8b0799569df8)",
        "created_at": "2025-04-14T09:17:03Z"
      },
      {
        "author": "neprasad-microsoft",
        "body": "Hi @Suntechnick \nThere are 2 issues you have reported here - \n1. The attachment changed handler for attachment deletion is not fired \n2. The IDS of attachments are changing. \n\nAre these 2 related or different issues?\nFor 2, we have another GH post -https://o365exchange.visualstudio.com/DefaultCollection/O365%20Core/_workitems/edit/5557854 and we are tracking it there. \n\nFor 1, I tried this multiple times with many attachments but was not able to repro. Is there any special file type/file size/number of files or some steps after which you can repro this?\nPlease reproduce the issue and collect logs and share the diagnostic ID with us using the steps mentioned here -https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues\n",
        "created_at": "2025-04-17T14:39:48Z"
      },
      {
        "author": "Suntechnick",
        "body": "> Hi [@Suntechnick](https://github.com/Suntechnick) There are 2 issues you have reported here -\n> \n> 1. The attachment changed handler for attachment deletion is not fired\n> 2. The IDS of attachments are changing.\n> \n> Are these 2 related or different issues? For 2, we have another GH post -https://github.com/OfficeDev/office-js/issues/5509  and we are tracking it there.\n> \n> For 1, I tried this multiple times with many attachments but was not able to repro. Is there any special file type/file size/number of files or some steps after which you can repro this? Please reproduce the issue and collect logs and share the diagnostic ID with us using the steps mentioned here -https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues\n\nI'm not able to access the GH post link due to some tenant issue, unfortunately.\n\nAs for 1, I think my initial debugging was not proper, so it appeared to me that the event was not firing, while in reality the issue was related to inconsistent attachment ids. I apologize for the confusion.",
        "created_at": "2025-04-18T07:15:39Z"
      },
      {
        "author": "neprasad-microsoft",
        "body": "Thanks for confirming @Suntechnick . We already have an issue tracking this bug at https://github.com/OfficeDev/office-js/issues/5509 . I am resolving this as duplicate. Please track further updates on the other issue.\nApologies for the incorrect link earlier. I have updated it in the above posts also.",
        "created_at": "2025-04-18T07:20:44Z"
      }
    ]
  },
  {
    "number": 5583,
    "title": "Removed attachment event fires with improper attachment id in the payload",
    "body": "In the Outlook Classic, while in the read mode, removed attachment event fires with improper attachment id in the payload\n\n## Your Environment\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC desktop\n* Host [Excel, Word, PowerPoint, etc.]: Outlook Classic\n* Office version number: Microsoft® Outlook® for Microsoft 365 MSO (Version 2503 Build 16.0.18623.20116) 64-bit\n* Operating System: Windows\n* Browser (if using Office on the web): -\n \n## Expected behavior\nRemoved attachment event should fire with proper attachment id\n\n## Current behavior\nRemoved attachment event fires with improper attachment id\n\n## Steps to reproduce\n1. In the read mode, open an email containing at least one attachment\n2. Open the taskpane addin that is subscribed to the `Office.EventType.AttachmentsChanged` event\n3. Remove the attachment from the email\n4. Check the `AttachmentsChanged` event data\n\n\n# Provide additional details\nOn the screenshot, the first log shows the list of attachments BEFORE one of the was removed. The second log show the payload of the `AttachmentsChanged` event. As you can see, the id in the event payload is `0`, which is incorrect (as you can see from the first log).\n![Image](https://github.com/user-attachments/assets/c72d5195-9cac-4ff5-962f-a48c58abde1b)",
    "created_at": "2025-04-08T14:15:51Z",
    "state": "closed",
    "labels": [
      "Area: Outlook"
    ],
    "author": "Suntechnick",
    "comments": [
      {
        "author": "kwame-ansong",
        "body": "Thanks for reporting this issue regarding the AttachmentsChangedEvent.\nThis event is only expected to work in compose mode.\nWe have placed in our backlog. We unfortunately have no timelines to share at this point.\n\nInternal tracking id: Office: 10004104",
        "created_at": "2025-04-30T10:39:14Z"
      }
    ]
  },
  {
    "number": 5581,
    "title": "How to get token to fire ews soap request using fetch in exchange onprem setup?",
    "body": "I am currently developing an Outlook add-in for an Exchange On-Premises environment and have encountered a limitation with attachment management, specifically around deleting attachments.\n\n> **Context:**\n\n1. Environment: Exchange On-Premises (On-Prem)\n\n1. Target: Outlook Web App (OWA)\n\n1. Office.js Version Supported: <= 1.5 (limited feature set)\n\n\n\n> **Problem Details:**\n\n1. Limitation of makeEWSRequestAsync:\n\nThe makeEWSRequestAsync method in Office.js does not support the DeleteAttachment SOAP operation, which is required for my scenario.\n\n1. Attempted Workaround - Using fetch with EWS SOAP Request:\n\nI tried invoking the DeleteAttachment operation manually via a fetch call to the EWS endpoint. However, this requires a valid authentication token.\n\nThe challenge is: I am unable to retrieve a valid token from Office.js in the Exchange On-Premises setup.\nMethods like Office.context.mailbox.getCallbackTokenAsync do not seem to provide usable tokens for this purpose.\n\n1. OWA Limitation:\n\nAs OWA in this environment only supports Office.js up to version 1.5, the modern attachment APIs and Graph APIs are not an option.\n\n\n> **Question:**\n\n1. In an Exchange On-Premises scenario, how can I programmatically delete attachments via my add-in?\n\n1. Specifically, is there a recommended approach to obtain a valid token for EWS requests, or any supported alternative to perform DeleteAttachment?\n\n1. If direct deletion is not supported in this environment, are there known workarounds or roadmap plans for better attachment handling in on-premises setups?\n\n> **Additional Notes:**\n\nI am aware that Exchange Online supports more modern APIs (Graph/REST), but my current deployment is strictly Exchange On-Premises.\n\nThe add-in works well for reading attachments and other operations, except for deletion.\n\nAny guidance or recommendations would be highly appreciated!\n\nThank you in advance.",
    "created_at": "2025-04-08T12:59:09Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Resolution: question answered"
    ],
    "author": "backupsdkjjdie",
    "comments": [
      {
        "author": "mmanjaree-msft",
        "body": "@backupsdkjjdie are you trying to remove attachments not added by your addin? Otherwise removeAttachmentAsync should work in same session [removeAttachmentAsync](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/add-and-remove-attachments-to-an-item-in-a-compose-form#remove-an-attachment)",
        "created_at": "2025-04-11T09:36:57Z"
      },
      {
        "author": "backupsdkjjdie",
        "body": "@mmanjaree-msft \n\n Yes, I’m trying to remove attachments that were either:\n\n- Added manually via the Outlook \"Attach\" option, or\n\n- Programmatically added using the EWS API.\n\nWhen I use `removeAttachmentAsync`, I get the following error:\n\"Error removing attachment: The attachment cannot be deleted because attachment with the attachment index cannot be found.\"\nThis seems to indicate that `removeAttachmentAsync` is limited to only those attachments added by the same add-in during the current session.\n\nSince `removeAttachmentAsync` isn't working for these types of attachments, I looked into removing them using the EWS API. However, I ran into another limitation — the `DeleteAttachment` operation isn’t supported via `makeEWSRequestAsync`, which blocks that approach too. \n\nMy last resort is to use a direct fetch call from the browser to make the EWS request manually. However, that requires a valid auth token, and I’m currently unable to obtain a token that authorizes the EWS operation from the add-in context.\n\nIf there’s any workaround you know of, I’d really appreciate the help!",
        "created_at": "2025-04-11T10:00:01Z"
      },
      {
        "author": "mmanjaree-msft",
        "body": "@backupsdkjjdie Can you share the fetch call you are trying to make ?",
        "created_at": "2025-04-11T10:08:24Z"
      },
      {
        "author": "backupsdkjjdie",
        "body": "@mmanjaree-msft \n\n```ts\nasync function deleteEWSAttachment(attachmentId) {\n  const url = 'https://exchange.nd.com/EWS/Exchange.asmx'; // My EWS URL\n  // const credentials = btoa(\"user2@nd.com:Vivek@10\"); // Credentials \n\n  const token = await getEwsToken();\n  console.log(\"Got token:\", token);\n\n  const soapRequest = `\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\n               xmlns:t=\"http://schemas.microsoft.com/exchange/services/2006/types\"\n               xmlns:m=\"http://schemas.microsoft.com/exchange/services/2006/messages\">\n  <soap:Header>\n    <t:RequestServerVersion Version=\"Exchange2013\"/>\n  </soap:Header>\n  <soap:Body>\n    <m:DeleteAttachment>\n      <m:AttachmentIds>\n        <t:AttachmentId Id=\"${attachmentId}\"/>\n      </m:AttachmentIds>\n    </m:DeleteAttachment>\n  </soap:Body>\n</soap:Envelope>`;\n\n  try {\n    const response = await fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"text/xml;charset=UTF-8\",\n        \"SOAPAction\": \"http://schemas.microsoft.com/exchange/services/2006/messages/DeleteAttachment\",\n        \"Authorization\": `Bearer ${token}`\n      },\n      credentials: \"include\",\n      mode: \"cors\",\n      body: soapRequest,\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP error! Status: ${response.status}`);\n    }\n\n    const text = await response.text();\n    console.log(\"DeleteAttachment Response:\", text);\n  } catch (error) {\n    console.error('Error sending DeleteAttachment request:', error);\n    throw error;\n  }\n} \n```\nThis is the function I am using and for getEwsToken, I tried using `Office.context.mailbox.getCallbackTokenAsync` and `Office.context.mailbox.getUserIdentityTokenAsync` but it my ews call of deleteAttachment is giving me 401 or 500 error.",
        "created_at": "2025-04-11T10:39:44Z"
      },
      {
        "author": "backupsdkjjdie",
        "body": "@mmanjaree-msft \nAny update?",
        "created_at": "2025-04-16T11:07:33Z"
      },
      {
        "author": "whoanuragverma",
        "body": "The getCallbackTokenAsync method makes an asynchronous call to get an opaque token from the Exchange Server that hosts the user's mailbox. This token is not a standard OAuth bearer token and cannot be used directly in HTTP Authorization headers for fetch requests to EWS endpoints. \n\nYou can follow [this doc](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/get-attachments-of-an-outlook-item?tabs=exchange-on-prem) to proxy the EWS call to a backend server that makes the EWS request by converting the opaque token to an OAuth token. \n\nYou can also use [makeEWSRequestAsync](https://learn.microsoft.com/en-us/javascript/api/outlook/office.mailbox?view=outlook-js-preview&preserve-view=true#outlook-office-mailbox-makeewsrequestasync-member(1)) to directly make the call to EWS from office js. ",
        "created_at": "2025-04-30T05:55:43Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-04T08:14:49Z"
      }
    ]
  },
  {
    "number": 5580,
    "title": "Outlook Add-In does not receive any signal or event when switching from Read mode to Compose mode",
    "body": "## Description\n\nIn my Outlook Add-in, I need to detect when the user transitions from **Read mode** to **Compose mode** (e.g., when clicking \"Reply\", \"Reply All\", or \"Forward\").\n\nCurrently, there's **no event or callback in Office.js** that notifies the add-in about this transition. This makes it impossible to trigger logic that should only run **once composing starts**.\n\n## Expected Behavior\n\nWhen the user clicks “Reply” or any action that switches to Compose mode, the add-in should receive a signal (event or context change), or at least have a reliable way to detect that the mode changed.\n\n## Current Behavior\n\nNo event is fired. The item context changes silently, and unless the add-in is reloaded, there's no programmatic way to detect that the mode switched from read to compose.\n\n## Why this is problematic\n\n- Add-ins that need to adjust UI or logic when composing starts (e.g., templates, classification, logging, AI, etc.) are blind to this change.\n- This affects reliability and UX.\n- Compose mode can be manually detected **if already active**, but not **when it starts**.\n\n## Steps to Reproduce\n\n1. Open any email in Outlook (Read mode)\n2. Load the add-in (e.g., in the reading pane)\n3. Click \"Reply\"\n4. The add-in stays unaware that it’s now in Compose mode\n\n## Environment\n\n- Outlook Desktop / Web\n- Office.js API Version: latest\n- Platform: Windows / Web (Edge)\n- Add-in: Task pane Add-in\n\n## Suggested Fix\n\nExpose an event such as:\n```js\nOffice.context.mailbox.addHandlerAsync(\"onComposeStart\", callback);",
    "created_at": "2025-04-08T11:26:43Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "sirrganggi",
    "comments": [
      {
        "author": "mmanjaree-msft",
        "body": "@sirrganggi We do have onMessageCompose and onNewMessage events https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/autolaunch#supported-events which are fired when we land into a mail compose surface.\n\nPlease let us know more in case there's an issue\n",
        "created_at": "2025-04-10T06:49:55Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-14T06:51:47Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-17T09:31:43Z"
      }
    ]
  },
  {
    "number": 5578,
    "title": "Get HTML from selection in Shapes will cancel the selection",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: MacOS\n* Host [Excel, Word, PowerPoint, etc.]: Word\n* Office version number: Version 16.95.1 (25031528)\n* Operating System: 15.3.2 (24D81)\n* Browser (if using Office on the web): ______\n \nWhen using `getSelectedDataAsync` to get HTML in a Shape:\n```typescript\n    Office.context.document.getSelectedDataAsync(\n      Office.CoercionType.Html,\n      async (result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          const html = result.value as string;\n         ...\n        }\n      },\n    );\n```\nIt will cancel the current selection range. The issue does not occur with selections outside of a shape or when a CoercionType other than HTML is used.\n",
    "created_at": "2025-04-08T07:28:19Z",
    "state": "closed",
    "labels": [
      "Needs: author feedback",
      "Area: Word",
      "Status: no recent activity"
    ],
    "author": "ChenNima",
    "comments": [
      {
        "author": "penglongzhaochina",
        "body": "Hi @ChenNima \n\nCould you please provide a full snippet can reproduce your issue?\n\nThanks.",
        "created_at": "2025-04-08T08:06:44Z"
      },
      {
        "author": "ChenNima",
        "body": "Hi\n\nI attempted to write a custom React hook to synchronize selected HTML string with the Redux Store every second. Despite replacing all Redux-related code with console.log statements, the problem persisted.\n\n```ts\nconst handleSelectionChange = async () => {\n      const store = getStore();\n      Office.context.document.getSelectedDataAsync(\n      Office.CoercionType.Html,\n      async (result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          store.dispatch(common.actions.setSelectedHtml(result.value as string));\n        }\n      },\n    );\n};\n\nexport const useSyncSelectedData = () => {\n  useEffect(() => {\n    const interval = setInterval(handleSelectionChange, 1000);\n\n    // Clean up the event listener on component unmount\n    return () => {\n      clearInterval(interval);\n    };\n  }, []);\n};\n```\n\n> Hi [@ChenNima](https://github.com/ChenNima)\n> \n> Could you please provide a full snippet can reproduce your issue?\n> \n> Thanks.\n\n",
        "created_at": "2025-04-08T08:58:58Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi @ChenNima ,\n\nI created a shape in the document and selected that shape, and then run your script. The selection still exists.\n\n![Image](https://github.com/user-attachments/assets/9384c5ee-784c-424c-8514-f5a8419e5f50)",
        "created_at": "2025-04-09T06:54:45Z"
      },
      {
        "author": "ChenNima",
        "body": "> Hi [@ChenNima](https://github.com/ChenNima) ,\n> \n> I created a shape in the document and selected that shape, and then run your script. The selection still exists.\n> \n> ![Image](https://github.com/user-attachments/assets/9384c5ee-784c-424c-8514-f5a8419e5f50)\n\nHi, Please refer to the vedio: I tried CoercionType.Text and then CoercionType.Html. For text, it works will. But for Html, it \"looks like\" the selection is lost but in fact it's still there and it confused my user.\n\nhttps://github.com/user-attachments/assets/14e5c810-805f-4b72-a557-a4117a5155e0\n\nThe code snippet is quite simple:\n```ts\nOffice.context.document.getSelectedDataAsync(\n      Office.CoercionType.Text,\n      async (result) => {\n        console.log(result)\n      },\n    )\n```\n\nI can 100% reproduce this issue with the file:\n\n[Doc1.docx](https://github.com/user-attachments/files/19668321/Doc1.docx)",
        "created_at": "2025-04-09T14:05:12Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "HI @ChenNima ,\n\nI tried it by using your way. Looks like the selection still exist there.\n\n![Image](https://github.com/user-attachments/assets/b6ff866c-d6af-4a83-b36a-893d355a04d5)",
        "created_at": "2025-04-10T05:37:46Z"
      },
      {
        "author": "ChenNima",
        "body": "> HI [@ChenNima](https://github.com/ChenNima) ,\n> \n> I tried it by using your way. Looks like the selection still exist there.\n> \n> ![Image](https://github.com/user-attachments/assets/b6ff866c-d6af-4a83-b36a-893d355a04d5)\n\nStrange, it appears your code isn't working correctly, as the `console.log` isn't outputting anything. Maybe try to remove the setTimeout?\n\n<img width=\"769\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/b48d51a2-0957-455c-8ed4-c71945d499a6\" />\n\n\nAs you can see here, I have the selection logged in my console",
        "created_at": "2025-04-11T01:43:08Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "looks like no change:\n\n![Image](https://github.com/user-attachments/assets/4265bb1f-3c89-46fd-aa82-a87d3129a070)",
        "created_at": "2025-04-11T06:34:55Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-21T02:12:40Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-24T02:38:05Z"
      }
    ]
  },
  {
    "number": 5576,
    "title": "Webaddin - Getting auth token returns 13007 error",
    "body": "**Issue Description:**\nWe were using _Office.context.mailbox.getCallbackTokenAsync_ function to get token. Since  its being deprecated, we are trying to use a new function _Office.context.auth.getAccessTokenAsync_ I have mentioned the used code below. Can you help me on this?\n\n**_Old(deprecated) Code:_**\n```\nOffice.context.mailbox.getCallbackTokenAsync(function(result){\n    console.log(result);\n});\n```\n_Screenshot:_\n![Image](https://github.com/user-attachments/assets/1468dc07-139e-47f8-9c32-bd0da0185a30)\n\n**_New Code:_**\n```\nOffice.context.auth.getAccessTokenAsync({ allowSignInPrompt: true }, function(result) {\n\tconsole.log(result);\n});\n```\n_Screenshot:_\n![Image](https://github.com/user-attachments/assets/2f90dd14-d58a-46c3-8663-e72771432da4)\n\nWe have added the below setting in our manifest file at the end of `<VersionOverrides xmlns=\"http://schemas.microsoft.com/office/mailappversionoverrides/1.1\" xsi:type=\"VersionOverridesV1_1\">`\n\n**Manifest file:**\n```\n<WebApplicationInfo>\n\t<Id>68de47d7-3cf1-48d0-969b-e8e9c3407394</Id>\n\t<Resource>api://localhost/68de47d7-3cf1-48d0-969b-e8e9c3407394</Resource>\n\t<Scopes>\n\t\t<Scope>user.read</Scope>\n\t\t<Scope>files.read</Scope>\n\t\t<Scope>profile</Scope>\n\t</Scopes>\n</WebApplicationInfo>\n```\n\nSettings which has been added as mentioned in _https://learn.microsoft.com/en-us/office/dev/add-ins/develop/troubleshoot-sso-in-office-add-ins_\n**Settings followed:**\n![Image](https://github.com/user-attachments/assets/b6475510-afdc-4f11-93ad-29e1ec0a9cd2)\n\nAfter adding this setting also 13007 error code is being received.\n\n**_Platform:_** Outlook Classic, Web, New outlook\n",
    "created_at": "2025-04-08T06:52:53Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "aberamdatazoic",
    "comments": [
      {
        "author": "mmanjaree-msft",
        "body": "@aberamdatazoic Are other addin apis working fine in your addin? Can you provide a sample manifest?",
        "created_at": "2025-04-08T09:59:21Z"
      },
      {
        "author": "aberamdatazoic",
        "body": "Hi @mmanjaree-msft \n\nYes other webaddin functions are working. Here is the sample codes.\n\n**Manifest File:**\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<OfficeApp \n          xmlns=\"http://schemas.microsoft.com/office/appforoffice/1.1\" \n          xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \n          xmlns:bt=\"http://schemas.microsoft.com/office/officeappbasictypes/1.0\" \n          xmlns:mailappor=\"http://schemas.microsoft.com/office/mailappversionoverrides\" \n          xsi:type=\"MailApp\">\n\n  <Id>d9d81f5a-e002-4475-88bc-cc51e3c97816</Id>\n  <Version>1.0.0.12</Version>\n  <ProviderName>Datazoic</ProviderName>\n  <DefaultLocale>en-US</DefaultLocale>\n  <DisplayName DefaultValue=\"DZ\" />\n  <Description DefaultValue=\"Bring your CRM inside your mailbox. Send personalized, templated, trackable email blasts from within Outlook with advanced engagement analytics.\"/>\n  <IconUrl DefaultValue=\"https://localhost/PrismIcon96.png?1=1\"/>\n  <HighResolutionIconUrl DefaultValue=\"https://localhost/PrismIcon96.png?1=1\" />\n\n  <Hosts>\n    <Host Name=\"Mailbox\" />\n  </Hosts>\n  <Requirements>\n    <Sets>\n      <Set Name=\"Mailbox\" MinVersion=\"1.3\" />\n    </Sets>\n  </Requirements>\n  <FormSettings>\n    <Form xsi:type=\"ItemRead\">\n      <DesktopSettings>\n        <SourceLocation DefaultValue=\"https://localhost/launchEvnt.html\"/>\n        <RequestedHeight>250</RequestedHeight>\n      </DesktopSettings>\n    </Form>\n    <Form xsi:type=\"ItemEdit\">\n      <DesktopSettings>\n        <SourceLocation DefaultValue=\"https://localhost/launchEvnt.html\"/>\n      </DesktopSettings>\n    </Form>\n  </FormSettings>\n  \n\n  <Permissions>ReadWriteMailbox</Permissions>\n  <Rule xsi:type=\"RuleCollection\" Mode=\"Or\">\n    <Rule xsi:type=\"ItemIs\" ItemType=\"Message\" FormType=\"Read\" />\n  </Rule>\n  <DisableEntityHighlighting>false</DisableEntityHighlighting>\n\n  <VersionOverrides xmlns=\"http://schemas.microsoft.com/office/mailappversionoverrides\" xsi:type=\"VersionOverridesV1_0\">\n    <Requirements>\n      <bt:Sets DefaultMinVersion=\"1.3\">\n        <bt:Set Name=\"Mailbox\" />\n      </bt:Sets>\n    </Requirements>\n    <Hosts>\n      <Host xsi:type=\"MailHost\">\n\n        <DesktopFormFactor>\n          <FunctionFile resid=\"functionFile\" />\n\t\t\t<ExtensionPoint xsi:type=\"MessageReadCommandSurface\">\n            <OfficeTab id=\"TabDefault\">\n              <Group id=\"msgReadGroup\">\n                <Label resid=\"groupLabel\" />\n                <Control xsi:type=\"Button\" id=\"msgReadOpenPaneButton\">\n                  <Label resid=\"paneReadButtonLabel\" />\n                  <Supertip>\n                    <Title resid=\"paneReadSuperTipTitle\" />\n                    <Description resid=\"paneReadSuperTipDescription\" />\n                  </Supertip>\n                  <Icon>\n                    <bt:Image size=\"16\" resid=\"icon16\" />\n                    <bt:Image size=\"32\" resid=\"icon32\" />\n                    <bt:Image size=\"80\" resid=\"icon80\" />\n                  </Icon>\n                  <Action xsi:type=\"ShowTaskpane\">\n\t\t\t\t\t<SourceLocation resid=\"messageReadTaskPaneUrl\" />\n                  </Action>\n                </Control>\n              </Group>\n            </OfficeTab>\n          </ExtensionPoint>\n\t\t</DesktopFormFactor>\n      </Host>\n    </Hosts>\n\n    <Resources>\n      <bt:Images>\n        <bt:Image id=\"icon16\" DefaultValue=\"https://localhost/PrismIcon16.png?1=1\"/>\n\t\t<bt:Image id=\"icon25\" DefaultValue=\"https://localhost/PrismIcon25.png?1=1\"/>\n        <bt:Image id=\"icon32\" DefaultValue=\"https://localhost/PrismIcon32.png?1=1\"/>\n        <bt:Image id=\"icon48\" DefaultValue=\"https://localhost/PrismIcon48.png?1=1\"/>\n        <bt:Image id=\"icon80\" DefaultValue=\"https://localhost/PrismIcon80.png?1=1\"/>\n        <bt:Image id=\"icon96\" DefaultValue=\"https://localhost/PrismIcon96.png?1=1\"/>\n      </bt:Images>\n      <bt:Urls>\n        <bt:Url id=\"functionFile\" DefaultValue=\"https://localhost/launchEvnt.html\"/>\n        <bt:Url id=\"messageReadTaskPaneUrl\" DefaultValue=\"https://localhost/launchEvnt.html\"/>\n      </bt:Urls>\n      <bt:ShortStrings>\n        <bt:String id=\"groupLabel\" DefaultValue=\"DZ\"/>\n        <bt:String id=\"customTabLabel\"  DefaultValue=\"DZ\"/>\n        <bt:String id=\"paneReadButtonLabel\" DefaultValue=\"DZ View\"/>\n        <bt:String id=\"paneReadSuperTipTitle\" DefaultValue=\"DZ View\"/>\n      </bt:ShortStrings>\n      <bt:LongStrings>\n        <bt:String id=\"paneReadSuperTipDescription\" DefaultValue=\"Opens the Side pane, the window to your Page.\"/>\n      </bt:LongStrings>\n    </Resources>\n    <VersionOverrides xmlns=\"http://schemas.microsoft.com/office/mailappversionoverrides/1.1\" xsi:type=\"VersionOverridesV1_1\">\n      <Requirements>\n        <bt:Sets DefaultMinVersion=\"1.13\">\n          <bt:Set Name=\"Mailbox\" />\n        </bt:Sets>\n      </Requirements>\n      <Hosts>\n        <Host xsi:type=\"MailHost\">\n\t\t\n\t\t<Runtimes>\n          <Runtime resid=\"functionFile\">\n            <Override type=\"javascript\" resid=\"JSRuntime.Url\"/>\n          </Runtime>\n        </Runtimes>\n          <DesktopFormFactor>\n            <FunctionFile resid=\"functionFile\" />\n           \n          <ExtensionPoint xsi:type=\"MessageReadCommandSurface\">\n            <OfficeTab id=\"TabDefault\">\n              <Group id=\"msgReadGroup\">\n                <Label resid=\"groupLabel\" />\n                <Control xsi:type=\"Button\" id=\"msgReadOpenPaneButton\">\n                  <Label resid=\"paneReadButtonLabel\" />\n                  <Supertip>\n                    <Title resid=\"paneReadSuperTipTitle\" />\n                    <Description resid=\"paneReadSuperTipDescription\" />\n                  </Supertip>\n                  <Icon>\n                    <bt:Image size=\"16\" resid=\"icon16\" />\n                    <bt:Image size=\"32\" resid=\"icon32\" />\n                    <bt:Image size=\"80\" resid=\"icon80\" />\n                  </Icon>\n                  <Action xsi:type=\"ShowTaskpane\">\n                    <SourceLocation resid=\"messageReadTaskPaneUrl\" />\n                    <SupportsPinning>true</SupportsPinning>\n                  </Action>\n                </Control>\n              </Group>\n            </OfficeTab>\n          </ExtensionPoint>\n          </DesktopFormFactor>\n\t\t  <MobileFormFactor>\n            <FunctionFile resid=\"functionFile\" />\n            <ExtensionPoint xsi:type=\"MobileMessageReadCommandSurface\">\n\t\t\t\t<Group id=\"mobileMsgRead\">\n                  <Label resid=\"groupLabel\" />\n                  <Control xsi:type=\"MobileButton\" id=\"msgReadOpenPaneButton\">\n                    <Label resid=\"MobilepaneReadButtonLabel\" />\n                    <Icon xsi:type=\"bt:MobileIconList\">\n                    <bt:Image size=\"25\" scale=\"1\" resid=\"icon25\" />\n                    <bt:Image size=\"25\" scale=\"2\" resid=\"icon25\" />\n                    <bt:Image size=\"25\" scale=\"3\" resid=\"icon25\" />\n\n                    <bt:Image size=\"32\" scale=\"1\" resid=\"icon32\" />\n                    <bt:Image size=\"32\" scale=\"2\" resid=\"icon32\" />\n                    <bt:Image size=\"32\" scale=\"3\" resid=\"icon32\" />\n\n                    <bt:Image size=\"48\" scale=\"1\" resid=\"icon48\" />\n                    <bt:Image size=\"48\" scale=\"2\" resid=\"icon48\" />\n                    <bt:Image size=\"48\" scale=\"3\" resid=\"icon48\" />\n                  </Icon>\n                    <Action xsi:type=\"ShowTaskpane\">\n                      <SourceLocation resid=\"messageReadTaskPaneUrl\" />\n                    </Action>\n                  </Control>\n                </Group>\n            </ExtensionPoint>\n          </MobileFormFactor>\n         </Host>\n       </Hosts>\n    <Resources>\n      <bt:Images>\n        <bt:Image id=\"icon16\" DefaultValue=\"https://localhost/PrismIcon16.png?1=1\"/>\n\t\t<bt:Image id=\"icon25\" DefaultValue=\"https://localhost/PrismIcon25.png?1=1\"/>\n        <bt:Image id=\"icon32\" DefaultValue=\"https://localhost/PrismIcon32.png?1=1\"/>\n        <bt:Image id=\"icon48\" DefaultValue=\"https://localhost/PrismIcon48.png?1=1\"/>\n        <bt:Image id=\"icon80\" DefaultValue=\"https://localhost/PrismIcon80.png?1=1\"/>\n        <bt:Image id=\"icon96\" DefaultValue=\"https://localhost/PrismIcon96.png?1=1\"/>\n      </bt:Images>\n      <bt:Urls>\n        <bt:Url id=\"functionFile\" DefaultValue=\"https://localhost/launchEvnt.html\"/>\n        <bt:Url id=\"messageReadTaskPaneUrl\" DefaultValue=\"https://localhost/launchEvnt.html\"/>\n        <bt:Url id=\"messageReadTaskPaneSmartSendUrl\" DefaultValue=\"https://localhost/launchEvnt.html\"/>\n        <bt:Url id=\"JSRuntime.Url\" DefaultValue=\"https://localhost/launchEvnt.js\" />\n      </bt:Urls>\n      <bt:ShortStrings>\n        <bt:String id=\"groupLabel\" DefaultValue=\"DZ\"/>\n\t\t<bt:String id=\"customTabLabel\"  DefaultValue=\"DZ\"/>\n        <bt:String id=\"MobilepaneReadButtonLabel\" DefaultValue=\"DZ\"/>\n        <bt:String id=\"paneReadButtonLabel\" DefaultValue=\"DZ View\"/>\n        <bt:String id=\"paneReadSuperTipTitle\" DefaultValue=\"DZ View\"/>\n      </bt:ShortStrings>\n      <bt:LongStrings>\n        <bt:String id=\"paneReadSuperTipDescription\" DefaultValue=\"Opens the Side pane, the window to your Page.\"/>\n      </bt:LongStrings>\n    </Resources>\n\t<WebApplicationInfo>\n\t\t<Id>68de47d7-3cf1-48d0-969b-e8e9c3407394</Id>\n\t\t<Resource>api://localhost/68de47d7-3cf1-48d0-969b-e8e9c3407394</Resource>\n\t\t<Scopes>\n\t\t\t<Scope>user.read</Scope>\n\t\t\t<Scope>files.read</Scope>\n\t\t\t<Scope>profile</Scope>\n\t\t</Scopes>\n\t</WebApplicationInfo>\n    </VersionOverrides>    \n  </VersionOverrides>\n</OfficeApp>\n```\n\n**launchEvnt.html File:**\n```\n<!DOCTYPE html>\n<html class=\"newhtml\">\n\t<head>\n\t\t<title>DZ</title>\n\t\t<meta name=\"robots\" content=\"noindex\">\n\t\t<meta charset=\"utf-8\"/>\n\t\t<meta http-equiv='X-UA-Compatible' content=\"IE=edge\" />\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n\t\t<meta http-equiv=\"cache-control\" content=\"max-age=0\" />\n\t\t<meta http-equiv=\"cache-control\" content=\"no-cache, must-revalidate, post-check=0, pre-check=0\" />\n\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n\t\t<meta http-equiv=\"Pragma\" content=\"no-cache\" />\n\t\t<meta http-equiv=\"Expires\" content=\"-1\" />\n\t</head>\n\t\n\t<body class=\"\" data-scroll-top=\"false\">\n\t\t<div>DZ Panel</div>\n\t\t<script src=\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\" type=\"text/javascript\"></script>\n\t\t<script src=\"launchEvnt.js\" type=\"text/javascript\"></script>\n\t</body>\n</html>\n```\n\n**launchEvnt.js File:**\n```\nOffice.initialize = function(reason){\n\tOffice.onReady(function(info){\n\t\tconsole.log('Office is ready to use');\n\t\tOffice.context.auth.getAccessTokenAsync({ allowSignInPrompt: true }, function(result) {\n\t\t\tconsole.log(result);\n\t\t});\n\t});\n}\n```\n\n",
        "created_at": "2025-04-08T11:23:19Z"
      },
      {
        "author": "sanchitagarwal-msft",
        "body": "@aberamdatazoic \"getAccessTokenAsync\" method was deprecated. Please refer to the [documentation](https://learn.microsoft.com/en-us/javascript/api/office/office.auth?view=common-js-preview). We recommend using the  \n \"getAccessToken\" method.",
        "created_at": "2025-04-16T07:21:49Z"
      },
      {
        "author": "aberamdatazoic",
        "body": "Hi @sanchitagarwal-msft \n\nThanks for the reply. The suggested function works but I am facing the below issue. Can you please help on this?\n\n**Code which I have used:**\n```\ntry{\n\tconst accessToken = await Office.auth.getAccessToken({\n\t\tallowSignInPrompt: true,\n\t\tallowConsentPrompt: true\n\t});\n\tconsole.log(accessToken);\n} catch (error) {\n\tconsole.log(\"Error obtaining token\", error);\n}\n```\n\n**Error screenshots:**\n\n![Image](https://github.com/user-attachments/assets/d986597a-f71e-42e8-9498-5c5c8ef8fda2)\n\n![Image](https://github.com/user-attachments/assets/b4f46ab8-2beb-4057-9637-fc45b544f5dd)",
        "created_at": "2025-04-22T16:02:57Z"
      },
      {
        "author": "shighosh-msft",
        "body": "Hi @aberamdatazoic - regarding the XML manifest you shared, the WebApplicationInfo section is incorrect. You need to mention port number while using localhost.\n\n![Image](https://github.com/user-attachments/assets/82265b68-300b-4f8c-8ac4-a4b56998a727)\n\nRegarding the error that you are getting, please check if the permissions are correctly setup in your app registration - this should be under the API permissions tab. \n\n![Image](https://github.com/user-attachments/assets/9470c13c-43e0-4566-ab20-3eed9211e425)\n\nFor more info on app registration you can follow this doc: https://learn.microsoft.com/en-us/office/dev/add-ins/develop/register-sso-add-in-aad-v2",
        "created_at": "2025-04-23T13:44:51Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-27T15:36:42Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-30T17:33:05Z"
      }
    ]
  },
  {
    "number": 5571,
    "title": "Launch event not working in classic outlook",
    "body": "Environment\n\t•\tHost: Outlook\n\t•\tPlatform: Desktop\n\t•\tClient version: [e.g., Microsoft Outlook 365 Version 2402 Build 16.0.17328.20148]\n\t•\tOperating System: [e.g., Windows 11]\n\t•\tAdd-in type: Task pane\n\t•\tManifest version: [e.g., 1.12]\n\n⸻\n\nBug Description\nThe LaunchEvent defined in the manifest under <LaunchEvents> does not fire when using classic Outlook (COM-based version on Windows desktop). The event-based activation works correctly in the new Outlook (WebView2) and OWA, but in classic Outlook, the event is never triggered.\n\n⸻\n\nExpected Behavior\nThe LaunchEvent (e.g., MessageReadCommand) should be triggered when user clicks on send mail , or if unsupported, this should be a way to bypass that in classic outlook\n\n⸻\n\nCurrent Behavior\nNo activation occurs in classic Outlook. Upon clicking on send mail , the callback associated with launch event doesn’t run and application breaks.\n\n⸻\n\nSteps to Reproduce\n\t1.\tAdd <LaunchEvent> in XML with event type send \n\t2.\tSideload the add-in in classic Outlook on Windows.\n\t3.\tClick send in outlook mail\n\t4.\tIt just break and doesn’t trigger launch event and but works fine in other \n\n⸻\n\nAdditional Context\n\t•\tI understand that classic Outlook has limitations, but would like clarification/documentation update or workaround if possible.\n\t•\tRelevant docs: https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/autolaunch\n\n⸻\n\nLet me know if you want me to submit it on your behalf or assist you step-by-step in submitting it.",
    "created_at": "2025-04-06T05:47:44Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "ankit76ja",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #4379\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\nFollowing up on that, in case someone have the same issue. From what I saw, serving the script from webpack dev server is what is not working. So what I did is compiling the file with webpack and use the copy plugin to serve it. \n\nWebpack dev server seems to add a lot of things to the script in dev mode and I think that is what break outlook when trying to load the script.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4379#issuecomment-2142573267\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-04-06T05:48:19Z"
      },
      {
        "author": "kwame-ansong",
        "body": "@ankit76ja, apologies for the delay in responding to this issue.\n\nAre you referring to the [OnMessageSend](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/onmessagesend-onappointmentsend-events?tabs=windows) event here?\n\nCan you share your manifest so that we can take a look to see if we can catch what is going on here?",
        "created_at": "2025-04-30T10:44:18Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-04T11:29:50Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-07T12:21:17Z"
      }
    ]
  },
  {
    "number": 5568,
    "title": "Issues with Graph api after sending mail.",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# While sending mail via graph API -- 1. Mail is sent but it keeps a copy of mail in draft.\n                                                             2. compose window is not closing without a popup\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC desktop, Mac, OWA\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Office version number: ______\n* Operating System: Windows, Mac OS\n* Browser (if using Office on the web): Microsoft Edge\n \n## Expected behavior\nThe expected behaviour from my side is that mail.send from Graph api should work similarly to that of sendAsync in Office.js.\ni.e instead of sending a copy of my mail, it should send the mail itself. this is because if a copy is being sent, then I would have to replicate the whole send functionality again like send the mail, close the compose window , remove the mail from drafts and push it to sent items.\n## Current behavior\n The issue is even though I am able to close the compose window and push the mail into sent items ,the mail is still there in drafts and while the window is closing, a pop shows asking to save the changes( I think this is due to a copy of the mail being sent instead of the original) this popup is not a pleasant experience for the user.\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. ______\n2. ______\n3. ______\n\n## Link to live example(s)\n<!--- Ideally, provide a link to a live example, created and shared using -->\n<!--- [Script Lab](https://aka.ms/scriptlab). If relevant, create two buttons, -->\n<!--- one that sets up data in the document, and another that exemplifies the issue. -->\n1. ______\n2. ______\n3. ______\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\n1. ______\n2. ______\n3. ______\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [ ] Test file (if only happens on a particular file)\n- [ ] Screenshots\n![Image](https://github.com/user-attachments/assets/d2781797-5650-48b2-aab1-b3f0dc0e0686)\n\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-04-04T06:18:55Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "VamseeAcc",
    "comments": [
      {
        "author": "kumarshrey-msft",
        "body": "Hi @VamseeAcc ,\n\nYou can try the [item.closeAsync](https://learn.microsoft.com/en-us/javascript/api/outlook/office.messagecompose?view=outlook-js-preview#outlook-office-messagecompose-closeasync-member(1)) API for achieving the same. Additionally, you can keep the `discardItem` property as true if you wish to directly delete the item without prompting the user to discard unsaved changes. Let me know if this works for you.",
        "created_at": "2025-04-04T06:44:52Z"
      },
      {
        "author": "VamseeAcc",
        "body": "Hi @kumarshrey-msft  I am already using item.closeAsync to close the window and it is giving me that popup. Coming to the discardItem I used it like you suggested but the mail still stays in drafts. Here is my code for reference:\n\n```\nconst sendMail = async () => {\n  const accessToken = await acquireToken();\n  if (!accessToken) {\n    console.error(\"Failed to acquire access token\");\n    return;\n  }\n\n  const client = Client.init({\n    authProvider: (done) => done(null, accessToken),\n  });\n\n  const emailData = {\n    message: {\n      subject: \"Test Mail\",\n      body: { contentType: \"Text\", content: \"This is a test email.\" },\n      toRecipients: unallowedRecipients.map((recipient) => ({\n        emailAddress: { address: recipient.emailAddress },\n      })),\n    },\n    saveToSentItems: true,\n    discardItem: true\n  };\n\n  try {\n    // Send the email\n    await client.api(\"/users/vamseedhar@outlook.com/sendMail\").post(emailData); //this is a example path\n\n    // Close the compose window\n    Office.context.mailbox.item.closeAsync();\n    \n  } catch (error) {\n    console.error(\"Error sending mail:\", error);\n  }\n};\n```",
        "created_at": "2025-04-04T07:02:06Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @VamseeAcc ,\n\nAs mentioned [here](https://learn.microsoft.com/en-us/javascript/api/outlook/office.messagecompose?view=outlook-js-preview#outlook-office-messagecompose-closeasync-member(1)), when you don't pass the discardItem parameter in the API call, by default it's value is treated as false, and a save dialog might appear prompting the user to save the draft, discard changes, or cancel the operation. \n\nCan you try the sample code below and let me know if it works?\n\n```\nOffice.context.mailbox.item.closeAsync\n(\n  {discardItem: true},\n\tfunction(asyncResult)\n\t{\n\t\tif (asyncResult.status == \"failed\") {\n    \t\t\tconsole.log(JSON.stringify(asyncResult));\n  \t\t}\n\t}\n);\n```\n\n",
        "created_at": "2025-04-04T07:23:09Z"
      },
      {
        "author": "VamseeAcc",
        "body": "The code works @kumarshrey-msft . Thanks for that, but I noticed that after sending the mail, it is not being stored in sent items. Prior to this it was being saved in sent items also. Is there any particular reason this is happening ?",
        "created_at": "2025-04-04T08:13:00Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @VamseeAcc , \n\nThe `send` behavior you are referring to is that of Graph's [sendMail API](https://learn.microsoft.com/en-us/graph/api/user-sendmail?view=graph-rest-1.0&tabs=http) and not [Office JS's sendAsync](https://learn.microsoft.com/en-us/javascript/api/outlook/office.messagecompose?view=outlook-js-preview#outlook-office-messagecompose-sendasync-member(1)), correct? This forum is limited to supporting office-js apis. For any MS API Graph specific queries and support, please explore options available at [Microsoft Graph Dev Center | APIs and app development](https://developer.microsoft.com/en-us/graph).\n\nIn the meantime, let me know if you have other queries regarding OfficeJS's `closeAsync` API",
        "created_at": "2025-04-04T09:28:38Z"
      },
      {
        "author": "VamseeAcc",
        "body": "Thanks for the support @kumarshrey-msft . May I know the sendAsync support for outlook across all the platforms please.\nAs far as I know I can confirm that sendAsync only works in OWA and newer outlook in windows. Its not working in classic outlook in windows and newer outlook in Mac OS. Can I know the reason behind this ?",
        "created_at": "2025-04-04T09:41:28Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "On Classic Outlook, the support for this API is available with Versions 2412 (Build 18324.20000) and above, and is being gradually rolled out. On Outlook Mac as well, this API will be supported in the upcoming months, we will update our public docs whenever that happens. \n\nHope this helps! ",
        "created_at": "2025-04-04T10:09:38Z"
      },
      {
        "author": "VamseeAcc",
        "body": "Hi @kumarshrey-msft  I am using the latest versions for classic outlook (Version 2501 Build 16.0.18429.20132) 64-bit , but still I am not able to send the mail. I will attach the version below along with the code.\n\n```\nconst sendMail = async () => {\n    try {\n      // Get the current item\n      const item = Office.context.mailbox.item;\n\n      // Send the email using Outlook API\n      item.sendAsync((asyncResult) => {\n        if (asyncResult.status === Office.AsyncResultStatus.Failed) {\n          console.error(\"Error sending mail:\", asyncResult.error.message);\n        } else {\n          console.log(\"Email sent successfully\");\n          // No need to manually close - Outlook handles this automatically\n        }\n      });\n    } catch (error) {\n      console.error(\"Error in sendMail:\", error);\n    }\n  };\n```\n\n![Image](https://github.com/user-attachments/assets/f6bb7f06-c022-429c-9ae8-2827f371e1ae)\n![Image](https://github.com/user-attachments/assets/1df90dc6-d7fb-4005-b840-c4db639df69f)",
        "created_at": "2025-04-04T11:34:17Z"
      },
      {
        "author": "VamseeAcc",
        "body": "Hi @kumarshrey-msft . any update on my last comment here ?\n\nhttps://github.com/OfficeDev/office-js/issues/5568#issuecomment-2778434473",
        "created_at": "2025-04-09T05:01:18Z"
      },
      {
        "author": "millerds",
        "body": "Just to confirm . . . are you using item.sendAsync on an email compose form?",
        "created_at": "2025-04-25T23:35:00Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-11T23:27:59Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-15T02:41:06Z"
      }
    ]
  },
  {
    "number": 5565,
    "title": "Outlook Shared calendar not displaying custom apps (webaddin XML which we installed)",
    "body": "\n\n\nIn shared calendar we are not able to find the installed apps.\n\n\nIn all platforms we have this issue\n \n## Expected behavior\nNeed to show the apps which are installed by the person in the shared calender\n\n## Current behavior\nNow we are not able to find any apps in the shared calendar.\n\n## Steps to reproduce\n1. Open any shared calendar\n2. From that select any meeting from calendar and open the meeting by Dubble click \n3. There you can see all apps Icon but when we click that button inside, we don't have any installed apps\n\n\n## Useful logs\n\n- this is the issue\n\n![Image](https://github.com/user-attachments/assets/1255617a-7bc2-4ccd-b674-84ffccb67635)\n\n - expected behavior - for the shared calendar \n![Image](https://github.com/user-attachments/assets/5506ba31-a4b1-469d-a29a-9df31c6529ac)\n",
    "created_at": "2025-04-03T16:49:53Z",
    "state": "closed",
    "labels": [
      "Area: Outlook"
    ],
    "author": "ReddyBhargavi18",
    "comments": [
      {
        "author": "ReddyBhargavi18",
        "body": "Hi, do we have any update on this issue",
        "created_at": "2025-04-08T06:07:00Z"
      },
      {
        "author": "ReddyBhargavi18",
        "body": "Hi @exextoc, is there any update on this issue",
        "created_at": "2025-04-14T04:27:39Z"
      },
      {
        "author": "millerds",
        "body": "Does the add-in you are looking for support shared folders?\n\nhttps://learn.microsoft.com/en-us/office/dev/add-ins/outlook/delegate-access?tabs=windows%2Cxmlmanifest ",
        "created_at": "2025-05-07T23:23:35Z"
      },
      {
        "author": "ReddyBhargavi18",
        "body": "Yes how to make the addin to support for the shared folder",
        "created_at": "2025-05-08T04:16:50Z"
      },
      {
        "author": "millerds",
        "body": "The link I posted previously is the instructions for developing an add-in that supports it.  It's not something you can do to an add-in developed by someone else.",
        "created_at": "2025-05-08T17:31:43Z"
      },
      {
        "author": "ReddyBhargavi18",
        "body": "Hi @millerds, \n\nI have tried the instruction for add-in that support the sharedfolder(added <SupportsSharedFolders> in the attached manifest file) as you have suggested but XML manifest file is not being installed properly. Its failing.\n\nHere I have attached with is the sample manifest file which I have used for installation.\n\nCould you let me know if I am missing anything or anything needs to be changed to resolve this?\n\n**Manifest File**\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<OfficeApp \n          xmlns=\"http://schemas.microsoft.com/office/appforoffice/1.1\" \n          xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \n          xmlns:bt=\"http://schemas.microsoft.com/office/officeappbasictypes/1.0\" \n          xmlns:mailappor=\"http://schemas.microsoft.com/office/mailappversionoverrides\" \n          xsi:type=\"MailApp\">\n\n  <Id>d9d81f5a-e002-4475-88bc-cc51e3c97816</Id>\n  <Version>1.0.0.12</Version>\n  <ProviderName>Text Addin</ProviderName>\n  <DefaultLocale>en-US</DefaultLocale>\n  <DisplayName DefaultValue=\"DZ\" />\n  <Description DefaultValue=\"DZ Description.\"/>\n  <IconUrl DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon96.png?1=1\"/>\n  <HighResolutionIconUrl DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon96.png?1=1\" />\n\n  <Hosts>\n    <Host Name=\"Mailbox\" />\n  </Hosts>\n  <Requirements>\n    <Sets>\n      <Set Name=\"Mailbox\" MinVersion=\"1.3\" />\n    </Sets>\n  </Requirements>\n  <FormSettings>\n    <Form xsi:type=\"ItemRead\">\n      <DesktopSettings>\n        <SourceLocation DefaultValue=\"https://localhost/launchEvnt.html\"/>\n        <RequestedHeight>250</RequestedHeight>\n      </DesktopSettings>\n    </Form>\n    <Form xsi:type=\"ItemEdit\">\n      <DesktopSettings>\n        <SourceLocation DefaultValue=\"https://localhost/launchEvnt.html\"/>\n      </DesktopSettings>\n    </Form>\n  </FormSettings>\n  \n\n  <Permissions>ReadWriteMailbox</Permissions>\n  <Rule xsi:type=\"RuleCollection\" Mode=\"Or\">\n    <Rule xsi:type=\"ItemIs\" ItemType=\"Message\" FormType=\"Read\" />\n  </Rule>\n  <DisableEntityHighlighting>false</DisableEntityHighlighting>\n\n  <VersionOverrides xmlns=\"http://schemas.microsoft.com/office/mailappversionoverrides\" xsi:type=\"VersionOverridesV1_0\">\n    <Requirements>\n      <bt:Sets DefaultMinVersion=\"1.3\">\n        <bt:Set Name=\"Mailbox\" />\n      </bt:Sets>\n    </Requirements>\n    <Hosts>\n      <Host xsi:type=\"MailHost\">\n\n        <DesktopFormFactor>\n          <FunctionFile resid=\"functionFile\" />\n          <SupportsSharedFolders>true</SupportsSharedFolders>\n\t\t\t<ExtensionPoint xsi:type=\"MessageReadCommandSurface\">\n            <OfficeTab id=\"TabDefault\">\n              <Group id=\"msgReadGroup\">\n                <Label resid=\"groupLabel\" />\n                <Control xsi:type=\"Button\" id=\"msgReadOpenPaneButton\">\n                  <Label resid=\"paneReadButtonLabel\" />\n                  <Supertip>\n                    <Title resid=\"paneReadSuperTipTitle\" />\n                    <Description resid=\"paneReadSuperTipDescription\" />\n                  </Supertip>\n                  <Icon>\n                    <bt:Image size=\"16\" resid=\"icon16\" />\n                    <bt:Image size=\"32\" resid=\"icon32\" />\n                    <bt:Image size=\"80\" resid=\"icon80\" />\n                  </Icon>\n                  <Action xsi:type=\"ShowTaskpane\">\n\t\t\t\t\t<SourceLocation resid=\"messageReadTaskPaneUrl\" />\n                  </Action>\n                </Control>\n              </Group>\n            </OfficeTab>\n          </ExtensionPoint>\n\t\t</DesktopFormFactor>\n      </Host>\n    </Hosts>\n\n    <Resources>\n      <bt:Images>\n        <bt:Image id=\"icon16\" DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon16.png?1=1\"/>\n\t\t<bt:Image id=\"icon25\" DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon25.png?1=1\"/>\n        <bt:Image id=\"icon32\" DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon32.png?1=1\"/>\n        <bt:Image id=\"icon48\" DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon48.png?1=1\"/>\n        <bt:Image id=\"icon80\" DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon80.png?1=1\"/>\n        <bt:Image id=\"icon96\" DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon96.png?1=1\"/>\n      </bt:Images>\n      <bt:Urls>\n        <bt:Url id=\"functionFile\" DefaultValue=\"https://localhost/launchEvnt.html\"/>\n        <bt:Url id=\"messageReadTaskPaneUrl\" DefaultValue=\"https://localhost/launchEvnt.html\"/>\n      </bt:Urls>\n      <bt:ShortStrings>\n        <bt:String id=\"groupLabel\" DefaultValue=\"DZ\"/>\n        <bt:String id=\"customTabLabel\"  DefaultValue=\"DZ\"/>\n        <bt:String id=\"paneReadButtonLabel\" DefaultValue=\"DZ View\"/>\n        <bt:String id=\"paneReadSuperTipTitle\" DefaultValue=\"DZ View\"/>\n      </bt:ShortStrings>\n      <bt:LongStrings>\n        <bt:String id=\"paneReadSuperTipDescription\" DefaultValue=\"Opens the Side pane, the window to your Page.\"/>\n      </bt:LongStrings>\n    </Resources>\n    <VersionOverrides xmlns=\"http://schemas.microsoft.com/office/mailappversionoverrides/1.1\" xsi:type=\"VersionOverridesV1_1\">\n      <Requirements>\n        <bt:Sets DefaultMinVersion=\"1.13\">\n          <bt:Set Name=\"Mailbox\" />\n        </bt:Sets>\n      </Requirements>\n      <Hosts>\n        <Host xsi:type=\"MailHost\">\n\t\t\n\t\t<Runtimes>\n          <Runtime resid=\"functionFile\">\n            <Override type=\"javascript\" resid=\"JSRuntime.Url\"/>\n          </Runtime>\n        </Runtimes>\n          <DesktopFormFactor>\n            <FunctionFile resid=\"functionFile\" />\n           <SupportsSharedFolders>true</SupportsSharedFolders>\n          <ExtensionPoint xsi:type=\"MessageReadCommandSurface\">\n            <OfficeTab id=\"TabDefault\">\n              <Group id=\"msgReadGroup\">\n                <Label resid=\"groupLabel\" />\n                <Control xsi:type=\"Button\" id=\"msgReadOpenPaneButton\">\n                  <Label resid=\"paneReadButtonLabel\" />\n                  <Supertip>\n                    <Title resid=\"paneReadSuperTipTitle\" />\n                    <Description resid=\"paneReadSuperTipDescription\" />\n                  </Supertip>\n                  <Icon>\n                    <bt:Image size=\"16\" resid=\"icon16\" />\n                    <bt:Image size=\"32\" resid=\"icon32\" />\n                    <bt:Image size=\"80\" resid=\"icon80\" />\n                  </Icon>\n                  <Action xsi:type=\"ShowTaskpane\">\n                    <SourceLocation resid=\"messageReadTaskPaneUrl\" />\n                    <SupportsPinning>true</SupportsPinning>\n                  </Action>\n                </Control>\n              </Group>\n            </OfficeTab>\n          </ExtensionPoint>\n          </DesktopFormFactor>\n\t\t  <MobileFormFactor>\n            <FunctionFile resid=\"functionFile\" />\n            <ExtensionPoint xsi:type=\"MobileMessageReadCommandSurface\">\n\t\t\t\t<Group id=\"mobileMsgRead\">\n                  <Label resid=\"groupLabel\" />\n                  <Control xsi:type=\"MobileButton\" id=\"msgReadOpenPaneButton\">\n                    <Label resid=\"MobilepaneReadButtonLabel\" />\n                    <Icon xsi:type=\"bt:MobileIconList\">\n                    <bt:Image size=\"25\" scale=\"1\" resid=\"icon25\" />\n                    <bt:Image size=\"25\" scale=\"2\" resid=\"icon25\" />\n                    <bt:Image size=\"25\" scale=\"3\" resid=\"icon25\" />\n\n                    <bt:Image size=\"32\" scale=\"1\" resid=\"icon32\" />\n                    <bt:Image size=\"32\" scale=\"2\" resid=\"icon32\" />\n                    <bt:Image size=\"32\" scale=\"3\" resid=\"icon32\" />\n\n                    <bt:Image size=\"48\" scale=\"1\" resid=\"icon48\" />\n                    <bt:Image size=\"48\" scale=\"2\" resid=\"icon48\" />\n                    <bt:Image size=\"48\" scale=\"3\" resid=\"icon48\" />\n                  </Icon>\n                    <Action xsi:type=\"ShowTaskpane\">\n                      <SourceLocation resid=\"messageReadTaskPaneUrl\" />\n                    </Action>\n                  </Control>\n                </Group>\n            </ExtensionPoint>\n          </MobileFormFactor>\n         </Host>\n       </Hosts>\n    <Resources>\n      <bt:Images>\n        <bt:Image id=\"icon16\" DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon16.png?1=1\"/>\n\t\t<bt:Image id=\"icon25\" DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon25.png?1=1\"/>\n        <bt:Image id=\"icon32\" DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon32.png?1=1\"/>\n        <bt:Image id=\"icon48\" DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon48.png?1=1\"/>\n        <bt:Image id=\"icon80\" DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon80.png?1=1\"/>\n        <bt:Image id=\"icon96\" DefaultValue=\"https://localhost/prismimg/webaddin/PrismIcon96.png?1=1\"/>\n      </bt:Images>\n      <bt:Urls>\n        <bt:Url id=\"functionFile\" DefaultValue=\"https://localhost/launchEvnt.html\"/>\n        <bt:Url id=\"messageReadTaskPaneUrl\" DefaultValue=\"https://localhost/launchEvnt.html\"/>\n        <bt:Url id=\"messageReadTaskPaneSmartSendUrl\" DefaultValue=\"https://localhost/launchEvnt.html\"/>\n        <bt:Url id=\"JSRuntime.Url\" DefaultValue=\"https://localhost/launchEvnt.js\" />\n      </bt:Urls>\n      <bt:ShortStrings>\n        <bt:String id=\"groupLabel\" DefaultValue=\"DZ\"/>\n\t\t<bt:String id=\"customTabLabel\"  DefaultValue=\"DZ\"/>\n        <bt:String id=\"MobilepaneReadButtonLabel\" DefaultValue=\"DZ\"/>\n        <bt:String id=\"paneReadButtonLabel\" DefaultValue=\"DZ View\"/>\n        <bt:String id=\"paneReadSuperTipTitle\" DefaultValue=\"DZ View\"/>\n      </bt:ShortStrings>\n      <bt:LongStrings>\n        <bt:String id=\"paneReadSuperTipDescription\" DefaultValue=\"Opens the Side pane, the window to your Page.\"/>\n      </bt:LongStrings>\n    </Resources>\n    </VersionOverrides>    \n  </VersionOverrides>\n</OfficeApp>\n```",
        "created_at": "2025-05-12T09:43:45Z"
      },
      {
        "author": "millerds",
        "body": "The manifest is invalid and so sideloading won't work.  You can use the manifest validation command to make sure you manifest it valid.  If you create the project using 'yo office' run 'npm run validate', but if not you can run \"npx office-addin-manifest validate manifest.xml\".  It will tell you that there are schema violations involving the use of \"SupportsSharedFolders\", but it doesn't tell some details you'd have to figure out.\n\nThe documentation for the element (https://learn.microsoft.com/en-us/javascript/api/manifest/supportssharedfolders?view=common-js-preview) notes that it's only supported in the override schema 1.1 and you have it in both.\n\nA bit more subtle is the ordering of the child elements matters.  You'll see in the example that \"SupportsSharedFolders\" comes before \"FunctionFile\" and you have it reversed.\n\nThere is another reported error with your manifest that you'll have to correct.",
        "created_at": "2025-05-12T17:01:52Z"
      },
      {
        "author": "ReddyBhargavi18",
        "body": "Hi @millerds,\n\nManifest.xml file installed successfully. But there is another dependency for delegate access.\n\n****makeEwsRequestAsync**()** Using this function to get the UID but for delegate access that particular function is not supporting. Is there any method for delegate access to get the UID.",
        "created_at": "2025-05-13T15:06:31Z"
      },
      {
        "author": "millerds",
        "body": "That would be a different question that should be put in its own post.",
        "created_at": "2025-05-13T17:00:17Z"
      }
    ]
  },
  {
    "number": 5563,
    "title": "Addin offline availability",
    "body": "Is there a way to enable the add-in to function offline? I have a task pane add-in where some features are accessible through the task pane, while others are triggered via the ribbon. Is it possible to insert a shape into PowerPoint while in offline mode (when there is no internet connection)?\n\n",
    "created_at": "2025-04-03T08:58:38Z",
    "state": "closed",
    "labels": [
      "Needs: author feedback",
      "Area: PowerPoint",
      "Type: product question",
      "Status: no recent activity"
    ],
    "author": "MariaLawrenceAntony",
    "comments": [
      {
        "author": "preethikakiru",
        "body": "Hi @MariaLawrenceAntony, \nThanks for your question! @EsterBergen will be able to help answer your question further. \nBest, \nPreethika",
        "created_at": "2025-04-03T21:23:43Z"
      },
      {
        "author": "MariaLawrenceAntony",
        "body": "@EsterBergen any update on this?",
        "created_at": "2025-05-12T09:17:12Z"
      },
      {
        "author": "EsterBergen",
        "body": "@MariaLawrenceAntony - Have you tried this? https://learn.microsoft.com/en-us/samples/officedev/Office-Add-in-samples/use-storage-techniques-to-access-data-from-an-office-add-in-when-offline/",
        "created_at": "2025-05-12T15:26:24Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-16T18:05:31Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-16T18:05:31Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-19T21:57:26Z"
      }
    ]
  },
  {
    "number": 5562,
    "title": "Console errors",
    "body": "",
    "created_at": "2025-04-03T02:56:25Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Type: programming question",
      "Area: Word"
    ],
    "author": "WenyanZhao",
    "comments": [
      {
        "author": "preethikakiru",
        "body": "Hi @WenyanZhao, \n@jipyua will be able to help you in the original ticket!\nThanks,\nPreethika",
        "created_at": "2025-04-03T21:22:26Z"
      }
    ]
  },
  {
    "number": 5561,
    "title": "RichApi.Error: GeneralException when I  use document.insertfilefrombase64",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: ___PC desktop___\n* Host [Excel, Word, PowerPoint, etc.]: _____word_\n* Office version number: ___2108___\n* Operating System: __windows____\n* Browser (if using Office on the web): ______\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nI want import word template including header and footer when I use document.InsertFileFromBase64\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nWhen I use document.InsertFileFromBase64(base64string,replace), error occus\ncode like this:\ncontext.document.insertFileFromBase64(base64String,\"Replace\")\nawait context.sync()\nerror info:\nRichApi.Error: GeneralException\n    at new n (word-win32-16.01.js:25:270362)\n    at r.processRequestExecutorResponseMessage (word-win32-16.01.js:25:335524)\n    at word-win32-16.01.js:25:333585\n\n\n## Useful logs\nRichApi.Error: GeneralException\n    at new n (word-win32-16.01.js:25:270362)\n    at r.processRequestExecutorResponseMessage (word-win32-16.01.js:25:335524)\n    at word-win32-16.01.js:25:333585\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-04-03T02:55:48Z",
    "state": "closed",
    "labels": [
      "Needs: author feedback",
      "Type: programming question",
      "Area: Word",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "WenyanZhao",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #5484\n- #3333\n- #3270\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\nFYI it looks like this was related to my version of Word. After updating to 2304 I no longer get the error.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3333#issuecomment-1533418657\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-04-03T02:56:29Z"
      },
      {
        "author": "WenyanZhao",
        "body": "> Here are some similar issues that might help you. Please check if they can solve your problem.\n> \n> * [RichApi.Error: GeneralException still occurs when call insertFileFromBase64 in document 'Viewing' mode #5484](https://github.com/OfficeDev/office-js/issues/5484)\n> * [Beta API document.insertFileFromBase64 fails  #3333](https://github.com/OfficeDev/office-js/issues/3333)\n> * [File insertion in Word fails with error ooxmlIsMalformated #3270](https://github.com/OfficeDev/office-js/issues/3270)\n> \n> **Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n> \n> FYI it looks like this was related to my version of Word. After updating to 2304 I no longer get the error.\n> \n> **Reference**:\n> \n> * [Beta API document.insertFileFromBase64 fails  #3333 (comment)](https://github.com/OfficeDev/office-js/issues/3333#issuecomment-1533418657)\n> \n> _Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_\n\nI've tried the above and none of them worked",
        "created_at": "2025-04-03T03:15:20Z"
      },
      {
        "author": "preethikakiru",
        "body": "Hi @WenyanZhao, \nThanks for your question, @jipyua will be able to help further answer your question.\nBest, \nPreethika",
        "created_at": "2025-04-03T21:21:11Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi @WenyanZhao ,\n\nCould you please share the base64 string you are using? It would help us to isolate the issue.",
        "created_at": "2025-04-07T08:24:08Z"
      },
      {
        "author": "WenyanZhao",
        "body": "> Hi [@WenyanZhao](https://github.com/WenyanZhao) ,\n> \n> Could you please share the base64 string you are using? It would help us to isolate the issue.\n\n[111.docx](https://github.com/user-attachments/files/19659338/111.docx)",
        "created_at": "2025-04-09T02:14:33Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi @WenyanZhao ,\n\nI can insert the template correctly by using your docx, like below:\n\n![Image](https://github.com/user-attachments/assets/05a79ab0-0460-47bb-8d38-bfbe39a1f5a9)",
        "created_at": "2025-04-09T06:36:48Z"
      },
      {
        "author": "WenyanZhao",
        "body": "> Hi [@WenyanZhao](https://github.com/WenyanZhao) ,\n> \n> I can insert the template correctly by using your docx, like below:\n> \n> ![Image](https://github.com/user-attachments/assets/05a79ab0-0460-47bb-8d38-bfbe39a1f5a9)\n\nMagical, why can't I . Office version is Microsoft Office LSTC Professional Plus 2021 （2108）. What's version you used?\nMy code is this:\n\n async insertTemplate(base64String) {\n   \n   await Word.run(async function (context) {\n     const range = context.document.getSelection()\n     \n     const doc = context.document;\n     await doc.insertFileFromBase64(base64String, \"Replace\", \n       {\n         importTheme: false,\n         importStyles: false,\n         importParagraphSpacing: false,\n         importPageColor: false,\n         importChangeTrackingMode: false\n       }\n     );\n     await context.sync()\n   });\n \n }",
        "created_at": "2025-04-09T08:55:05Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi this is the [document](https://learn.microsoft.com/en-us/javascript/api/word/word.document?view=word-js-preview#word-word-document-insertfilefrombase64-member(1)) for this API. It's requirement set is WordApi 1.5 whose minimum office version may not apply to your version. You can check on this [link](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/word/word-api-requirement-sets?view=common-js-preview). I suggest that you can update your office to leverage the latest API.",
        "created_at": "2025-04-09T09:08:23Z"
      },
      {
        "author": "WenyanZhao",
        "body": "> Hi this is the [document](https://learn.microsoft.com/en-us/javascript/api/word/word.document?view=word-js-preview#word-word-document-insertfilefrombase64-member(1)) for this API. It's requirement set is WordApi 1.5 whose minimum office version may not apply to your version. You can check on this [link](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/word/word-api-requirement-sets?view=common-js-preview). I suggest that you can update your office to leverage the latest API.\n\nBut I saw the office API document.  WordApi 1.1 also have this function(https://learn.microsoft.com/en-us/javascript/api/word/word.contentcontrol?view=word-js-preview#word-word-contentcontrol-insertfilefrombase64-member(1)). Isn't this function unavailable in previous versions bellow 1.5?",
        "created_at": "2025-04-09T09:24:08Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "your snippet is for dcoument.insertfilefrombase64. The document you provided is for contentcontrol.insertfilefrombase64. That's a different story.",
        "created_at": "2025-04-09T09:33:09Z"
      },
      {
        "author": "WenyanZhao",
        "body": "> your snippet is for dcoument.insertfilefrombase64. The document you provided is for contentcontrol.insertfilefrombase64. That's a different story.\n\nWell, I confused it. Thank you for your answer\nBut if I want import word template including header and footer using this office version, is there other ways？",
        "created_at": "2025-04-10T01:46:49Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "As I talked before, your current office version can't user the dcoument.insertfilefrombase64. The only way is to update your office to latest version.",
        "created_at": "2025-04-10T04:55:28Z"
      }
    ]
  },
  {
    "number": 5560,
    "title": "Some add-in users got \"The identity API is not supported for this add-in.\" error",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\nHello! We are having issues with obtaining SSO token, and have an error trying to retrieve it. Happens only for limited set of users.\n\n## Your Environment\nPlatform [PC desktop, Mac, iOS, Office on the web]: Windows \nHost [Excel, Word, PowerPoint, etc.]: Outlook\nOffice version number: Occurs in web app as well\nOperating System: Windows\nBrowser (if using Office on the web): Chrome\n \n## Expected behavior\nSSO token with the call OfficeRuntime.auth.getAccessToken({ allowConsentPrompt: true, allowSignInPrompt: true }) should be returned succesfully\n\n## Current behavior\nWe have next response:\n`{\"name\":\"API Not Supported\",\"message\":\"The identity API is not supported for this add-in.\",\"code\":13000}`\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\nCall (happens only for some users):\n```\nOfficeRuntime.auth.getAccessToken({ allowConsentPrompt: true, allowSignInPrompt: true })\n    .then((successResult) => {\n    },\n        (failureResult) => {\n            console.log(JSON.stringify(failureResult));\n            });\n        });\n```\nAfter that we see the above error\n\n## Link to live example(s)\nNA\n\n# Provide additional details\nIn the manifest file we have WebApplicationInfo node:\n`<WebApplicationInfo>\n    <Id>someValue</Id>\n    <Resource>someValue</Resource>\n    <Scopes>\n    <Scope>openid</Scope>\n\t<Scope>email</Scope>\n\t<Scope>offline_access</Scope>\n    <Scope>user.read</Scope>\n\t<Scope>mail.read</Scope>\n    <Scope>profile</Scope>\n    </Scopes>\n    </WebApplicationInfo>`\n Also clients which have this error are using Office 365, so everything should be fine due to [documentation](https://learn.microsoft.com/en-us/office/dev/add-ins/develop/troubleshoot-sso-in-office-add-ins?source=recommendations#13000)\n## Context\nSome users of our Outlook add-in are getting an error when attempting to login to our service within the add-in, ultimately due to the above error.\n\n",
    "created_at": "2025-04-02T14:56:09Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Outlook",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "anton-serhieiev-me",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #2298\n- #1972\n- #4759\n- #398\n- #355\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nRestart your Office application and try again. This might be an issue with flighting, and restarting Office can update the cache and resolve the issue.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/355#issuecomment-475307815\n- https://github.com/officedev/office-js/issues/355#issuecomment-546085686\n### Solution 2:\nEnsure that you are using the latest build from the Insiders channel. The API is not supported on any other channel, and it is turned off in older versions, even if they were originally received from the Insiders channel.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/398#issuecomment-465254878\n### Solution 3:\nCheck if the SSO feature has been flighted for your version. If not, it might be turned off for stable versions, including perpetual. You might need to switch to a version where the feature is enabled.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/355#issuecomment-458786403\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-04-02T14:57:02Z"
      },
      {
        "author": "Oleg-O",
        "body": "Could you please clarify which Outlook clients you are getting these reports for, and their versions? For Windows Desktop please also clarify if this is New Outlook or Classic Outlook.",
        "created_at": "2025-04-03T20:56:03Z"
      },
      {
        "author": "anton-serhieiev-me",
        "body": "Oleg-O, thank you for your response. We were able to reproduce it in WEB version, using Chrome 134.0.6998.178. \nOur current flow is relies on SSO and fallback to exchange token. We have found an issue once legacy exchange tokens started to turn off. Currently we turned on legacy tokens manually, using exchange PowerShell, until June.",
        "created_at": "2025-04-04T18:50:16Z"
      },
      {
        "author": "anton-serhieiev-me",
        "body": "And one more question - we turned on exchange tokens manually (https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/turn-exchange-tokens-on-off), because we saw that a lot of users were facing an issue, where exchange token returns as 'undefined', it started to happen few weeks ago. But after turning legacy tokens on, only some users were fixed, others are still facing the issue. What could the root cause of this?",
        "created_at": "2025-04-08T15:06:50Z"
      },
      {
        "author": "davidchesnut",
        "body": "Hi @anton-serhieiev-me,\n\nSorry for the late reply here. Are you still having issues with calls to getAccessToken? Regarding turning tokens back on, if tokens are not issued you will see an error similar to the following. Is this what you are getting?\n\n- GenericTokenError: An internal error has occurred.\n- InternalServerError: The Exchange server returned an error. Please look at the diagnostics object for more information.\n\nThanks!\nDavid",
        "created_at": "2025-05-14T21:31:56Z"
      },
      {
        "author": "anton-serhieiev-me",
        "body": "Hi @davidchesnut !\nSorry for the delayed response. We implemented NAA and everything looks good so far. I will close the issue.\n\nThank you! \n\n",
        "created_at": "2025-05-16T18:04:46Z"
      }
    ]
  },
  {
    "number": 5557,
    "title": "Office.context.mailbox.item.getAsFileAsync does not work for draft message",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n## Summary\nWe have a requirement in an Office.js add-in to do the following:\n- Automatically send a message\n- Save the sent message\n\nThe functionality was previously implemented using EWS and Office.context.mailbox.getCallbackTokenAsync. However, I understand that both are being phased out. Office.auth.getAccessToken is supposed to replace Office.context.mailbox.getCallbackTokenAsync, but I did not manage to get it to work in my add-in. To send the mail, Office.context.mailbox.item.sendAsync is now available, but it currently does not allow to execute code _after_ sending. So we want to collect the draft _before_ sending and process it in the back-end of our web app;. We are hindered here by the fact that Office.context.mailbox.item.getAsFileAsync cannot be used on a draft. We get the error message \"Office.context.mailbox.item.getAsFileAsync is not a function\". Please fix.\n\n## Expected behavior\nOffice.context.mailbox.item.getAsFileAsync also works in compose mode.\n\n## Current behavior\nWhen Office.context.mailbox.item.getAsFileAsync is called in compose mode, an error is raised.\n\n## Steps to reproduce\n1. Create an Outlook add-in with an ExecuteFunction called in the MessageComposeCommandSurface. Name the function \"sendAndSave\"\n2. In outlook.office.com, sideload your add-in, create a new mail and click the button to execute sendAndSave\n3. Add this code in the sendAndSave handler:\n\n``` javascript\nasync function sendAndSave(event) {\n  let emlContent = await downloadDraftAsEML();\n}\n\nasync function downloadDraftAsEML() {\n    return new Promise((resolve) => {\n        Office.context.mailbox.item.getAsFileAsync(Office.FileType.EML, function(result) {\n            if (result.status === Office.AsyncResultStatus.Succeeded) {\n                let file = result.value;\n                let reader = new FileReader();\n                reader.onload = function(e) {\n                    resolve(e.target.result);\n                };\n                reader.readAsText(file);\n            } else {\n                console.error(\"Failed to get EML:\", result.error.message);\n                resolve(null);\n            }\n        });\n    });\n}\n```\ndownloadDraftAsEML raises an error and the calling function receives null instead of eml content.\n\n",
    "created_at": "2025-04-02T09:03:04Z",
    "state": "closed",
    "labels": [
      "Area: Outlook"
    ],
    "author": "berendengelbrecht",
    "comments": [
      {
        "author": "sanchitagarwal-msft",
        "body": "@berendengelbrecht Thank you for the input. This will be considered as a new feature request.\nWe track Outlook add-in feature requests on our [Tech Community Page](http://aka.ms/M365dev-suggestions). Please submit your request there and choose the appropriate label(s). Feature requests on Tech Community are considered when we go through our planning process.",
        "created_at": "2025-04-08T10:54:34Z"
      },
      {
        "author": "berendengelbrecht",
        "body": "Added feature request here: [https://techcommunity.microsoft.com/idea/microsoft365developerplatform/implement-office-context-mailbox-item-getasfileasync-for-draft-messages/4402745](https://techcommunity.microsoft.com/idea/microsoft365developerplatform/implement-office-context-mailbox-item-getasfileasync-for-draft-messages/4402745)",
        "created_at": "2025-04-10T05:39:53Z"
      }
    ]
  },
  {
    "number": 5555,
    "title": "custom functions excel add-in #NAME error",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: ___PC desktop___\n* Host [Excel, Word, PowerPoint, etc.]: __Excel____\n* Office version number: ___2502___\n* Operating System: ___Windows 10___\n* Browser (if using Office on the web): ______\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\n\nI have created a new custom function excel add-in using `CustomFunctionsRuntime` but when I am running the add-in it is giving me `#NAME` error\n \nI have installed Office Samples manifest but it is also giving me the same error\n\n![Image](https://github.com/user-attachments/assets/4b8834d2-90d7-4099-86a0-c991e86dad3c)\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. ______\n2. ______\n3. ______\n\n## Link to live example(s)\n<!--- Ideally, provide a link to a live example, created and shared using -->\n<!--- [Script Lab](https://aka.ms/scriptlab). If relevant, create two buttons, -->\n<!--- one that sets up data in the document, and another that exemplifies the issue. -->\n1. ______\n2. ______\n3. ______\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\n1. ______\n\n![Image](https://github.com/user-attachments/assets/bd37fb2d-e6f0-4947-aff1-00316e22edf9)\n\n2. ______\n3. ______\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [ ] Screenshots\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-04-01T13:23:28Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Needs: triage :mag:",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "junaid042",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #3798\n- #466\n- #4007\n- #4185\n- #3046\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nHi @DarranShepherd and @demyte, this is a known issue, we have an internal bug item 8549174 to track this. We will inform you when any updates, thanks.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3798#issuecomment-1823846344\n### Solution 2:\nMigth be the same issue as #3843. Maybe the same workaround works for you.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3798#issuecomment-1823894721\n### Solution 3:\nHi all, We have fixed this issue, could you please verify this issue? Remember to clear the wef cache before you try it.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3798#issuecomment-1842418835\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-04-01T13:24:18Z"
      },
      {
        "author": "junaid042",
        "body": "On Excel web it is working ",
        "created_at": "2025-04-01T13:28:22Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi @junaid042 ,\n\nThank you for reporting the issue. I tested the custom functions in the latest version. It works well. From the screenshot you provided,  the formula bar show \"=Add\". I think that's not the correct usage of custom function. It should be like below:\n\n![Image](https://github.com/user-attachments/assets/8e3081d1-18dd-4d50-9710-9c16f0f9d434)\nDoes it make sense to you?",
        "created_at": "2025-04-02T06:43:15Z"
      },
      {
        "author": "junaid042",
        "body": "Hi @penglongzhaochina, thanks! But why do we need to type the full formula when selecting from the dropdown? On the web, it works correctly—when selecting from the dropdown and pressing Enter, it prompts for parameters. However, on the desktop, it gives a NAME error. Any idea why this is happening?\n\nweb:\n![Image](https://github.com/user-attachments/assets/9d2f1d0b-f76b-457b-ad3b-5c7e1a3f7d5d)\n\ndesktop:\n\n![Image](https://github.com/user-attachments/assets/913bdff3-d860-4aef-8024-d7b66eb3408c)",
        "created_at": "2025-04-02T08:39:01Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi @junaid042 ,\n\nPlease use 'tab' not use 'enter' on the desktop. It's the difference between the desktop and web. Thanks.",
        "created_at": "2025-04-02T09:03:32Z"
      },
      {
        "author": "junaid042",
        "body": "@penglongzhaochina  Thanks!",
        "created_at": "2025-04-02T09:54:55Z"
      }
    ]
  },
  {
    "number": 5554,
    "title": "Handle send anyway and don't send buttons",
    "body": "![Image](https://github.com/user-attachments/assets/e836eceb-8da1-4f8f-a2ae-8b0d6575cc68)\n\nHi guys, I have a question relating the smart alerts popup buttons handling. Our add-in strongly depends on knowing whether an email was sent or not, and we managed to find a way to handle the \"send anyway\" button on our backend, although not ideal.\n\nIn the latest Microsoft update, we also saw that now there would be the \"don't send\" button explicitly added to the smart alerts pop-up, and we are not sure on how we can handle this - including the X button on the pop-up.\n\nGeneral questions\n1. Is there a way to handle (or be able to determine which button was clicked on the next add-in execution) any of the following buttons:\n- \"Send anyway\"\n- \"Don't send\" when overridden\n- \"X button\"\n\n2. Can the don't send button be removed somehow if it's overridden?\n\nThanks for the info.",
    "created_at": "2025-04-01T12:18:48Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Outlook",
      "Type: product question"
    ],
    "author": "NikolaCen",
    "comments": [
      {
        "author": "alexm-plutoflume",
        "body": "Just commenting to say that I agree that knowing if an email was sent or not in response to a prompt is an important feature of OnSend add-ins. The old ItemSend version of these Add-ins was a lot more flexible in that we controlled the dialog box and could run our own code if a user selected Don't Send or Send.\n\nWith Smart Alerts we are unable to run any code when a user selects \"Send anyway\" or \"Don't Send\" or clicks \"X\", making it challenging to determine if the user sent or did not send the email in response to the prompt.\n\nIt would be helpful if MSFT provided some method of doing this.",
        "created_at": "2025-04-01T16:18:58Z"
      },
      {
        "author": "preethikakiru",
        "body": "Hello @NikolaCen, \nThanks for asking your question, @exextoc will be able to help you further!\nBest, \nPreethika",
        "created_at": "2025-04-03T21:11:14Z"
      },
      {
        "author": "NikolaCen",
        "body": "Hi guys, any updates here? @exextoc ",
        "created_at": "2025-04-17T13:39:05Z"
      },
      {
        "author": "NikolaCen",
        "body": "Hi guys again, we plan on going to production very soon with smart alerts, it would be nice if we evaluate other options if there are any. Can we get any feedback here? @exextoc ",
        "created_at": "2025-04-29T07:13:53Z"
      },
      {
        "author": "NikolaCen",
        "body": "Hi guys, any updates here? @exextoc",
        "created_at": "2025-05-09T12:42:53Z"
      },
      {
        "author": "millerds",
        "body": "That dialog is shown after the add-in event has completed so handling on the button clicks isn't currently possible.  \n\nWe track Outlook add-in feature requests on our [Tech Community Page](http://aka.ms/M365dev-suggestions). Please submit your request there and choose the appropriate label(s). Feature requests on Tech Community are considered, when we go through our planning process.",
        "created_at": "2025-05-09T16:32:20Z"
      }
    ]
  },
  {
    "number": 5552,
    "title": "Question: How to Handle Inline Images When Sending Email with Multiple Inline Pictures via Graph API?",
    "body": "❓ Question: How to Handle Inline Images When Sending Email with Multiple Inline Pictures via Graph API?\n\nWe’re facing an issue when sending emails that contain inline images in Outlook.\n\n🖼️ Behavior Observed in Compose Mode:\n\t•\tWhen inserting one inline image, Outlook often embeds it as a base64 string directly into the email body (<img src=\"data:image/png;base64,...\">).\n\t•\tHowever, when inserting two or more inline images:\n\t•\tThe first image is still embedded as base64.\n\t•\tThe subsequent images are added as attachments and referenced using a CID in the HTML (e.g., originalsrc=\"cid:xyz\").\n\t•\tThese CID-based images do not include any identifying information like name or contentId in the Office.js attachment metadata.\n\n🧨 The Problem:\n\nWhen sending the email via our Graph API-based backend, we cannot correctly map the inline images to their corresponding contentIds because:\n\t•\tOutlook does not expose metadata (name, id, contentId) for the CID-style inline images beyond the first one.\n\t•\tTherefore, we cannot properly set isInline: true and contentId in the Graph API payload.\n\n⸻\n\n🔍 Our Question:\n\nHow can we reliably send emails with multiple inline images inserted in the Outlook compose window?\nIs there a supported way to:\n\t•\tAccess metadata for all inline images (including those referenced via CID)?\n\t•\tEnsure we can correctly set contentId when passing attachments to the Graph API?\n\n⸻\n\nAny insights or best practices would be greatly appreciated!",
    "created_at": "2025-03-31T08:28:58Z",
    "state": "closed",
    "labels": [
      "Area: Outlook"
    ],
    "author": "thanhtungka91",
    "comments": [
      {
        "author": "kumarshrey-msft",
        "body": "Hi @thanhtungka91,\n\nThis forum is limited to supporting office-js apis. For any MS API Graph specific queries and support, please explore options available at [Microsoft Graph Dev Center | APIs and app development](https://developer.microsoft.com/en-us/graph)",
        "created_at": "2025-03-31T08:39:02Z"
      },
      {
        "author": "thanhtungka91",
        "body": "This issue is not limited to Microsoft Graph API. We’re also trying to confirm whether Office.js (Outlook Add-in API) provides any method or access point to retrieve metadata or content of inline images—especially those inserted in compose mode and referenced via cid.\n\nIn particular, we’re looking for a way to:\n\t•\tDetect all inline images inserted by the user.\n\t•\tRetrieve enough information (e.g., contentId, name, or attachment ID) so we can handle them correctly when sending the email via our backend using Microsoft Graph API.\n\nWe would appreciate if this ticket remains open while we investigate this issue. Any guidance or clarification on accessing inline image data from Office.js would be extremely helpful.",
        "created_at": "2025-03-31T08:43:46Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "You can use a combination of [getattachmentsasync](https://learn.microsoft.com/en-us/javascript/api/outlook/office.messagecompose?view=outlook-js-preview#outlook-office-messagecompose-getattachmentsasync-member(1)) and [getattachmentcontentasync](https://learn.microsoft.com/en-us/javascript/api/outlook/office.messagecompose?view=outlook-js-preview#outlook-office-messagecompose-getattachmentcontentasync-member(1)) APIs to gather more details of the attachments. In particular, we expose the `isInLine` property as part of the response, read more about other such properties [here](https://learn.microsoft.com/en-us/javascript/api/outlook/office.attachmentdetailscompose?view=outlook-js-preview). Let me know if this works for you.",
        "created_at": "2025-03-31T08:52:22Z"
      }
    ]
  },
  {
    "number": 5551,
    "title": "How to Delete Draft and Close Compose Window in Outlook Add-in After Sending via Microsoft Graph API?",
    "body": "Question: How to Delete Draft and Close Compose Window in Outlook Add-in After Sending via Microsoft Graph API?\n\nWe’re building an Outlook Add-in and have the following workflow:\n\t1.\tIn compose mode, we extract the email content: To, Cc, Subject, and Body using Office.js APIs.\n\t2.\tWe send this data to our backend, which uses the Microsoft Graph API to send the email (/me/sendMail).\n\t3.\tAfter a successful send, we try to:\n\t•\tClose the compose window using Office.context.mailbox.item.close()\n\t•\tDelete the corresponding draft using Graph API (/me/mailFolders/Drafts/messages)\n\n⸻\n\n🧨 The Problem:\n\nEven after we delete the draft message using Graph API, Outlook sometimes creates or keeps a new draft in the Drafts folder. This seems to happen after we’ve sent the email via Graph API while still in compose mode.\n\nIt appears Outlook auto-saves the draft again, even though the message was already sent externally.\n\n⸻\n\n❓Our Question:\n\t•\tIs there a reliable way to close the current compose window and prevent Outlook from saving a new draft after we’ve already sent the message using Graph API?\n\t•\tAlternatively, is there a supported way to detect and delete the latest compose draft cleanly without race conditions?\n\nWe understand that onMessageSendHandler is only supported in Outlook Web, so it’s not an option for Outlook Desktop at this time.",
    "created_at": "2025-03-31T08:23:02Z",
    "state": "closed",
    "labels": [
      "Area: Outlook"
    ],
    "author": "thanhtungka91",
    "comments": [
      {
        "author": "kumarshrey-msft",
        "body": "Hi @thanhtungka91 ,\n\nYou can try the [item.closeAsync](https://learn.microsoft.com/en-us/javascript/api/outlook/office.messagecompose?view=outlook-js-preview#outlook-office-messagecompose-closeasync-member(1)) API for achieving the same. Additionally, you can keep the `discardItem` property as true if you wish to directly delete the item without prompting the user to discard unsaved changes. Let me know if this works for you.",
        "created_at": "2025-03-31T11:48:44Z"
      },
      {
        "author": "thanhtungka91",
        "body": "@kumarshrey-msft \nthank you so much, it works perfect, you can close the ticket!!! ",
        "created_at": "2025-03-31T12:31:40Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Glad to hear that! Closing the issue",
        "created_at": "2025-03-31T12:37:43Z"
      },
      {
        "author": "thanhtungka91",
        "body": "\n@kumarshrey-msft \nSorry for reopening the ticket. The feature works perfectly on the web version but doesn’t work in the Outlook app on Mac. Do you have any ideas on what might be causing this?\n\n<img width=\"644\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/50311682-5609-40f6-b2de-ec9f3a3b4e2d\" />",
        "created_at": "2025-04-11T06:57:07Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @thanhtungka91, the support for this API is gradually being rolled out on Outlook Mac. However, we don't have timelines to share at this point of time.",
        "created_at": "2025-04-11T07:23:19Z"
      },
      {
        "author": "thanhtungka91",
        "body": "thank you for sharing, hope it will be available for mac soon!! ",
        "created_at": "2025-04-15T07:46:05Z"
      }
    ]
  },
  {
    "number": 5546,
    "title": "Outlook Categories",
    "body": "I add categories to the email but Outlook Client receives them, but it doesn't show me the categories in the email.\n\nHow can I force the update?",
    "created_at": "2025-03-28T09:52:35Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "CodeCube0",
    "comments": [
      {
        "author": "kumarshrey-msft",
        "body": "Hi @CodeCube0 , \n\nCould you please follow this [template](https://github.com/OfficeDev/office-js/blob/release/.github/ISSUE_TEMPLATE/bug_report.md) and provide additional details, such as the scenario and platform?\n\nIn the meantime, you can refer this [public doc](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/categories), which outlines add-in capabilities related to categories.",
        "created_at": "2025-03-31T12:07:01Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-04T14:43:48Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-07T16:35:03Z"
      }
    ]
  },
  {
    "number": 5544,
    "title": "What to do next with Excel Web Add-in code ?",
    "body": "Hi,\n\n\n\nOn Visual Studio 2022 version 17.11.2, I created an Excel web add-in in C#. I need this type of add-in as I plan to use it on Android and IOS.\n\nI finally got the code that does what I wanted to achieve : a simple button that moves data inside the same workbook (data is not stocked somewhere, data is moved between sheets). I tested it several times, and now this is fine for me and ready.\n\nRegarding the whole Visual Studio project, compared to a new project, code modifications are present in Home.html and Home.js files only.\n\nThe final goal is having the add-in in a folder (in local or on the network), and then, I install the add-in by selecting the file for each device that needs it.\n\n\n\nNow, next step to use what I created is completely unclear.\n\nI asked AI which told me to put my code in notepad to create an .xml, .html and .js files, then open the .xml file. I did it, and this is not working.\n\nI read that I can publish the add-in, so I went in Build, then Publish:\n\n- I tried with microsoft profile, then I arrive on Azure, I don't know what to do next on Azure;\n\n- I tried a local profile, then deployment. I receive the error that Web Publishing extension is not installed, got to https://go.microsoft/fwlink/?LinkID=208120. I download the most recent file on the website, then it tells me to download something else whereas files were not installed, I suspect that the files to install are to old for my Visual Studio version.\n\n\n\nI would like to know what to do to use what I created.\n\n\n\nThank you for your help\n",
    "created_at": "2025-03-27T17:00:55Z",
    "state": "closed",
    "labels": [
      "Type: product question",
      "Area: DevX",
      "Resolution: question answered"
    ],
    "author": "MickaTahiti",
    "comments": [
      {
        "author": "AlexJerabek",
        "body": "Hi @MickaTahiti,\n\nThank you for your question. The instructions for how to publish an Office Add-in through Visual Studio are found here: https://learn.microsoft.com/office/dev/add-ins/publish/package-your-add-in-using-visual-studio.\n\nYou can also find an overview of your publishing and deployment options here: https://learn.microsoft.com/office/dev/add-ins/publish/publish.\n\nSince this repo is for product bugs, I'm going to close your issue. If you encounter any problems with the documentation, please open a new GitHub issue in the [docs repo](https://learn.microsoft.com/office/dev/add-ins/publish/publish) or use the feedback control at the bottom of the documentation page. You can also use [Stack Overflow](https://stackoverflow.com/questions/tagged/office-js) to ask \"how-to\" questions.",
        "created_at": "2025-03-27T17:34:12Z"
      }
    ]
  },
  {
    "number": 5543,
    "title": "Outlook classic duplicates signatures on deferred delivery emails",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC desktop\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Office version number: Version 2502 (Build 18526.20070)\n* Operating System: Windows\n* Browser (if using Office on the web): N/A\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\n\nIn classic Outlook, when a deferred delivery email is edited, any signature set using `Office.context.mailbox.item.body.setSignatureAsync` is duplicated instead of replaced. I would expect that a call to this function would replace the current set signature like it does in normal compose window, but it adds a new one.\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\n\nFunction `setSignatureAsync` always adds a new signature when opening a deferred delivery email.\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. Have an add-in that sets a signature using `setSignatureAsync`\n2. Compose an email and set a signature\n3. Use Delay Delivery feature and send the email. It will land in the Outbox\n4. Open the email in the outbox\n5. Set a signature using `setSignatureAsync`\n6. Signature is appended to the email. \nAt this point, you can repeatedly click send and reopen the email. The signatures will keep getting appended\n\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\n\nOWA and new Outlook does not allow editing deferred delivery emails, so those clients are not affected\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [ ] Screenshots\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-03-27T16:57:10Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Resolution: duplicate",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "dariussantaras",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #4301\n- #5483\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nThanks @MrDaleQ for reporting this issue we are tracking internally with bug 4450759.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4301#issuecomment-2028441960\n### Solution 2:\nNative signatures are also appended and not replaced across clients (web/mac/classic), so this behavior is not governed/controlled by the setSignatureAsync office.js API. Irrespective of whether the setSignatureAsync API is used or not, the same behavior can be observed. This forum is limited to office-js related issues. For Outlook specific queries and support please post your questions here- https://support.microsoft.com/home/contact.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5483#issuecomment-2732833121\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-27T16:57:44Z"
      }
    ]
  },
  {
    "number": 5542,
    "title": "Calendar events and emails intermittently hang after user clicked send button",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\nUsers are reporting that they are unable to send calendar invites intermittently. When attempting to send, the \"Send\" button remains greyed out and unresponsive, preventing the action from being completed. This issue persists across multiple sessions and devices, with no clear workaround available. This bug is causing significant frustration among our customer base.\nUsers has an add-in with `OnSendItem` event installed for their mailboxes.\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Outlook 365\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Office version number: ______\n* Operating System: ______\n* Browser (if using Office on the web): Chrome\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nCalendar event or an email is sent successfully \n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nMessage is stuck, send button is grey. There is no notification \"[Add-in] is working on your requests\"\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n- Create a new calendar event\n- Add recipients\n- Click the \"Send\" button\n- Observe that the button is grey and event is not send\n\n## Link to live example(s)\n<!--- Ideally, provide a link to a live example, created and shared using -->\n<!--- [Script Lab](https://aka.ms/scriptlab). If relevant, create two buttons, -->\n<!--- one that sets up data in the document, and another that exemplifies the issue. -->\n1. ______\n2. ______\n3. ______\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\n1. ______\n2. ______\n3. ______\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\n\n![Image](https://github.com/user-attachments/assets/2bded067-b8ad-4000-9982-9bbf6d2e31d5)\n![Image](https://github.com/user-attachments/assets/529df501-3c31-42f6-b246-513118aae731)\n![Image](https://github.com/user-attachments/assets/a103fda9-62e1-473d-a075-e2b67fb6cbbe)\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [ ] Screenshots\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-03-27T16:11:37Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Status: fixed",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "manaunl",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #5490\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nThere seems to be a recent update to Office (Outlook) which is causing the issue. Disabling the add-in allows Outlook to function normally without freezing.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5490#issuecomment-2731305256\n- https://github.com/officedev/office-js/issues/5490#issuecomment-2735024935\n### Solution 2:\nBy any chance is user using the 'Esc' key to close the dialog? (there is a bug where the 'Esc' key will NOT dialogCloseCallback and as a result, you probably never call event.completed())... a fix for this is in the process of being rolled out and backported.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/5490#issuecomment-2735016730\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-27T16:12:12Z"
      },
      {
        "author": "rajjha-msft",
        "body": "Hey @manaunl \n\nCan you please share a repro video and attach the logs ?\nYou can follow this to collect logs : https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues\n\nYou can create a repro and share it with @exextoc ",
        "created_at": "2025-03-28T09:14:40Z"
      },
      {
        "author": "manaunl",
        "body": "@rajjha-msft @exextoc I’ve created a repo with logs and videos.\n\nI’d also like to add that at one point, I was able to consistently reproduce the issue in a single browser tab. However, when opening another tab, the issue did not occur there.\n\nAdditionally, after waiting for about 5 minutes, I received the following notification: \"The add-in [name] has prevented this item from being sent.\"\nThis message is extremely misleading notification for end users, as there’s no add-in actually interacting with the item at that point.",
        "created_at": "2025-03-28T10:46:11Z"
      },
      {
        "author": "MatthewLowden",
        "body": "Hi @exextoc , @rajjha-msft ,\nThis appears to be another failed change causing a regression. We are receiving reports of this issue from an increasing number of customers over the last 5 days. Please could you stop the roll out of this failed change and revert?",
        "created_at": "2025-03-31T13:50:50Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @manaunl , @MatthewLowden ,\n\nThe 5 minute wait + intermittent nature of this bug seems to suggest your add-in might be running into time out scenario. If the user has multiple add-ins that subscribe to the same event, the Outlook platform launches the add-ins in no particular order and only five event-based add-ins can be actively running. You can read more about the limitations [here](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/autolaunch#event-based-activation-behavior-and-limitations).\n\nCan you please confirm if all the launch events of your add-in are successfully calling `event.completed` method to signal that your add-in has completed processing the respective launch event? \n",
        "created_at": "2025-03-31T18:01:52Z"
      },
      {
        "author": "manaunl",
        "body": "Hi @kumarshrey-msft, did you actually read the description of the issue, or even bother watching the video I uploaded to the repo or opening the HAR file?\n\nIt is explicitly stated that nothing happens when the user clicks 'Send'—no execution, no UI feedback, no notification that the add-in is doing anything. **The add-in is not running.** The button just turns grey, and that’s it. There’s zero activity in the network tab and no errors in the console logs after clicking 'Send'.\n\nThere is only one add-in in the mailbox and we’ve made no changes on our end, this is a regression on your side. Stop wasting time, fix your broken application and implement at least some regression testing.\n\nhttps://github.com/user-attachments/assets/8b6c0c4b-a97a-4350-9385-b234f70356cf",
        "created_at": "2025-03-31T19:36:14Z"
      },
      {
        "author": "mmanjaree-msft",
        "body": "@manaunl Could you please share the logs again https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues. The issue is not reproable at our end and the logs shared do not have the information we require to investigate. Please make sure log capture starts before loading outlook web and stops after timeout.",
        "created_at": "2025-04-01T05:18:22Z"
      },
      {
        "author": "manaunl",
        "body": "@mmanjaree-msft I’ve pushed a new commit that includes logs captured before Outlook starts loading and stops after the timeout occurs. I’ve also added a video recorded during the same time the logs were captured, the video is trimmed to the moment of reproduction.",
        "created_at": "2025-04-01T08:11:09Z"
      },
      {
        "author": "manaunl",
        "body": "@exextoc Sorry, I miss clicked the button. Can you please re-open the issue",
        "created_at": "2025-04-02T08:46:57Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @manaunl, @MatthewLowden,\n\nFirstly thanks a lot for sharing the details, it greatly helped us during debugging. We were able to repro the scenario and observed this issue is same as #5533. \n\nThe fix for the same has been checked-in already and is being rolled out. We will update the thread once it reaches 100% prod.",
        "created_at": "2025-04-02T12:48:43Z"
      },
      {
        "author": "MatthewLowden",
        "body": "Hi @kumarshrey-msft ,\nThank you for the update, and for addressing this regression.\nPlease could you share a postmortem for this incident?\nThanks!",
        "created_at": "2025-04-02T19:52:21Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @MatthewLowden,\n\nThis was an intermittent issue impacting Launch event add-ins in general. The fix is gradually being rolled out. In the meantime, can you kindly confirm if you can still repro the bug?",
        "created_at": "2025-04-03T14:13:17Z"
      },
      {
        "author": "MatthewLowden",
        "body": "Hi @kumarshrey-msft ,\nThank you for your response.\nI understand that the fix for this regression is being incrementally rolled out in production.\nI was hoping for more details on how this regression made it to production undetected, and how you plan to prevent a similar regression in future.\nWe see a high number of regressions from Microsoft in production updates to Outlook Online / New Outlook, which would indicate that your change management and testing for this product needs significant improvement.\nPlease could you share details on what went wrong that led to this regression making it to production, what your learnings are, and the measures that you will take to reduce the chance of introducing regressions in future production updates?",
        "created_at": "2025-04-03T18:57:43Z"
      },
      {
        "author": "MatthewLowden",
        "body": "@kumarshrey-msft - I forgot to add - Yes I can currently still reproduce the defect. I assume that the production roll-out has not yet reached my main account.",
        "created_at": "2025-04-03T20:20:33Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "@MatthewLowden We will shortly share an RCA with you, in the meantime can you please refresh your Outlook session? If the issue still persists, will it be possible for you to share the logs again following this [wiki](https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues)?",
        "created_at": "2025-04-04T05:29:24Z"
      },
      {
        "author": "MatthewLowden",
        "body": "Today I tried to reproduce the issue, and no longer can.\n@kumarshrey-msft - can you confirm whether the fix is now fully rolled out in production?",
        "created_at": "2025-04-07T13:23:43Z"
      },
      {
        "author": "MatthewLowden",
        "body": "@kumarshrey-msft @exextoc - Please can you confirm whether the fix is now fully rolled out in production, and please could you also share the RCA/Postmortem in this thread?",
        "created_at": "2025-04-09T07:44:23Z"
      },
      {
        "author": "mmanjaree-msft",
        "body": "@MatthewLowden The fix has been fully rolled out. We will get back with RCA soon",
        "created_at": "2025-04-09T10:30:24Z"
      },
      {
        "author": "mmanjaree-msft",
        "body": "@manaunl  @MatthewLowden We identified the root cause of the issue, which stemmed from a property that was never expected to be undefined. However, due to an unexpected condition, it returned undefined, leading to an uncaught exception during launch events. Since the system wasn’t designed to handle this scenario, it caused the add-in to fail on launch.\nOur team has addressed the underlying issue by implementing proper handling for this edge case. The fix has been rolled out, and the impacted functionality should now be restored.\nWe’ve verified the deployment and are closely monitoring for stability. If you continue to encounter issues, please restart Outlook and feel free to reach out.",
        "created_at": "2025-04-09T10:43:36Z"
      },
      {
        "author": "MatthewLowden",
        "body": "Thank you for the update, and for the RCA summary.",
        "created_at": "2025-04-09T17:27:09Z"
      }
    ]
  },
  {
    "number": 5541,
    "title": "Reopening a popped out email in drafts causes email to hang when onSendEnabled = true",
    "body": "When a user pops out an email draft into a separate window, then closes it and attempts to reopen the same draft from the drafts folder, the email interface hangs indefinitely.\n\n\n* Platform: New Outlook, OWA \n* Production\n* Office version number: \nNew Outlook version = Microsoft Outlook Version: 1.2025.319.100 (Production) / Client Version: 20250314002.14\nOWA = 20250314002.14\n\n\n## Expected behavior\nGoing off MAC Outlooks behaviour you are able to resume editing when the email is in drafts whilst processing\n\n\n## Current behavior\nThe email sending process hangs indefinitely and the email is not sent.\n\n\n## Steps to reproduce\n\n1. Create a new email \n2. Popout the email and create a \"prompt\" scenario (i.e. DLP) \n3. Send the email and while it processes go to drafts and reopen the window\n4. This will open the email that is currently processing and shut the pop-up window hanging the window\n\nNot sure if this error message is related\n\n![Image](https://github.com/user-attachments/assets/71edefaf-25b3-44b6-b6f2-948e7518012c)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-03-27T14:21:58Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Resolution: duplicate"
    ],
    "author": "asavage13",
    "comments": [
      {
        "author": "rajjha-msft",
        "body": "Hey @asavage13 \n\nCan you share a repro video for OWA ? We are not able to reproduce the issue.",
        "created_at": "2025-03-28T09:30:27Z"
      },
      {
        "author": "dmitriikashin-outreach",
        "body": "could be related (same error)\n\nhttps://github.com/OfficeDev/office-js/issues/5533\n\nfast compose opening short after Outlook init triggers this error and brings event-based Add-ins to unrecoverable state (easily reproducible, examples shared in the linked issue)\n\nTo be more presize, as soon as you **interrupt**  --first--  (after Outlook start, or after some delay in usage) compose loading navigating away from it to either another draft, or new window, or just to inbox (basically, just interrupt it) - you get into this state. I believe the error implies \"hey we couldn't fetched the Add-in ID\", but each next compose attempt will be stuck as Outlook will expect the Add-in to do something, but can't start it because of the missing and unfetched id.\n\nhttps://outreach.zoom.us/clips/share/JZ2VrJD6RrSYCQQqsdUx_w",
        "created_at": "2025-03-28T14:20:20Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @asavage13 , \n\nAs @dmitriikashin-outreach mentioned, this appears to be a manifestation of #5533. Therefore, we are marking this as duplicate. You can continue to follow #5533 for future updates. Feel free to reopen the bug if you believe this is a separate issue.",
        "created_at": "2025-04-01T11:38:55Z"
      }
    ]
  },
  {
    "number": 5538,
    "title": "Set Signature not working properly - Forward",
    "body": "Hi,\nWith my team we are working on a Outlook signature add-in.\nOur addin adds a signature when the user creates a new message/meeting or on reply/forward.\n\n## Your Environment\nPlatform [PC desktop, Mac, iOS, Office on the web]: PC desktop\nHost [Excel, Word, PowerPoint, etc.]: New Outlook\nOffice version number: 1.2025.319.100 (Production).\nOperating System: Windows 11 Enterprise (OS build: 22621.4890)\n\n## Current behavior\n- The signature goes to the bottom of the chain when the user forwards an email. This doesn't happen for all emails, and I don't know all the conditions that trigger this bug. Note that it occurs every time the forwarded email contains a SharePoint link.\n\n\n## Steps to reproduce\n1. Forward an email that contains a SharePoint link.\n2. The signature is inserted at the \"bottom\"\n\n## Link to live example(s)\nI can reproduce this bug with your sample [outlook-set-signature](https://github.com/OfficeDev/Office-Add-in-samples/tree/main/Samples/outlook-set-signature).\n![Image](https://github.com/user-attachments/assets/73761fd1-e4fd-456a-80b5-dc6a719262ff)\n\nI hope you can resolve this issue, as it affects our clients and gives a negative impression of our product.\nIf you need more information, I'm available.\n\nHave a nice day !",
    "created_at": "2025-03-26T10:26:28Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Status: fixed"
    ],
    "author": "touss59",
    "comments": [
      {
        "author": "kumarshrey-msft",
        "body": "Hi @touss59,\n\nThank you for reporting the issue, we've put it in our backlog. Unfortunately, we do not have any timelines to share at this point.\n\nInternal tracking Id : 5580128",
        "created_at": "2025-03-27T09:53:58Z"
      },
      {
        "author": "bogdanst24",
        "body": "We are also seeing this issue. And it doesn't seem to need a Sharepoint URL. We can reproduce it in New Outlook, with any of Reply/Forward, when the email has a calendar object inside",
        "created_at": "2025-04-03T11:53:19Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @bogdanst24 ,\n\nYes, from our analysis we can confirm this issue is not specific only for mails containing Sharepoint URL The fix for the same has been checked-in already and is being rolled out gradually. We will update the thread once it reaches 100% prod.",
        "created_at": "2025-04-03T13:22:17Z"
      },
      {
        "author": "mmanjaree-msft",
        "body": "@bogdanst24 the issue has been rolled out. Can you refresh/reload outlook and confirm if the issue is resolved",
        "created_at": "2025-04-08T07:19:36Z"
      },
      {
        "author": "bogdanst24",
        "body": "Only partially fixed I would say. It looks like if you wait until the signature is inserted (event-based add-in calling addSignatureAsync) - which could be up to 10 seconds when there is no cache - then it is inserted in the right place.\nHowever, if you move your cursor before, it would insert the signature what seems to be in the next paragraph after the cursor",
        "created_at": "2025-04-14T09:14:37Z"
      },
      {
        "author": "touss59",
        "body": "It seems to work, thx !",
        "created_at": "2025-04-18T13:59:34Z"
      },
      {
        "author": "martinguenther",
        "body": "I can confirm @bogdanst24 observation:\n\n> However, if you move your cursor before, it would insert the signature what seems to be in the next paragraph after the cursor\n\nWe can even reproduce this when triggering the insert from the task pane add-in. And also using Outlook's own signature feature.\nThe signature is insered after the cursor position. \n\nHere an example of Outlook Online with Outlook's signature. Reply to an email, move the cursor, then insert the signature.\n\n![Image](https://github.com/user-attachments/assets/76b1ea51-99b4-4e08-a8d4-0020b1e40407)\n\nCan you reopen this issue, or shall I create a new one?",
        "created_at": "2025-05-07T08:02:20Z"
      }
    ]
  },
  {
    "number": 5533,
    "title": "\"Cannot read properties of undefined (reading 'sourceId')\" breaks Event-based Add-ins during whole session",
    "body": "## Your Environment\n\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC desktop, Office on the web\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Office version number: -\n* Operating System: -\n* Browser (if using Office on the web): -\n \n## Expected behavior\n- Event-based activation of the Add-ins is stable and doesn't go to unrecoverable state after accidental error\n- The error, regardless of its nature, is gracefully surfaced instead of blocking third party experiences during whole session\n\n## Current behavior\n- Eventually, as part of routine emailing in the Outlook client, the \"Cannot read properties of undefined (reading 'sourceId')\" appears in the console and Event-based activation of the Add-in stops working. As result of it, \"Add-in X is working on your request\" is displayed on every \"Send\" button click if user has one or more Add-ins that leverage \"OnMessageSend\". The only recovery is to reopen the Outlook client. The issue was reproduced in OWA by our customers, in New Outlook for Windows internally, has sporadical nature. \n\n## Steps to reproduce\n- Keep composing emails in the OWA/New Outlook for Windows until the error pops up in the console; Since this very moment, the state is unrecoverable, and Event-based Add-ins are not activated.   \n\n\nInitially, we saw this error when the Network connection is quickly established (https://github.com/OfficeDev/office-js/issues/5527 ), but **I was able to get the repro even with stable internet connection.** \n\n\nUnfortunately, I wasn't able to grab the **full** HAR, as DevTools on New Windows client froze as soon as I clicked on the export of it. Considering sporadical nature of the issue, it can take some time before we get the entire associated HAR and will be able to reproduce it internally again. Sharing \"partial\" export if that is of any use. However, the only console error I got was this one, and we saw it before on the calls with customers:\n\n\n![Image](https://github.com/user-attachments/assets/2aa5f699-510c-40d6-8519-6aa5237f537a)\n\nI hope it's enough to at least prevent unrecoverable state for the whole session and surface error in any other way. \n\n## Context\n\n- Users seeing \"consistent\" \"Add-in X is taking longer than expected\" popup and report it to our support.  \n- Only restart of the whole Outlook helps to resolve the issue\n\n## Useful logs\n- [Partial HAR](https://github.com/dmitriikashin-outreach/Outlook-Add-in-troubleshooting/blob/main/Partial%20HAR%20prior%20to%20sourceId%20error.har)\n- [Console logs (OWA)](https://github.com/dmitriikashin-outreach/Outlook-Add-in-troubleshooting/blob/main/README.md#logs-2)\n- Repro video https://github.com/dmitriikashin-outreach/Outlook-Add-in-troubleshooting?tab=readme-ov-file#repro-2\n- HAR from the repro video https://github.com/dmitriikashin-outreach/Outlook-Add-in-troubleshooting/blob/main/outlook.office.com-Ben.har\n\n",
    "created_at": "2025-03-25T13:44:48Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Status: fixed",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "dmitriikashin-outreach",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #3709\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nA fix has been rolled out 100% for Outlook on the Web. Please let us know if you are still facing the issue.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3709#issuecomment-1767820421\n### Solution 2:\nJust finished testing and could not reproduce it on Outlook web. Was the fix also rolled out on Windows Client? So we start testing that as well.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3709#issuecomment-1768098454\n### Solution 3:\nIssue looks like it has been fixed. Ticket can be closed.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3709#issuecomment-1798044198\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-25T13:53:06Z"
      },
      {
        "author": "dmitriikashin-outreach",
        "body": "The issue mentioned above indeed has some similarities, but the error is different and is active",
        "created_at": "2025-03-25T14:27:09Z"
      },
      {
        "author": "rajjha-msft",
        "body": "Hey @dmitriikashin-outreach \n\nJust to understand better, how frequently is this happening ?\nDoes this repro all the time, even with good internet connectivity ?",
        "created_at": "2025-03-26T06:54:36Z"
      },
      {
        "author": "dmitriikashin-outreach",
        "body": "Hi @rajjha-msft \n\nJust got off a call with the customer which faced the same issue. We also got confirmation from internal users, and I was able to get the issue myself. \n\nSince I got it, I used the same workaround we suggest to our customers - restart Outlook client - and wasn't able to get it again within an hour, so I time scoped this effort.\n\n\nThis issue, similarly to [the suggested by github action](https://github.com/OfficeDev/office-js/issues/3709#issuecomment-1767820421), is happening randomly, after X emails sent (or compose windows open), or just sporadically based on the stability of MSFT servers, there are no clear steps to reproduce I'd be aware of.\n\n\nTo sump up:\n- It happens eventually. The more your use Outlook client (either web, or New Outlook for Windows), the higher probability is.\n- Once it happens, Outlook client goes to **unrecoverable** state. As soon as this error appears, users won't be able to send any email without seeing \"Add-in X is taking longer than expected\"\n- We see same error (`sourceId`) when we reproduce [this issue we reported](https://github.com/OfficeDev/office-js/issues/5527) so it can hint you the root cause.  Initially I thought it's related to the unstable network connection, but I was able to get into the faulty state even with stable connection, and our customers ensured us that their connection is very stable / fast enough. Which makes me think that some of the queries to Outlook BE can fail / return insufficient data for whatever reason during the session, and since then the whole experience is broken until Outlook is restarted. \n\nThis is also **a regression**, as it started ~1-2 weeks ago without any updates from our side, and Customers ensured us that before everything was working just fine.\n\nWe reported **3** issues in total, and the priority from user perspective is \n\n**High**:\n\n- this one\n- https://github.com/OfficeDev/office-js/issues/5527\n\nas both basically break Event-based Add-ins, and all users can do is to restart the Outlook client. This causes a lot of frustration to the customers and causes reputational loss to our Add-in. We also noted minor drop in usage (which is understandable as Add-ins aren't invoked once faulty state reached)\n\n\n**Low** (inconvenience, as state recovers once network connection is established, it's just bad / misleading UX when Network is down but Outlook is not in offline mode):\n\n- https://github.com/OfficeDev/office-js/issues/5531\n\n\nThank you for the help here, appreciate it\n\n\n\n\n",
        "created_at": "2025-03-26T09:18:40Z"
      },
      {
        "author": "dmitriikashin-outreach",
        "body": "Adding OWA logs for the same issue:\n\nhttps://github.com/dmitriikashin-outreach/Outlook-Add-in-troubleshooting/blob/main/README.md#logs-2\n\n",
        "created_at": "2025-03-26T11:39:05Z"
      },
      {
        "author": "dmitriikashin-outreach",
        "body": "Adding repro video + har from internal user:\n\nhttps://github.com/dmitriikashin-outreach/Outlook-Add-in-troubleshooting?tab=readme-ov-file#repro-2\nhttps://github.com/dmitriikashin-outreach/Outlook-Add-in-troubleshooting/blob/main/outlook.office.com-Ben.har",
        "created_at": "2025-03-26T12:07:19Z"
      },
      {
        "author": "rajjha-msft",
        "body": "Thank you for the details @dmitriikashin-outreach.\nWe are trying to reproduce the issue at our end.",
        "created_at": "2025-03-27T16:27:21Z"
      },
      {
        "author": "rajjha-msft",
        "body": "Also, I cannot access the logs you've attached, can you please review the permissions.",
        "created_at": "2025-03-27T16:27:57Z"
      },
      {
        "author": "dmitriikashin-outreach",
        "body": "Hi @rajjha-msft \n\nGood news (well..the scope is bigger than we thought) \n\nI have a stable repro of it, with **stable** network connection, getting into unrecoverable state for all smart alert-based Add-ins for both OWA and New Outlook for Windows. \n\nEven though the error might appear under different scenarios as well (such as network backoff), I hope this repro will help you to fix it for all of them:\n\nSteps:\n\n1) Open Outlook \n2) Navigate to Drafts\n3) Pick any draft\n4) Quickly click on \"New email\" going away from the draft. Alternatively, quickly select another draft. \n5) That's it. From now, every email will be stuck with the \"Add-in X is taking longer than expected\", no Add-in Frames will be open. \n\nAlternatively\n\n1) Open Outlook \n2) Quick on new email several times (or navigate from one draft to another).\n3) that's it\n4) video https://outreach.zoom.us/clips/share/iZOsEGWmRB6whyz6GMqt8Q\n\n\n\n\nRepro details (log, har, video):\n\nhttps://github.com/dmitriikashin-outreach/Outlook-Add-in-troubleshooting/tree/main?tab=readme-ov-file#stable-repro-for-the-sourceid-issue \n\n\nQuick video without pi if anyone else is interested:\n\nhttps://outreach.zoom.us/clips/share/bU3YTOIuRYqsaIxovQoj7g\n\n\nLet me know if anything else is needed from our side. \n\nThank you",
        "created_at": "2025-03-28T08:11:40Z"
      },
      {
        "author": "dmitriikashin-outreach",
        "body": "The repro is even simpler, it's sufficient to interrupt the first (after app start, or after some delay?) compose, typically draft, going away from it. \n\nquite easy to misclick, go back and get into unrecoverable state :(  \n\nhttps://outreach.zoom.us/clips/share/JZ2VrJD6RrSYCQQqsdUx_w",
        "created_at": "2025-03-28T14:33:50Z"
      },
      {
        "author": "dmitriikashin-outreach",
        "body": "hi @rajjha-msft \n\nare there any updates on the issue? since it's easily reproducible we hope that the fix will be introduced soon, as we keep getting support requests and losing user base; \n\nthank you",
        "created_at": "2025-04-01T09:58:50Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @dmitriikashin-outreach ,\n\nThanks for reporting this issue, we have been able to reproduce it and it has been put on our backlog. We unfortunately have no timelines to share at this point. \n\nInternal tracking id: 5576575",
        "created_at": "2025-04-01T11:07:57Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @dmitriikashin-outreach ,\n\nWe have recently made a fix to mitigate the issue and it is gradually being rolled out. Can you please confirm if you can still repro the current bug? ",
        "created_at": "2025-04-03T06:13:58Z"
      },
      {
        "author": "dmitriikashin-outreach",
        "body": "Hi @kumarshrey-msft \n\nThank you for fixing this. \n\nI can't replicate `sourceId` issue anymore with the stable network connection, so I hope customers will be unstuck soon. \n\nHowever, this [issue](https://github.com/OfficeDev/office-js/issues/5527) and [this issue](https://github.com/OfficeDev/office-js/issues/5531) are still reproducible: \n\n- If I start composing an email with the network being down (which is possible in both OWA and New Outlook for Windows), and network **does** become available before I click on \"send\" button - I will see the \"Add-in X is taking longer than expected\" popup - seems to be OWA only.\n- If I start composing an email with the network being down, and network  **does not** become available when I hit send - I will see the \"Add-in X is taking longer than expected\" popup -  seems to be New Outlook for Windows only.\n\n\nBoth don't bring Outlook to unrecoverable state, and as soon as network is up the **next** compose will work fine.  Which makes it less prominent than `sourceId` issue. But still the popup blames our Add-in for inability to send an email, which is not true. Presence of this infinite popup so far is the most frustrating thing for our customers, and we want to make sure that they see it indeed only in the scenarios when our Add-in is indeed doing something for too long.\n\nThough these 2 aren't as urgent as `sourceId` bug, we hope to see eventual resolution as well. \n\nThank you!\n\n",
        "created_at": "2025-04-03T09:25:35Z"
      },
      {
        "author": "exextoc",
        "body": "Thanks @dmitriikashin-outreach for confirming the mitigation.\n\nRegarding #5527, we are viewing the flaky internet connection scenario holistically and have already put this in our backlog (Internal tracking id: Office: 5571422). I will re-open #5527 again in the meantime. \n\n ",
        "created_at": "2025-04-03T09:59:46Z"
      }
    ]
  },
  {
    "number": 5536,
    "title": "How to remove add-in keyboard shortcuts?",
    "body": "### Type of issue\n\nMissing information\n\n### Feedback\n\nIt's missing how to remove shortcuts or reset them.\n\nI'm on Excel for mac.\n\nGetting this when I use`ctrl+shift+o`\n![image](https://github.com/user-attachments/assets/a057b098-996a-4bcc-a7f4-079e179ec1a0)\n\n\nI have followed [this documentation](https://learn.microsoft.com/en-us/office/dev/add-ins/design/keyboard-shortcuts?tabs=jsonmanifest) and now I can't seem to get past this error no matter what\n\nI added this:\n\n```json\n{\n  \"actions\": [\n    {\n      \"id\": \"ShowTaskpane\",\n      \"type\": \"ExecuteFunction\",\n      \"name\": \"Show task pane\"\n    },\n    {\n      \"id\": \"HideTaskpane\",\n      \"type\": \"ExecuteFunction\",\n      \"name\": \"Hide task pane\"\n    }\n  ],\n  \"shortcuts\": [\n    {\n      \"action\": \"ShowTaskpane\",\n      \"key\": {\n        \"default\": \"Ctrl+Shift+O\",\n        \"mac\": \"Ctrl+Shift+O\",\n        \"web\": \"Ctrl+Shift+O\",\n        \"windows\": \"Ctrl+Shift+O\"\n      }\n    },\n    {\n      \"action\": \"HideTaskpane\",\n      \"key\": {\n        \"default\": \"Ctrl+Shift+H\",\n        \"mac\": \"Ctrl+Shift+H\",\n        \"web\": \"Ctrl+Shift+H\",\n        \"windows\": \"Ctrl+Shift+H\"\n      }\n    }\n  ]\n}\n```\n\nI tried\n\n```sh\noffice-addin-debugging stop manifest.xml\n```\n\nI have also tried quitting Excel and to clear the cache\n\n```sh\nrm -rf ~/Library/Containers/com.Microsoft.OsfWebHost/Data/**/* ~/Library/Containers/com.microsoft.Ex\ncel/Data/Documents/wef/**/*ga\n```\n\nBut nothing is working and I can't find anything online on how to reset the shortcuts!\n\nHow can I do this?\n\n### Page URL\n\nhttps://learn.microsoft.com/en-us/office/dev/add-ins/design/keyboard-shortcuts?tabs=jsonmanifest\n\n### Content source URL\n\nhttps://github.com/OfficeDev/office-js-docs-pr/blob/main/docs/design/keyboard-shortcuts.md\n\n### Author\n\n@o365devx\n\n### Document Id\n\n4973703e-1687-4f52-4718-8767aacf566c\n\n### Platform Id\n\n3fd02ba2-7df8-4f8c-e58f-d6333b88ef43",
    "created_at": "2025-03-25T10:04:38Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: add-in UI"
    ],
    "author": "abed-daloopa",
    "comments": [
      {
        "author": "AlexJerabek",
        "body": "Hi @abed-daloopa,\n\nThanks for reporting this. @Rick-Kirkham, are there any other uninstall steps that you can think of? If not, we should route this to the product team as a bug.",
        "created_at": "2025-03-25T19:00:37Z"
      },
      {
        "author": "Rick-Kirkham",
        "body": "@abed-daloopa Please see if the information in this article helps: [Remove a ghost add-in](https://learn.microsoft.com/en-us/office/dev/add-ins/testing/uninstall-add-in?tabs=windows#remove-a-ghost-add-in).",
        "created_at": "2025-03-25T21:01:51Z"
      },
      {
        "author": "abed-daloopa",
        "body": "Hey @Rick-Kirkham,\n\nThe documentation you shared, suggests to clear the cache and using this command, I'm able to completely remove the development add-in\n\n```sh\nrm -rf ~/Library/Containers/com.Microsoft.OsfWebHost/Data/ ~/Library/Containers/com.microsoft.Excel/Data/Documents/wef\n```\n\nI no longer see it in the ribbon or anywhere in Excel which is okay.\n\nHowever, this does not resolve my problem. It seems that the keyboard shortcut is still somehow associated with the removed add-in.\n\nAnd I'm still seeing this after pressing `ctrl+shift+h` or  `ctrl+shift+o`\n\n<img width=\"620\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/a342f352-700c-4320-bb33-12f2d7af2214\" />\n\n\nI see no way in Excel to check what this shortcut is mapped to and how to reset that.\n\nNote: I do have a production add-in (admin managed, also it has a different ID) that registers the same keyboard shortcut. But like I said, the shortcut seems to be associated with the removed add-in.\n\nIs there a way to check what a keyboard shortcut is mapped to on Excel for mac? And is there a way to configure/reset this?\n",
        "created_at": "2025-03-25T22:53:19Z"
      },
      {
        "author": "Rick-Kirkham",
        "body": "I will transfer this issue to the repo for bugs in the development platform.",
        "created_at": "2025-03-25T23:16:01Z"
      },
      {
        "author": "abed-daloopa",
        "body": "@Rick-Kirkham Appreciate it but no need. I just found out how to reset the keyboard shortcuts\n\nIt's documented [here](https://support.office.com/client/results?authtype=unknown&lcid=1033&locale=en-us&ns=MACEXCEL&syslcid=3072&uilcid=1033&version=90&helpid=74140)\n\n<img width=\"1261\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/9eb27255-2b33-4e37-abd6-95ece6c18cf8\" />\n\nIt's also mentioned [here](https://learn.microsoft.com/en-us/office/dev/add-ins/design/keyboard-shortcuts?tabs=jsonmanifest#avoid-key-combinations-in-use-by-other-add-ins) in the documentation page I was asking about but did not read it carefuly enough 😢",
        "created_at": "2025-03-25T23:36:21Z"
      }
    ]
  },
  {
    "number": 5530,
    "title": "Why don't I have support for Mailbox 1.15 yet?",
    "body": "I tried to run the command `Office.context.requirements.isSetSupported('Mailbox', '1.15')` from the console of one of my plugins and this is the result\n\n![Image](https://github.com/user-attachments/assets/57c5eb24-ac86-42fd-a29a-228b54caedcf)",
    "created_at": "2025-03-25T09:37:05Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Outlook"
    ],
    "author": "CodeCube0",
    "comments": [
      {
        "author": "AlexJerabek",
        "body": "Hi @CodeCube0,\n\nCan you please share what platform you're on with your Outlook client (web, classic Windows, new Outlook on Windows, Mac, etc)? And if you're on a desktop client, could you also share your build number. The support list is [here](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/outlook/outlook-api-requirement-sets?view=common-js-preview&tabs=xmlmanifest), but it your version is listed as supported, we can investigate further. ",
        "created_at": "2025-03-25T17:33:47Z"
      },
      {
        "author": "CodeCube0",
        "body": "> Hi [@CodeCube0](https://github.com/CodeCube0),\n> \n> Can you please share what platform you're on with your Outlook client (web, classic Windows, new Outlook on Windows, Mac, etc)? And if you're on a desktop client, could you also share your build number. The support list is [here](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/outlook/outlook-api-requirement-sets?view=common-js-preview&tabs=xmlmanifest), but it your version is listed as supported, we can investigate further.\n\n![Image](https://github.com/user-attachments/assets/d446f4a8-d8fe-47cf-a34f-d6a9a8914bd9)\n\n![Image](https://github.com/user-attachments/assets/aa1ddaab-37b9-4e50-aa76-78b3c7c20b78)",
        "created_at": "2025-03-26T09:27:44Z"
      },
      {
        "author": "1TheMuffinMan",
        "body": "I'm having the same issue.\n\nOutlook Desktop (Classic)\n\n![Image](https://github.com/user-attachments/assets/2179a6da-1815-4760-8fff-2ec19b25f62a)\n\nOutlook Web app personal account (outlook.live.com)\n\n![Image](https://github.com/user-attachments/assets/bd0d8f24-fd96-4efc-abab-3cf9cdded1f8)\n\nOutlook Web app business account (outlook.office.com)\n\n![Image](https://github.com/user-attachments/assets/36acbf56-1c6c-4ec8-8163-7c34df6851af)\n\nI tested on the newest version of Outlook for Mac, same issue.",
        "created_at": "2025-03-28T01:06:50Z"
      },
      {
        "author": "1TheMuffinMan",
        "body": "@AlexJerabek ",
        "created_at": "2025-04-03T15:56:48Z"
      },
      {
        "author": "timwan10",
        "body": "For **Mac** 1.15 is not supported on Mac yet.\n\nFor **Outlook Web Access** I don't have an answer. Someone will contact the dev team there for an answer.\n\nFor **Classic Win32**, this is a bug starting in version 16.0.18526.20000. \n\nWe are trying to deploy a fix ASAP. \n\nThese builds DO support 1.15, they just say that they don't. \n\nI will update this thread when the fix deploys. \n",
        "created_at": "2025-04-09T19:20:16Z"
      },
      {
        "author": "mmanjaree-msft",
        "body": "@1TheMuffinMan For Outlook web and new outlook also the requirement set 1.15 is supported now. It has been rolled out fully. Could you refresh / reload and confirm.",
        "created_at": "2025-04-10T15:12:10Z"
      },
      {
        "author": "CodeCube0",
        "body": "> [@1TheMuffinMan](https://github.com/1TheMuffinMan) For Outlook web and new outlook also the requirement set 1.15 is supported now. It has been rolled out fully. Could you refresh / reload and confirm.\n\n![Image](https://github.com/user-attachments/assets/f1f71f50-2d25-4179-a8ae-e82a74ce38d7)\n\nyes, For Outlook web is now supported",
        "created_at": "2025-04-10T15:14:45Z"
      },
      {
        "author": "timwan10",
        "body": "As an update for Win32 Classic, this has been fixed on Monthly Current Channel, Beta and Preview Channels. \nNo new bits are required to be downloaded. Restarting Outlook should fix the issue. You may need to reboot the computer. An Active Internet connection on that machine is required. \n\nThe Fix should be deployed on the Monthly Enterprise Channel in the coming days. (It is not deployed yet). \nFor the Semi-Annual Preview Channel a fix is in ETA for the next update. (So bits will have to be upgraded for this version) \n\nI will update as those builds are fixed.  ",
        "created_at": "2025-04-14T22:16:21Z"
      },
      {
        "author": "1TheMuffinMan",
        "body": "Appreciate the communication and responsiveness around this issue!",
        "created_at": "2025-04-14T22:21:23Z"
      },
      {
        "author": "timwan10",
        "body": "Monthly Enterprise Channels are now fixed. (no new bits, restart required). \n\nSAC-P Channel Builds ETA is still next patch Tuesday (May 13th). (new bits required)\n\n\nUpdate: Sorry to update this, it looks like 1.15 is not available on MEC yet for other reasons. (but this bug that was causing it to be not available has been fixed there...) So when 1.15 is available in MEC, this shouldn't be a problem there. ",
        "created_at": "2025-04-15T22:54:19Z"
      },
      {
        "author": "CodeCube0",
        "body": "Great perfect, it works now. \n\n![Image](https://github.com/user-attachments/assets/39485626-87b2-4433-bba8-41802b1245c6)\n\nThank you @timwan10 ",
        "created_at": "2025-04-16T06:36:23Z"
      }
    ]
  },
  {
    "number": 5523,
    "title": "Cannot retrieve document properties from PowerPoint",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\nI am facing an issue with `PowerPoint.DocumentProperties`. I have an Add-In meant to work with PowerPoint, Excel and Word. I took the default `manifest.xml` and added `<Host>` tags for both `<OfficeApp><Hosts></></>` (`<Host Name=\"...\"/>`) and `<OfficeApp><VersionOverrides><Hosts></></></>` (`<Host xsi:type=\"...\">...</Host>`).\n\n```xml\n\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n<OfficeApp xmlns=http://schemas.microsoft.com/office/appforoffice/1.1 xmlns:xsi=http://www.w3.org/2001/XMLSchema-instance xmlns:bt=http://schemas.microsoft.com/office/officeappbasictypes/1.0 xmlns:ov=http://schemas.microsoft.com/office/taskpaneappversionoverrides xsi:type=\"TaskPaneApp\">\n\n  <Id>......</Id>\n\n  <Version>1.0.0.0</Version>\n\n  <ProviderName>Contoso</ProviderName>\n\n  <DefaultLocale>en-US</DefaultLocale>\n\n  <DisplayName DefaultValue=\"Add-In Name\"/>\n\n  <Description DefaultValue=\"A template to get started.\"/>\n\n  <IconUrl DefaultValue=https://localhost:3000/assets/icon-32.png/>\n\n  <HighResolutionIconUrl DefaultValue=https://localhost:3000/assets/icon-64.png/>\n\n  <SupportUrl DefaultValue=https://www.contoso.com/help/>\n\n  <AppDomains>\n\n    <AppDomain>https://www.contoso.com/</AppDomain>\n\n  </AppDomains>\n\n  <Hosts>\n\n    <Host Name=\"Document\"/>\n\n    <Host Name=\"Workbook\"/>\n\n    <Host Name=\"Presentation\"/>\n\n  </Hosts>\n\n  <DefaultSettings>\n\n    <SourceLocation DefaultValue=\"https://localhost:3000/taskpane.html\"/>\n\n  </DefaltSettings>\n\n  <Permissions>ReadWriteocument</Permissions>\n\n  <VersionOverrides xmlns=\"http://schemas.microsoft.com/office/taskpaneappvrsionoverrides\" xsi:type=\"VersionOverridesV1_0\">\n\n    <Hosts>\n\n     <Host xsi:type=\"Document\">\n\n        <DesktopFormFactor>\n\n          <GetStarted>\n\n            <Title resid=\"GetStarted.Title\"/>\n\n            <Description resid=\"GetStarted.Description\"/>\n\n            <LearnMoreUrl resid=\"GetStarted.LearnMoreUrl\"/>\n\n          </GetStarted>\n\n          <FunctionFile resid=\"Commands.Url\"/>\n\n          <ExtensionPoint xsi:type=\"PrimaryCommandSurface\">\n\n            <OfficeTab id=\"TabHome\">\n\n              <Group id=\"CommandsGroup\">\n\n                <Label resid=\"CommandsGroup.Label\"/>\n\n                <Icon>\n\n                  <bt:Image size=\"16\" resid=\"Icon.16x16\"/>\n\n                  <bt:Image size=\"32\" resid=\"Icon.32x32\"/>\n\n                  <bt:Image size=\"80\" resid=\"Icon.80x80\"/>\n\n                </Icon>\n\n                <Control xsi:type=\"Button\" id=\"TaskpaneButton\">\n\n                  <Label resid=\"TaskpaneButton.Label\"/>\n\n                  <Supertip>\n\n                    <Title resid=\"TaskpaneButton.Label\"/>\n\n                    <Description resid=\"TaskpaneButton.Tooltip\"/>\n\n                  </Supertip>\n\n                  <Icon>\n\n                    <bt:Image size=\"16\" resid=\"Icon.16x16\"/>\n\n                    <bt:Image size=\"32\" resid=\"Icon.32x32\"/>\n\n                    <bt:Image size=\"80\" resid=\"Icon.80x80\"/>\n\n                  </Icon>\n\n                  <Action xsi:type=\"ShowTaskpane\">\n\n                    <TaskpaneId>ButtonId1</TaskpaneId>\n\n                    <SourceLocation resid=\"Taskpane.Url\"/>\n\n                  </Action>\n\n                </Control>\n\n              </Group>\n\n            </OfficeTab>\n\n          </ExtensionPoint>\n\n        </DesktopFormFactor>\n\n      </Host>\n\n      <Host xsi:type=\"Workbook\">\n\n        <DesktopFormFactor>\n\n          <GetStarted>\n\n            <Title resid=\"GetStarted.Title\"/>\n\n            <Description resid=\"GetStarted.Description\"/>\n\n            <LearnMoreUrl resid=\"GetStarted.LearnMoreUrl\"/>\n\n          </GetStarted>\n\n          <FunctionFile resid=\"Commands.Url\"/>\n\n          <ExtensionPoint xsi:type=\"PrimaryCommandSurface\">\n\n            <OfficeTab id=\"TabHome\">\n\n              <Group id=\"CommandsGroup\">\n\n                <Label resid=\"CommandsGroup.Label\"/>\n\n                <Icon>\n\n                  <bt:Image size=\"16\" resid=\"Icon.16x16\"/>\n\n                  <bt:Image size=\"32\" resid=\"Icon.32x32\"/>\n\n                  <bt:Image size=\"80\" resid=\"Icon.80x80\"/>\n\n                </Icon>\n\n                <Control xsi:type=\"Button\" id=\"TaskpaneButton\">\n\n                  <Label resid=\"TaskpaneButton.Label\"/>\n\n                  <Supertip>\n\n                    <Title resid=\"TaskpaneButton.Label\"/>\n\n                    <Description resid=\"TaskpaneButton.Tooltip\"/>\n\n                  </Supertip>\n\n                  <Icon>\n\n                    <bt:Image size=\"16\" resid=\"Icon.16x16\"/>\n\n                    <bt:Image size=\"32\" resid=\"Icon.32x32\"/>\n\n                    <bt:Image size=\"80\" resid=\"Icon.80x80\"/>\n\n                  </Icon>\n\n                  <Action xsi:type=\"ShowTaskpane\">\n\n                    <TaskpaneId>ButtonId1</TaskpaneId>\n\n                    <SourceLocation resid=\"Taskpane.Url\"/>\n\n                  </Action>\n\n                </Control>\n\n              </Group>\n\n            </OfficeTab>\n\n          </ExtensionPoint>\n\n        </DesktopFormFactor>\n\n      </Host>\n\n      <Host xsi:type=\"Presentation\">\n\n        <DesktopFormFactor>\n\n          <GetStarted>\n\n            <Title resid=\"GetStarted.Title\"/>\n\n            <Description resid=\"GetStarted.Description\"/>\n\n            <LearnMoreUrl resid=\"GetStarted.LearnMoreUrl\"/>\n\n          </GetStarted>\n\n          <FunctionFile resid=\"Commands.Url\"/>\n\n          <ExtensionPoint xsi:type=\"PrimaryCommandSurface\">\n\n            <OfficeTab id=\"TabHome\">\n\n              <Group id=\"CommandsGroup\">\n\n                <Label resid=\"CommandsGroup.Label\"/>\n\n                <Icon>\n\n                  <bt:Image size=\"16\" resid=\"Icon.16x16\"/>\n\n                  <bt:Image size=\"32\" resid=\"Icon.32x32\"/>\n\n                  <bt:Image size=\"80\" resid=\"Icon.80x80\"/>\n\n                </Icon>\n\n                <Control xsi:type=\"Button\" id=\"TaskpaneButton\">\n\n                  <Label resid=\"TaskpaneButton.Label\"/>\n\n                  <Supertip>\n\n                    <Title resid=\"TaskpaneButton.Label\"/>\n\n                    <Description resid=\"TaskpaneButton.Tooltip\"/>\n\n                  </Supertip>\n\n                  <Icon>\n\n                    <bt:Image size=\"16\" resid=\"Icon.16x16\"/>\n\n                    <bt:Image size=\"32\" resid=\"Icon.32x32\"/>\n\n                    <bt:Image size=\"80\" resid=\"Icon.80x80\"/>\n\n                  </Icon>\n\n                  <Action xsi:type=\"ShowTaskpane\">\n\n                    <TaskpaneId>ButtonId1</TaskpaneId>\n\n                    <SourceLocation resid=\"Taskpane.Url\"/>\n\n                  </Action>\n\n                </Control>\n\n              </Group>\n\n            </OfficeTab>\n\n          </ExtensionPoint>\n\n        </DesktopFormFactor>\n\n      </Host>\n\n    </Hosts>\n\n    <Resources>\n\n      <bt:Images>\n\n        <bt:Image id=\"Icon.16x16\" DefaultValue=\"https://localhost:3000/assets/icon-16.png\"/>\n\n       <bt:Image id=\"Icon.32x32\" DefaultValu=\"https://localhost:3000/assets/icon-32.png\"/>\n\n       <bt:Image id=\"Icon.80x80\" DefaultValu=\"https://localhost:3000/assets/icon-80.png\"/>\n\n     </bt:Images>\n\n      <bt:Urls>\n\n        <b:Url id=\"GetStarted.LearnMoreUrl\" DefaultValue=\"https://go.microsoft.com/fwlink/?LinkId=276812\"/\n\n        <bt:Url id=\"Commands.Url\" DefaultValu=\"https://localhost:3000/commands.html\"/>\n\n        bt:Url id=\"Taskpane.Url\" DefaultValu=\"https://localhost:3000/taskpane.html\"/>\n\n      </t:Urls>\n\n      <bt:ShortStrings>\n\n       <bt:String id=\"GetStarted.Title\" DefaultValue=\"Get started with your sample add-in!\"/>\n\n        <bt:String id=\"CommandsGroup.Label\" DefaultValue=\"Commands Group\"/>\n\n        <bt:String id=\"TaskpaneButton.Label\" DefaultValue=\"Add-In Name\"/>\n\n      </bt:ShortStrings>\n\n      <bt:LongStrings>\n\n        <bt:String id=\"GetStarted.Description\" DefaultValue=\"Your sample add-in loaded successfully. Go to the HOME tab and click the 'Show Task Pane' button to get started.\"/>\n\n        <bt:String id=\"TaskpaneButton.Tooltip\" DefaultValue=\"Click to Show a Task Pane\"/>\n\n      </bt:LongStrings>\n\n    </Resources>\n\n  </VersionOverrides>\n\n</OfficeApp>\n\n```\n\n \n\nI have a function I mean to use in both which extracts the document properties of each app:\n\n```typescript\n\nexport async function getProperties(propertyNames?: string | string[]): Promise<object> {\n\n  let res = {};\n\n \n\n  // Check which host the add-in is running in\n\n  const host = Office.context.host;\n\n \n\n  if (host === Office.HostType.Word) {\n\n    await Word.run(async (context) => {\n\n      const builtInProperties: Word.DocumentProperties = context.document.properties;\n\n      builtInProperties.load(propertyNames);\n\n      await context.sync();\n\n      res = JSON.parse(JSON.stringify(builtInProperties));\n\n    });\n\n  } else if (host === Office.HostType.Excel) {\n\n    await Excel.run(async (context) => {\n\n      const workbookProperties = context.workbook.properties;\n\n      workbookProperties.load(propertyNames);\n\n      await context.sync();\n\n      res = JSON.parse(JSON.stringify(workbookProperties));\n\n    });\n\n  } else if (host === Office.HostType.PowerPoint) {\n\n    await PowerPoint.run(async (context) => {\n\n      const presentationProperties = context.presentation.properties;\n\n      presentationProperties.load(propertyNames);\n\n      await context.sync();\n\n      res = JSON.parse(JSON.stringify(presentationProperties));\n\n    });\n\n  } else {\n\n    throw new Error(\"Unsupported host application.\");\n\n  }\n\n  console.log(res)\n\n \n\n  return res;\n\n}\n\n```\n\n \n\nCurrently this function works for Excel and Word, but for PowerPoint returns nothing. I've tried specific `propertyNames` like `keywords` and `*`, but everytime the object is empty.\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC Laptop\n* Host [Excel, Word, PowerPoint, etc.]: PowerPoint\n* Office version number: ______\n* Operating System: Windows 10\n* Browser (if using Office on the web): N/A\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. Create a new Office Add-In using Yeoman with React template.\n2. Copy over the above code.",
    "created_at": "2025-03-22T01:43:43Z",
    "state": "closed",
    "labels": [
      "Area: Excel",
      "Area: Word"
    ],
    "author": "ChrisMGeo",
    "comments": [
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "Thank you for letting us know about this issue. We will take a look shortly. Thanks.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-03-22T01:43:57Z"
      },
      {
        "author": "ChrisMGeo",
        "body": "Never mind it seems to be something wrong with the json conversion of PowerPoint properties, just using the properties without json works as intended.",
        "created_at": "2025-03-24T04:51:13Z"
      },
      {
        "author": "guoms1",
        "body": "Close this issue as the customer figured out by himself.",
        "created_at": "2025-03-24T06:43:39Z"
      }
    ]
  },
  {
    "number": 5521,
    "title": "[Outlook] Event handler for `DialogEventReceived` not called when `displaydialogasync` times out",
    "body": "In Outlook add-ins, the event handler for `DialogEventReceived` is not triggered when the `displayDialogAsync` times out.\nSince `DialogEventReceived` is triggered when `displayDialogAsync` is closed, it is expected that it should also trigger when it times out.\n\nMy Add-in have some clean up login inside `handleDialogClose` which should be executed whenever the dialog is closed for any reason.\n\nPlease provide the timeline for fixing this issue, or let me know if there is any other event that handles timeouts for `displayDialogAsync`.\n\n",
    "created_at": "2025-03-21T11:26:43Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "AtharvaDevSeclore",
    "comments": [
      {
        "author": "rworgill",
        "body": "I have what I believe to be a similar issue.  I will open a dialog from outlook 365 with displayDialogAsync.  It works the on the first email.  It fails silently fails the second time.  This has only started the last week or two.",
        "created_at": "2025-03-24T03:20:27Z"
      },
      {
        "author": "rajjha-msft",
        "body": "Please specify the platform you're using.",
        "created_at": "2025-03-24T09:35:43Z"
      },
      {
        "author": "AtharvaDevSeclore",
        "body": "I have observed this issue on outlook web app on chrome as well as legacy outlook on mac",
        "created_at": "2025-03-24T09:37:45Z"
      },
      {
        "author": "rajjha-msft",
        "body": "Hey @AtharvaDevSeclore \n\nCan you please share a video of the repro ?\nAlso, would be great if you can share a test add-in as well. \n\nYou can create a private repro and share it with @exextoc ",
        "created_at": "2025-03-25T09:11:28Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-03-29T20:21:47Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-01T22:28:48Z"
      }
    ]
  },
  {
    "number": 5520,
    "title": "Outlook Onsend addin is invoked multiple times after clicking send",
    "body": "I have developed an add-in for Outlook that is triggered whenever the user clicks the \"Send\" button. Upon activation, the add-in opens a dialog box that allows the user to interact and input information. The primary function of the add-in is to automatically append a header and footer to the body of the email before it is sent.\n\nHowever, I’ve encountered an issue where the add-in is sometimes invoked multiple times in quick succession, causing the header and footer to be added repeatedly to the email body. This results in the email body becoming cluttered with redundant content.\n\nFor context, I am using Outlook 16.94 with the legacy UI on a Mac system.\n\nI’ve come across a similar issue reported on GitHub (https://github.com/OfficeDev/office-js/issues/1367), which appears to be related, though the problem is not entirely consistent. The issue seems to occur more frequently under certain conditions, particularly when multiple applications are running simultaneously. A noteworthy observation is that when the user is sharing their entire screen via Microsoft Teams, this issue becomes almost persistent.",
    "created_at": "2025-03-21T08:36:57Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity",
      "Resolution: won't fix",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "AtharvaDevSeclore",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #3562\n- #3753\n- #5098\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nEnsure that all asynchronous API calls are completed before invoking event.completed. Specifically, if the add-in is updating the email body or setting recipients, make sure these operations are finished before calling event.completed.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3753#issuecomment-1774093073\n- https://github.com/officedev/office-js/issues/3753#issuecomment-1780015482\n### Solution 2:\nCheck if the add-in is deployed twice, such as being both sideloaded and deployed via Office Admin. This can cause the OnSend event to trigger multiple times.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3753#issuecomment-1779082430\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-21T08:37:33Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @AtharvaDevSeclore , we are unable to reproduce this issue at our end. Can you please provide more details about your scenario? You can also consider sharing mimimal sample add-in which can help us reproduce this issue.",
        "created_at": "2025-03-25T06:19:23Z"
      },
      {
        "author": "AtharvaDevSeclore",
        "body": "Hi @kumarshrey-msft, like I mentioned, it is an onsend add-in which opens dialog box using `displaydialogasync` for some user interaction. It also has a send button and on click of that button, it adds header and footer to the mail body.\n\nI'll share a minimal sample add-in but I'll have to make sure that it also behaves like the actual add-in and is able to reproduce that issue which might take some time. Meanwhile, is there anything else you need?",
        "created_at": "2025-03-29T06:41:16Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "@AtharvaDevSeclore  Thanks for the details! Additionally, you can also share the repro video of the issue to help us better understand the scenario.",
        "created_at": "2025-03-29T08:49:06Z"
      },
      {
        "author": "harshitgoyal1711",
        "body": "`Issue with setRecipients on Old Outlook for Mac During Screen Sharing`\n\nHi @kumarshrey-msft,\n\nPlease find the attached link below, which contains two files:\n\n- One file demonstrates the issue.\n\n- The other file works fine when the screen is not shared.\n\n\n### Key Observations:\n\n- The issue occurs consistently during screen sharing but only on Old Outlook for Mac.\n\n- In our pop-up, we are calling `setRecipients`, which modifies the following:\n\n  - `Office.context.mailbox.item.to.setAsync()`\n\n  - `Office.context.mailbox.item.cc.setAsync()`\n\n  - `Office.context.mailbox.item.bcc.setAsync()`\n\n- This issue does not occur in other cases of our functionality or in different environments.\n\n[Shared Link](https://seclore-my.sharepoint.com/:f:/p/harshit_goyal/EjFOLYZnHC1Fg24AZd41oU8BFE9b2XSUUjrCqCvKEz8Gcg?e=B9q7pQ)\n\nLet me know if you need any further details.",
        "created_at": "2025-04-01T09:08:01Z"
      },
      {
        "author": "AtharvaDevSeclore",
        "body": "@kumarshrey-msft,\nyou can refer to [this link](https://seclore-my.sharepoint.com/personal/harshit_goyal_seclore_com/_layouts/15/onedrive.aspx?id=%2Fpersonal%2Fharshit%5Fgoyal%5Fseclore%5Fcom%2FDocuments%2FBlock%20Domain%20ISSUE&ga=1) of repro video of the issue\n\nlet me know if anything else is needed",
        "created_at": "2025-04-07T04:51:55Z"
      },
      {
        "author": "mmanjaree-msft",
        "body": "@AtharvaDevSeclore Thanks for sharing the video. the recommendation woudl be to switch to new outlook for mac. We will not be taking up any fixes for legacy outlook for mac issues because its going to be deprecated soon. Please follow https://support.microsoft.com/en-us/office/end-of-support-for-legacy-outlook-for-mac-7b9cf644-7035-4345-a151-8c1c7a65ac25\n",
        "created_at": "2025-04-10T06:34:33Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-14T06:51:48Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-17T09:31:44Z"
      }
    ]
  },
  {
    "number": 5518,
    "title": "https://ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js timeout in some case",
    "body": "While I am developing some new features on task pane add-in in Outlook\nSome cases that I clear the whole cache and load all content again and MicrosoftAjax.js is timeout\nCould you guy please check it?\n\n",
    "created_at": "2025-03-21T03:26:30Z",
    "state": "closed",
    "labels": [],
    "author": "ttuyen1529",
    "comments": [
      {
        "author": "rajjha-msft",
        "body": "Please share more details around the platform you are using ?\nThe use case scenario, and the complete error you're seeing.",
        "created_at": "2025-03-24T09:17:35Z"
      },
      {
        "author": "ttuyen1529",
        "body": "all platform.. OWA, old Outlook I see this. it in early step in load our add in\n\n![Image](https://github.com/user-attachments/assets/ae97b6ae-2f51-4926-9adc-c28f961937a5)",
        "created_at": "2025-04-02T09:42:11Z"
      },
      {
        "author": "ttuyen1529",
        "body": "please reopen it as we still see the issue on the go",
        "created_at": "2025-04-03T09:12:17Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @ttuyen1529,\n\nCould you please follow this [template](https://github.com/OfficeDev/office-js/blob/release/.github/ISSUE_TEMPLATE/bug_report.md) and provide additional details of your scenario?  Kindly update the issue description accordingly",
        "created_at": "2025-04-04T08:40:11Z"
      },
      {
        "author": "ttuyen1529",
        "body": "Close issue since this CDN seems stable for now. I do not receive any reported anymore from our users",
        "created_at": "2025-04-10T09:26:08Z"
      }
    ]
  },
  {
    "number": 5514,
    "title": "Scriptlab is not working anymore",
    "body": "Coming here because the scriptlab repo has been archived and is in read-only, and the [last commit](https://github.com/OfficeDev/script-lab/commit/9c8d2809d212891662505f9af75b5d91070ff603) tells us to report bugs here.\n\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform: Mac \n* Host [Excel, Word, PowerPoint, etc.]: Word\n* Office version number: Version 16.95.1 (25031528)\n* Operating System: MacOS 15.3.2\n* Browser (if using Office on the web): None - Using Word on the app downloaded from the office website\n \n## Expected behavior\nBeing able to use the scriplab plugin\n\n## Current behavior\n\nOn opening, it shows this error:\n```markdown\nScript Lab\nAn unexpected error has occurred.\nClick for more info\nClose\n```\nWhen clicking `Click for more info`, I have the following:\n```markdown\nError:\n{\n    \"message\": \"Load failed\",\n    \"sagaStack\": \"at fg \\n at fg \\n at ou \\n at xm \\n at Cm \\n undefined\"\n}\n```\n\n## Steps to reproduce\nOpening scriptlab\n\n## Link to live example(s)\nThe Scriptlab plugin you suggest to provide a live example on is down\n\n# Provide additional details\nIt was working yesterday. \nI tried on some colleagues and friend account and we all have the same error.\nWhen clicking on `Close`, we have access to scriptlab but none of the action are working, you cannot start your code snippet, you cannot load another one...\n\n\n## Useful logs\nThe debug console shows the following:\n```markdown\n[Error] Origin https://script-lab.public.cdn.office.net is not allowed by Access-Control-Allow-Origin. Status code: 404\n[Error] Fetch API cannot load https://unpkg.com/@types/jquery@3.3.1/index.d.ts due to access control checks.\n[Error] Failed to load resource: Origin https://script-lab.public.cdn.office.net is not allowed by Access-Control-Allow-Origin. Status code: 404 (index.d.ts, line 0)\n[Error] Global error handler:\n\t(anonymous function) (main.5fae7954.js:110:40514)\n\tS (main.5fae7954.js:353:67564)\n\to (main.5fae7954.js:353:66485)\n\t(anonymous function) (main.5fae7954.js:353:66562)\n\tx (main.5fae7954.js:353:67359)\n\tp (main.5fae7954.js:353:68058)\n\tc (main.5fae7954.js:353:71212)\n\tp (main.5fae7954.js:353:68058)\n\tS (main.5fae7954.js:353:67713)\n\to (main.5fae7954.js:353:66485)\n\t(anonymous function) (main.5fae7954.js:353:66562)\n\tS (main.5fae7954.js:353:67713)\n\to (main.5fae7954.js:353:66485)\n\t(anonymous function) (main.5fae7954.js:353:66562)\n\tS (main.5fae7954.js:353:67713)\n\to (main.5fae7954.js:353:66485)\n\t(anonymous function) (main.5fae7954.js:353:66562)\n\tx (main.5fae7954.js:353:67359)\n\tp (main.5fae7954.js:353:68058)\n\tS (main.5fae7954.js:353:67713)\n\to (main.5fae7954.js:353:66485)\n\t(anonymous function) (main.5fae7954.js:353:66562)\n\tx (main.5fae7954.js:353:67359)\n\tp (main.5fae7954.js:353:68058)\n\tc (main.5fae7954.js:353:71212)\n\tp (main.5fae7954.js:353:68058)\n[Error] TypeError: Load failed\n\t(anonymous function) (main.5fae7954.js:110:40553)\n\tS (main.5fae7954.js:353:67564)\n\to (main.5fae7954.js:353:66485)\n\t(anonymous function) (main.5fae7954.js:353:66562)\n\tx (main.5fae7954.js:353:67359)\n\tp (main.5fae7954.js:353:68058)\n\tc (main.5fae7954.js:353:71212)\n\tp (main.5fae7954.js:353:68058)\n\tS (main.5fae7954.js:353:67713)\n\to (main.5fae7954.js:353:66485)\n\t(anonymous function) (main.5fae7954.js:353:66562)\n\tS (main.5fae7954.js:353:67713)\n\to (main.5fae7954.js:353:66485)\n\t(anonymous function) (main.5fae7954.js:353:66562)\n\tS (main.5fae7954.js:353:67713)\n\to (main.5fae7954.js:353:66485)\n\t(anonymous function) (main.5fae7954.js:353:66562)\n\tx (main.5fae7954.js:353:67359)\n\tp (main.5fae7954.js:353:68058)\n\tS (main.5fae7954.js:353:67713)\n\to (main.5fae7954.js:353:66485)\n\t(anonymous function) (main.5fae7954.js:353:66562)\n\tx (main.5fae7954.js:353:67359)\n\tp (main.5fae7954.js:353:68058)\n\tc (main.5fae7954.js:353:71212)\n\tp (main.5fae7954.js:353:68058)\n[Error] Origin https://script-lab.public.cdn.office.net is not allowed by Access-Control-Allow-Origin. Status code: 404\n[Error] Fetch API cannot load https://unpkg.com/@types/core-js@2.5.8/index.d.ts due to access control checks.\n[Error] Failed to load resource: Origin https://script-lab.public.cdn.office.net is not allowed by Access-Control-Allow-Origin. Status code: 404 (index.d.ts, line 0)\n[Error] Origin https://script-lab.public.cdn.office.net is not allowed by Access-Control-Allow-Origin. Status code: 404\n[Error] Fetch API cannot load https://unpkg.com/@types/office-js@1.0.480/index.d.ts due to access control checks.\n[Error] Failed to load resource: Origin https://script-lab.public.cdn.office.net is not allowed by Access-Control-Allow-Origin. Status code: 404 (index.d.ts, line 0)\n[Error] Source Map loading errors (x2)\n[Error] Failed to load resource: the server responded with a status of 404 (Not Found) (typescriptServices.js.map, line 0)\n[Error] Failed to load resource: the server responded with a status of 404 (Not Found) (typescriptServices.js.map, line 0)\n```\n\n![Image](https://github.com/user-attachments/assets/0ce98885-b3c8-4d79-9f5f-15a1c34f30cd)\n\n![Image](https://github.com/user-attachments/assets/98c6cd36-eaf6-4384-80c8-860fb204e961)",
    "created_at": "2025-03-20T08:50:36Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Word"
    ],
    "author": "BenoitJimini",
    "comments": [
      {
        "author": "BenoitJimini",
        "body": "Tried to clone the script lab repo and start it locally\nSame error locally",
        "created_at": "2025-03-20T09:38:57Z"
      },
      {
        "author": "gstaff",
        "body": "Seconding that I saw this issue just today on a Windows 11 machine so it is not specific to MacOS.",
        "created_at": "2025-03-21T02:48:37Z"
      },
      {
        "author": "BenoitJimini",
        "body": "The issue has been fixed, I works once again",
        "created_at": "2025-03-28T10:12:34Z"
      }
    ]
  },
  {
    "number": 5512,
    "title": "Some addIns are not opening the task pane",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Office on the web\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Office version number: ______\n* Operating System: Mac\n* Browser (if using Office on the web): Chrome v131.0.6778.204\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nClicking the addin should open the task pane\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nI haven't been able to identify what is exactly causing it, but when I click certain addins from the addin menu in the message context, the menu closes and the addin doesn't open the task pane. This is true for Send to OneNote along with my own team's addin - Viva Insights seems to open fine. Here's a quick clip to show for Send to OneNote (not sure if it's relevant, but if you look closely you can see that I sometimes have to click several times to open the addin menu):\n\nhttps://github.com/user-attachments/assets/a63ae1c4-6640-43e2-b6cf-f23ec9f5be07\n\nThen when I try to open our own addin from the ribbon, it opens a search bar that my team did not create.\n\n![Image](https://github.com/user-attachments/assets/15a4e2c3-a9c0-4390-a2fb-b7daeb3880ea)\n\nThe same account with the same addin could work in one Chrome instance and fail in another.\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\nUnfortunately I don't know exactly what the cause is, so I can't reproduce faithfully.  One person on my team was able to reproduce with Chrome Canary, then when they updated it went away.\n\n## Link to live example(s)\n<!--- Ideally, provide a link to a live example, created and shared using -->\n<!--- [Script Lab](https://aka.ms/scriptlab). If relevant, create two buttons, -->\n<!--- one that sets up data in the document, and another that exemplifies the issue. -->\n1. ______\n2. ______\n3. ______\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\n1. ______\n2. ______\n3. ______\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\n\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n  - There was nothing meaningful in the console when the addin fails to open\n- [x] Screenshots (above)\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-03-19T20:20:58Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Outlook",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "kstuhs",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #4075\n- #3399\n- #5288\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nWe fixed it by doing a minor change to the manifest file. We changed \"CustomTab\" --> \"OfficeTab\"\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4075#issuecomment-2325705010\n### Solution 2:\nOpening a mail and then going to compose worked for me! I noticed it was only an inbox mail. I tried one from deleted/archived and that didn't work at first.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3399#issuecomment-1573832393\n### Solution 3:\nWe have fixed this issue and it is being rolled out. It should be available latest by tomorrow. In case you still face this issue, then please clear your cache and do a hard refresh and try again.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3399#issuecomment-1582001808\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-19T20:21:47Z"
      },
      {
        "author": "manaunl",
        "body": "We are experiencing the exact same issue. Additionally, we have noticed that the event-based activation for `OnMessageCompose`, `OnMessageRecipientsChanged`, and `OnMessageAttachmentsChanged` does not trigger for our add-in.\n<img width=\"402\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/beef0ec3-4a93-4b00-8d88-287a8e5e9b11\" />\n\nThis issue is blocking our add-in functionality, as event-based activation is a crucial component. Please provide guidance on resolving this or let us know if a fix is in progress.",
        "created_at": "2025-03-20T08:27:18Z"
      },
      {
        "author": "MatthewLowden",
        "body": "Hi @exextoc ,\nThis appears to be caused by a failed change that started rolling out yesterday.\nPlease could you stop the roll-out and revert this?",
        "created_at": "2025-03-20T09:03:06Z"
      },
      {
        "author": "MehakFatima24",
        "body": "Hi @exextoc this is impacting the users in our user base as well, kindly revert this asap so the users are able to use the add-in. ",
        "created_at": "2025-03-20T09:12:23Z"
      },
      {
        "author": "rickgoud",
        "body": "Wow...just wow... @exextoc and Microsoft team. How can it be that these type of fundamental issues are not discovered in QA? Can you please set up a program that will prevent these fundamental issues. Add-ins not loading and Events not working are the core of your M365 add-in strategy.\n\nPlease, please give this high prio and show to the community you take quality seriously!",
        "created_at": "2025-03-20T09:55:51Z"
      },
      {
        "author": "pihlapuro-fi",
        "body": "Experienced the same behaviour yesterday 19th of March in OWA with our add-in as well.",
        "created_at": "2025-03-20T11:56:05Z"
      },
      {
        "author": "arpitsangwanmsft",
        "body": "Hey @kstuhs / @manaunl / @pihlapuro-fi / @MehakFatima24 !\nCan you please [share logs as per these instructions](https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues) so that we can check our telemetry for those specific users as well.\n",
        "created_at": "2025-03-20T12:12:28Z"
      },
      {
        "author": "kstuhs",
        "body": "> Hey [@kstuhs](https://github.com/kstuhs) / [@manaunl](https://github.com/manaunl) / [@pihlapuro-fi](https://github.com/pihlapuro-fi) / [@MehakFatima24](https://github.com/MehakFatima24) ! Can you please [share logs as per these instructions](https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues) so that we can check our telemetry for those specific users as well.\n\nSent an invite to a private repo",
        "created_at": "2025-03-20T14:22:10Z"
      },
      {
        "author": "JuaneloJuanelo",
        "body": "Just  FYI everyone there is an active incident investigating this issue with the highest priority : [Incident 609222373]",
        "created_at": "2025-03-20T15:55:06Z"
      },
      {
        "author": "neprasad-microsoft",
        "body": "Hey @kstuhs / @manaunl / @pihlapuro-fi / @MehakFatima24 \nAre admin installed add-ins working for you? Is your add-in installed from store/sideloaded? \nWe can see in the video that Viva Insights was working. \nCould you also send a HAR file from some other users?\n\nAlso, we are unable to repro this issue on our side with multiple accounts. So, it would be helpful if you can share a test account in the same private repo. You can delete the credentials once we copy it. \n\nAlso, can you check the value of Optional Connected Experiences -> (View -> View Settings-> General -> Privacy and Data->Privacy Settings -> Optional Connected Experiences. This should be ON.\n\n<img width=\"553\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/03e0fb27-ab83-4419-ab5e-52aeeef14742\" />",
        "created_at": "2025-03-20T18:53:33Z"
      },
      {
        "author": "zhngx1",
        "body": "@manaunl for the event-based add-ins, how were these deployed?",
        "created_at": "2025-03-20T22:49:46Z"
      },
      {
        "author": "Oleg-O",
        "body": "One of key questions here is, do all users who experience these issues also have their Optional Connected Experiences turned OFF? Can impacted people please let us know the state of this control when the issue is happening?",
        "created_at": "2025-03-20T23:16:35Z"
      },
      {
        "author": "exextoc",
        "body": "Hey @kstuhs / @manaunl / @pihlapuro-fi / @MehakFatima24 / @MatthewLowden,\nWe have a repro for above mentioned behavior, for the first time user logs into a new browser. Is this reproducible for you as well only for the first session or have you observed it for subsequent sessions as well?\n  ",
        "created_at": "2025-03-21T05:31:08Z"
      },
      {
        "author": "rickgoud",
        "body": "Yes, only for first time sessions indeed",
        "created_at": "2025-03-21T08:52:52Z"
      },
      {
        "author": "manaunl",
        "body": "@neprasad-microsoft @zhngx1 This is an admin-installed add-in, deployed specifically for this user via the [admin portal](https://admin.microsoft.com/adminportal/home#/Settings/AddIns).\n\n@exextoc I've shared a private repo containing logs and credentials for this user—it's the same [repo](https://github.com/manaunl/office-js-issues-5515) referenced in ticket https://github.com/OfficeDev/office-js/issues/5515. As mentioned in my previous comment, both issues occurred simultaneously.\n\nPlease note that the issue can only be reproduced on the first login in a new browser.\n\nAlso, there is no Optional Connected Experiences setting configured for this user. According to the [documentation](https://learn.microsoft.com/en-us/microsoft-365-apps/privacy/manage-privacy-controls), \"If you don't use these policy settings, all connected experiences are available for your users.\"\n<img width=\"1290\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/0beb2936-6aac-416f-8a26-d1d251a9b0ef\" />\n\n",
        "created_at": "2025-03-21T10:07:56Z"
      },
      {
        "author": "arpitsangwanmsft",
        "body": "Hey @kstuhs / @manaunl / @pihlapuro-fi / @MehakFatima24 / @MatthewLowden / @rickgoud,\nThis issue has been fixed and should not be repro-able now. Can you please re-validate it in a new session?\n\n",
        "created_at": "2025-03-21T10:31:23Z"
      },
      {
        "author": "manaunl",
        "body": "Works for us! Thanks for the quick resolution—much appreciated! Could you share any insights into what the issue was that you fixed?",
        "created_at": "2025-03-21T12:01:07Z"
      },
      {
        "author": "MatthewLowden",
        "body": "@arpitsangwanmsft , @exextoc, et al\nThank you for your quick action in addressing this regression. Much appreciated.\nPer the comment above from @manaunl, it would be great if you could share a postmortem for this incident.\nThanks!",
        "created_at": "2025-03-21T13:23:33Z"
      },
      {
        "author": "kstuhs",
        "body": "Looks like this took care of it for us as well. I appreciate the quick action and my team thanks you as well 🙏  I'm not sure if you need to wait for more confirmations, but I'm content with closing this ticket.",
        "created_at": "2025-03-21T13:25:27Z"
      }
    ]
  },
  {
    "number": 5511,
    "title": "Add-in failed to install or load custom functions.",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Error installing functions\n\nWe are developing an Excel add-in featuring a Task Pane and custom functions. During the development phase, we sideloaded the add-in without any issues. However, after publishing it on the Microsoft 365 Admin Center and subsequently on [AppSource](https://appsource.microsoft.com/en-us/product/office/WA200008223?tab=Overview), users have reported encountering the error \"Error installing functions\" when using the add-in on the web, regardless of whether it was obtained from the Admin Center or AppSource.\n<img width=\"406\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/391a5511-b78e-4978-9d91-1c0ae908ce1a\" />\nOccasionally, our custom functions fail to load, resulting in a #NAME? error in the cells.\n![Image](https://github.com/user-attachments/assets/ee41fa88-5e02-4e82-9de6-b9386c607285)\n\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Web\n* Host [Excel, Word, PowerPoint, etc.]: Excel\n* Office version number: build **16.0.18712.42305**\n* Operating System: Mac OS, Windows\n* Browser (if using Office on the web): Safari, Chrome\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nWe are expecting custom functions to install and load every time on the web excel when our add-in is installed via AppSource. And not to see an error.\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\nWe do see error **Error installing functions**, and time to time our functions do not load, so we get #NAME? in the cell when calling our functions.\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. Open excel on the web.\n2. Install our add in [cmdtyView](https://appsource.microsoft.com/en-us/product/office/WA200008223?tab=Overview)\n3. If error does not occur immediately, refresh the page and you will be able to see error.\n4. Try entering one of our functions. For example `=cmdty.udfs.BCF_LAST(string)`\n",
    "created_at": "2025-03-19T17:20:40Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Excel",
      "Needs: author feedback",
      "Status: no recent activity",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "marenac4",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #3798\n- #5061\n- #4386\n- #2523\n- #4571\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nClearing the Office cache can resolve the issue. Users have reported that clearing the cache from specific locations on their machines fixed the problem. For example, on Mac, clearing the cache from '~/Library/Containers/Microsoft Excel/Data/Library/Application Support/Microsoft/Office/16.0/Wef/' and '~/Library/Containers/Microsoft Excel/Data/Library/Caches/' resolved the issue.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3798#issuecomment-1813803328\n- https://github.com/officedev/office-js/issues/4386#issuecomment-2072912013\n### Solution 2:\nEnsure there is no name conflict with the add-in. If the add-in is installed multiple times (e.g., via sideload and admin-managed), it can cause name conflicts leading to installation failures. Keeping only one manifest in the environment can help avoid this issue.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4571#issuecomment-2187948726\n### Solution 3:\nCheck for CORS policy issues if hosting resources on a server. One user found that their problem was due to a CORS policy in their S3 bucket, and enabling public access resolved the issue.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4571#issuecomment-2219360637\n- https://github.com/officedev/office-js/issues/4571#issuecomment-2606493646\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-19T17:21:37Z"
      },
      {
        "author": "marenac4",
        "body": "Thank you for your recommendations.\nBefore opening this issue, we thoroughly reviewed similar known issues but unfortunately didn’t find a solution that works for us.\n\nI’d also like to highlight that the described issue occurs on both new machines (installing our add-in for the first time) and development machines.\n\nAs for the third solution, we believe it does not apply in our case. We previously encountered a similar problem after deploying the add-in code to the server, but that issue was also present when sideloading.",
        "created_at": "2025-03-20T11:42:03Z"
      },
      {
        "author": "guoms1",
        "body": "Hi, @marenac4 \n\nThanks for reporting the issue.\n\nI tried to reproduce the problem, but it looks like your add-in requires a login, and I’m unable to proceed without valid credentials.\n\nIf possible, could you please share a test account we can use for investigation? You can send the credentials to the following one-time email address: adelev@M365x13055881.onmicrosoft.com. I’ll check it within the next couple of days, but please note that I won’t be monitoring it afterward.\n\nAppreciate your help!\n\nBest regards,",
        "created_at": "2025-03-21T01:10:36Z"
      },
      {
        "author": "marenac4",
        "body": "Hello @guoms1,\n\nThank you for your response.\n\nI have sent the test accounts to the email you provided. However, an account is not required to reproduce our issue. You can simply check whether one of our functions is available, for example: `=cmdty.udfs.BCF_LAST(string)`.\n\nIf you need any additional information, please don't hesitate to ask.\n\nThank you.",
        "created_at": "2025-03-21T15:29:56Z"
      },
      {
        "author": "guoms1",
        "body": "Hi, @marenac4 \n\nThank you again for the detailed description and for providing test accounts—we really appreciate your collaboration.\n\nAfter discussing this issue with our domain expert, we’ve gathered a few thoughts and suggestions that might help us move forward:\n\n1. We haven’t seen similar reports from other customers, and given that the issue is not consistently reproducible on our side either, we currently lean toward this being a usage- or environment-specific issue.\n2. Since the issue appears on Excel for the Web, could you let us know if it also occurs in Excel Desktop? This would help determine if the issue is platform-specific.\n3. For the web environment, we recommend clearing your browser cache and then retrying. If the error reappears, please open the browser DevTools and check for any relevant errors in the Console or Network tab—this information could be very helpful for our investigation.\n4. We also suggest adding more diagnostic logging within your function code to help narrow down the failure point.\n5. One key observation is that sideloading works reliably, while issues tend to occur only after deploying via the Admin Center or AppSource. This suggests that differences in the deployment environment—such as manifest settings, server latency, or load sequence—may be contributing factors.\n  - For instance, in a sideloaded scenario, your custom functions are likely being served from a local development server, whereas published versions are loaded from remote servers, which may introduce additional latency or timing differences. These can result in intermittent race conditions.\n  - Additionally, please note that the firing of Office.onReady() does not guarantee that custom functions have finished installing. If any logic assumes custom functions are ready immediately after onReady, that could lead to inconsistent behavior—especially in environments where network delays are higher.\n  - As an example of such environment-driven issues, things like CORS misconfigurations may also lead to failures during the loading process. While we’re not suggesting CORS is the root cause in this case (especially since the issue isn’t consistently reproducible), it serves to illustrate how subtle differences in setup can lead to different outcomes across environments.\n6. To proceed with an effective investigation, we’ll need either a reliable repro scenario or, in the case of Excel for the Web, at least a session ID from a minimal repro case. This will help us target the issue more precisely.\n\nPlease let us know if you’re able to gather any of the above, and we’ll continue working closely with you to resolve this issue.\n\nBest regards,",
        "created_at": "2025-03-24T04:17:19Z"
      },
      {
        "author": "marenac4",
        "body": "@guoms1, thanks again for your collaboration.\n\nThe key details are as follows:\n\nReproducibility:\n\n- The issue occurs only on the web and does not affect other platforms.\n\n- It is 100% reproducible—if the error does not occur immediately after installing the add-in, it does upon refreshing the page.\n\n- The issue is present across multiple machines, in different geographical locations, and for both first-time and returning users. Given this, we do not believe caching plays a role.\n\nManifest Details:\n\n- Our manifest is hosted at [this URL](https://cmdtyview-addin.aws.barchart.com/manifest.xml) and is correctly specified in the Partner Center.\n\n- Interestingly, when the manifest is downloaded and sideloaded manually, the issue does not occur.\n\nConsole Logs:\n\n- Since this issue pertains to Excel on the web, I am sharing an example of the console log when the error occurs. You can find the log file here: [log.txt](https://github.com/user-attachments/files/19453089/log.txt).\n\nFurther Investigation & Testing:\n\n- If you have any suggestions on how to further diagnose or test this issue, please let me know.\n\n- Is there a way to increase logging verbosity for better debugging?\n\n- Are there specific points in the code where additional console logs would be most useful?\n\nMeanwhile, I am working on creating a minimal reproducible example that excludes any confidential data.\n\nLooking forward to your insights!",
        "created_at": "2025-03-25T17:36:14Z"
      },
      {
        "author": "linderholm",
        "body": "> * Additionally, please note that the firing of Office.onReady() does not guarantee that custom functions have finished installing. If any logic assumes custom functions are ready immediately after onReady, that could lead to inconsistent behavior—especially in environments where network delays are higher.\n\n@guoms1 What is the correct approach then? I.e is there anything I can await to ensure functions have finished installing?",
        "created_at": "2025-03-31T08:54:05Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Thanks for reporting this issue.  \n\nIt has been put on our backlog<Bug#9923289> for internal track. We will keep track of this issue and let you know if there are any updates. ",
        "created_at": "2025-04-29T11:55:03Z"
      },
      {
        "author": "SiruiSun-MSFT",
        "body": "Hi @marenac4, Are you still blocked by this issue? From my validation result, I could successfully install and load your add-in without any errors on Excel Web. And for the functionality test, I test the function named \"=BCF_LAST(string)\" and it seems work well. The #Name error only occurs when I add more namespace into the front of the function. For the current behavior, I have two guesses. \nThe first one is, seems your JS manifest missing the namespace field, thus, when the function user input contains the unknown namespace such as \"cmdty\" or \"cmdty.udfs\", the searching will get failed and return the #Name. This is more like why you are facing this problem.\nThe second one is about the equivalent field. If your JS add-in have a corresponding COM add-in have configured the Equivalent field in JS manifest, that means your JS add-in will be treated as a COM one in some scenario, and the namespace of each function should be omitted, which means, for function \"=Test.addMore()\" in JS CustomFunction, it should be changed to \"=addMore()\" after the configuration of Equivalent field.\n\n![Image](https://github.com/user-attachments/assets/56b69d40-448e-4555-9893-7ce8dd29455a)\n\nHope the information above could help you out! Looking forward to your reply!",
        "created_at": "2025-05-13T07:55:23Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-17T13:44:25Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-20T14:37:40Z"
      }
    ]
  },
  {
    "number": 5510,
    "title": "Word.Range Search returns Range or RangeCollection online, but only RangeCollection on Desktop (PC and Mac)",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\nWhen getting a document selection and performing a search\n\n```js\nrange.search('hello')\n```\nIf there is only one instance of the search text in the document, Range.search returns a Range for the online version, but a RangeCollection for desktop. If there are multiple matches it correctly returns a RangeCollection, per the [api documentation](https://learn.microsoft.com/en-us/javascript/api/word/word.range?view=word-js-preview#word-word-range-search-member(1))\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Office on the web\n* Host [Excel, Word, PowerPoint, etc.]: Word\n* Office version number: latest\n* Operating System: Mac\n* Browser (if using Office on the web): Chrome\n \n## Expected behavior\nI would expect that calling the Range.search method returns a RangeCollection both online and on desktop versions of the office js api.\n\n## Current behavior\nCurrently, in the online version of the office js api, Range.search returns a RangeCollection OR a Range (if there is only one match)\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nAn improvement would be for it to always return a RangeCollection or note the different behavior on the web in the documentation\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. Using office on the web (Word) perform a search on a range (Range.search) for text that appears only once in the document\n2. await context.sync();\n3. log the result.\n4. see that it logs a Range, and not the expected RangeCollection\n\n## Link to live example(s)\n<!--- Ideally, provide a link to a live example, created and shared using -->\n<!--- [Script Lab](https://aka.ms/scriptlab). If relevant, create two buttons, -->\n<!--- one that sets up data in the document, and another that exemplifies the issue. -->\n1. ______\n2. ______\n3. ______\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\n1. ______\n2. ______\n3. ______\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [ ] Screenshots\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-03-19T15:07:25Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Word"
    ],
    "author": "dweill",
    "comments": [
      {
        "author": "penglongzhaochina",
        "body": "hi @dweill ,\n\nThank you for reporting the issue. I can't reproduce your case on word online. It all return rangeCollection no matter how many string hit. Like below picture. Could you please share more details about reproducing step or screen shot? Thanks.\n\n![Image](https://github.com/user-attachments/assets/9f4833d6-6337-44d6-b445-5b515a8555e6)",
        "created_at": "2025-03-20T07:23:36Z"
      },
      {
        "author": "dweill",
        "body": "Hmm strange, I can no longer reproduce it either. I originally noticed it because my code would error when invoking the getFirst method on the range search result, but that seems to be working now. Thank you for your prompt response and feedback.",
        "created_at": "2025-03-20T13:57:39Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "@dweill , no problem, I will close this issue since you can't reproduce it any more.",
        "created_at": "2025-03-21T07:10:11Z"
      }
    ]
  },
  {
    "number": 5508,
    "title": "Missing Title Logo and Incorrect Title in MAC Outlook",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\nWe are developing an outlook web addin using office js Smart alert template.\nIn Mac Outlook, when opening the taskpane, the title logo that comes in other platform is not coming in MAC outlook. Also, the title is coming as wrong.\n \n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform - MAC\n* Host - Outlook\n* Operating System: MAC\n \n## Expected behavior\nThe title and the title logo should come in MAC Outlook as it is coming in OWA and Windows New Outlook.\nFor MAC + Windows OWA, it is displayed as below:-\n\n![Image](https://github.com/user-attachments/assets/ee50e808-7226-43eb-b192-2308545d4235)\n\nHowever for the MAC Outlook app, the header icon and app display name is not shown correctly.\n\n## Current behavior\n1. Logo is not shown in the task pane header.\n2. Display name is not shown in the task pane header.\n3. The dropdown title is being shown in the task pane header.\n4. The task pane behaviour is inconsistent between Mac Outlook and other platforms.\n\n<img width=\"1280\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/81413294-f17f-4563-8dc6-89ed5b97bce7\" />\n \n## Steps to reproduce\n \n1. Compose a Mail in MAC Outlook.\n2. Enter a recipient and click on send.\n3. task pane will appear, check for title logo and title.\n \n \n",
    "created_at": "2025-03-19T12:07:53Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "alankrit-singh-8",
    "comments": [
      {
        "author": "rajjha-msft",
        "body": "The task-pane name being different in Mac vs other platforms is by design. If you want to raise a feature request to make it same, find the details below. \nWe track Outlook add-in feature requests on our [Tech Community Page](http://aka.ms/M365dev-suggestions). Please submit your request there and choose the appropriate label(s). Feature requests on Tech Community are considered, when we go through our planning process.\n\nFor the second issue of drop down having different strings, can you please share a test add-in where we can repro it. \nYou can share a manifest or create a private repo and share it with @exextoc.",
        "created_at": "2025-03-25T08:50:57Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-03-29T20:21:49Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-01T22:28:50Z"
      }
    ]
  },
  {
    "number": 5507,
    "title": "createDocument() Works on Desktop but Not in Word Online",
    "body": "Host: Word\nOffice version number: Latest\nOperating System: macOS\nBrowser: Google Chrome\n\nI’m developing a Word add-in using Office.js and encountered an issue with the createDocument() method. My code works as expected in the desktop version of Word, where it successfully creates and opens a new document. However, in Word Online, instead of opening a new document, I only see the popup message:\n\n\"This add-in is about to create a new document in your default folder on your current cloud repository.\"\n\nAfter that, no new document appears, and nothing seems to happen. Here is the relevant code snippet:\n```\nexport const createNewDocument = async (): Promise<void> => {\n  try {\n    await Word.run(async (context) => {\n      const newDoc: Word.DocumentCreated = context.application.createDocument();\n      newDoc.open();\n    });\n  } catch (error) {\n    console.error(\"Error creating document:\", error);\n  }\n};\n\n```\n\nMy questions are:\n\n1. Is context.application.createDocument() officially supported in Word Online?\n2. If it is supported, is there a workaround to ensure that the newly created document actually opens?\n3. If it’s not supported, is there an alternative method for creating and opening a new document in Word Online? ",
    "created_at": "2025-03-19T09:07:34Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Needs: author feedback",
      "Area: Word",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "dmytro-kachurynets",
    "comments": [
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "Thank you for letting us know about this issue. We will take a look shortly. Thanks.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-03-19T09:07:55Z"
      },
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #1745\n- #3096\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\nThe `application.createDocument()` method is not supported in Word Online. As the owner of the API mentioned, this API is not implemented in Word Online, so you cannot rely on it to create and open a new document in Word Online. [Reference: 'penglongzhaochina'](https://learn.microsoft.com/en-us/javascript/api/word/word.application?view=word-js-preview#word-word-application-createdocument-member(1))\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3096#issuecomment-1404465565\n- https://github.com/officedev/office-js/issues/3096#issuecomment-1418642912\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-19T09:08:29Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi @dmytro-kachurynets \nSorry for late. The \"Word.DocumentCreated\" class belong to the WordApiHiddenDocument1.4 which is desktop only api set. Currently only DocumentCreated.open() belong to Word api 1.3 which is supported in online. Thank you.",
        "created_at": "2025-03-20T05:57:51Z"
      },
      {
        "author": "dmytro-kachurynets",
        "body": "@penglongzhaochina Thank you for answer,  What's the point of showing popup \"This add-in is about to create a new document in your default folder on your current cloud repository.\"  ? it confuses users. ",
        "created_at": "2025-03-20T16:34:20Z"
      },
      {
        "author": "penglongzhaochina",
        "body": "Hi @dmytro-kachurynets ,\n\nOn the online side, only the DocumentCreated.open is supported. When you run your snippet it will pop up below two dialog:\n\n![Image](https://github.com/user-attachments/assets/bf5ef7de-14e3-4602-b767-f6902538c807)\n\n![Image](https://github.com/user-attachments/assets/89a49ad0-fc36-4710-9a84-8a981573834d)\n\nAnd after that the browser will navigate to the new document. Do you have the same behavior with me?",
        "created_at": "2025-03-21T07:03:03Z"
      }
    ]
  },
  {
    "number": 5505,
    "title": "Office.onReady and Office.initialize are not fired on Android Outlook App",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\nWe have a simple Office AddIn; that read the content of the current email and load data,\nThe addin works in Outlook Desktop, Outlook Web and iOS.\n\nWe have a problem with Android Outlook App:\nThe first time we access the addin, it works and it keeps working until outlook is closed.\nOnce we close Outlook and we re-open it, the AddIn is not working anymore.\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Android\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n \n## Expected behavior\nThe plugin will be loaded each time\n\n## Current behavior\nThe first time we access the addin, it works and it keeps working until outlook is closed.\nOnce we close Outlook and we re-open it, the AddIn is not working anymore.\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. Create the plugin with the attached source code\n2. Add the plugin as app in MS365 panel\n3. <wait for the deploy>\n4. Login to your account\n5. Select an email\n6. Click \"TEST PLUGIN\" (or the correct name)\n7. notice that the page content should include \"Office.onReady\" and \"document.onReady.onReady\"\n8. CLOSE OUTLOOK\n9. reopen outlook\n10. select an email\n11. Click \"TEST PLUGIN\" (or the correct name)\n12. notice that the page only shows \"start\"\n\n\n## Useful logs\n- Screenshots\n- Sample source\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n\n\noutput BEFORE outlook restart\n![Image](https://github.com/user-attachments/assets/7ae10df5-3177-4c29-8b2b-cc8f8e75ed77)\n\noutput AFTER outlook restart\n![Image](https://github.com/user-attachments/assets/acfae205-ddba-4c80-91c5-60bb1f850081)\n\nmanifest used to create addin\n[manifest.xml.txt](https://github.com/user-attachments/files/19323045/manifest.xml.txt)\n\nsimpler sample for the addin\n[page.html.txt](https://github.com/user-attachments/files/19323046/page.html.txt)",
    "created_at": "2025-03-18T16:07:55Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "softeamspa",
    "comments": [
      {
        "author": "dtentori",
        "body": "Same issue here, any updates? thanks",
        "created_at": "2025-03-24T11:40:06Z"
      },
      {
        "author": "rajjha-msft",
        "body": "Hey @softeamspa \n\nCan you please attach a video of the behavior ? Right now its not a repro for us. ",
        "created_at": "2025-03-25T06:58:53Z"
      },
      {
        "author": "dtentori",
        "body": "Hi, I attach a video of previously described issue. \nWe tested this scenario on many Android phones. \n\nhttps://github.com/user-attachments/assets/17879894-d6da-4048-b814-00e9cabf7a20\n\n1. In Outlook I open an email and activate a super-semplified version of our Outlook add-in (sources attached in previous posts) . \n2. We can see logs of Office initialization stuff: Office.initialize, Office.start etc.\n3. I close Outlook.\n4. I execute step 1 again\n5. as you can see there are no Office logs\n\nOur addin starts his activities from \"Office.initialize\" event and it works only if we don't close Outlook.\nTo restore normal behaviour we need to clean app data from Android \"apps\" settings. Outlook then asks for the account and works fine, until you close it...\nThis issue is not present in iOS platform.\n\nThanks\nDavide T.\n\n\n",
        "created_at": "2025-04-04T14:58:14Z"
      },
      {
        "author": "dtentori",
        "body": "@kumarshrey-msft @rajjha-msft were you able to reproduce? thanks",
        "created_at": "2025-04-09T14:31:38Z"
      },
      {
        "author": "mmanjaree-msft",
        "body": "@dtentori Could you try updating outlook app to version 4.2512 and see if issue persists. If it does, please collect logs and share. Steps mentioned here- https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues",
        "created_at": "2025-04-10T06:41:46Z"
      },
      {
        "author": "dtentori",
        "body": "incident ID: C2KTZD5E",
        "created_at": "2025-04-16T14:59:57Z"
      },
      {
        "author": "dtentori",
        "body": "any news? thanks",
        "created_at": "2025-04-23T12:05:31Z"
      },
      {
        "author": "shighosh-msft",
        "body": "Hi @dtentori - we are able to check the logs and it seems that is issue is with AppDomains used in your manifest. Can you please share the manifest used to repro this issue. Please consider creating a private repo on GitHub and sharing it with us.",
        "created_at": "2025-04-23T13:23:20Z"
      },
      {
        "author": "dtentori",
        "body": "\nI created a repo and sent you invitation\nhttps://github.com/softeamspa/test_addin\n\n",
        "created_at": "2025-04-23T14:30:31Z"
      },
      {
        "author": "whoanuragverma",
        "body": "@dtentori can you please add @exextoc to the private repo? ",
        "created_at": "2025-04-29T09:47:29Z"
      },
      {
        "author": "mostafa3ly",
        "body": "Hi @softeamspa,\n\nIt looks like the issue with the Outlook app on Android can be resolved by modifying the URL in AppDomains in the manifest file. Please try removing /preprod (or any slash / and text after it) from the link. So instead of:\nhttps://xxx.xxxxxx.it/preprod\nUse:\nhttps://xxx.xxxxxx.it\n\nThis should fix the issue on Android Outlook. Let me know if this helps!",
        "created_at": "2025-04-29T14:24:08Z"
      },
      {
        "author": "dtentori",
        "body": "Solved! thank you very much for support... \nIt would have been helpful to have an error/warning in the logs or something like that...\nregards, Davide",
        "created_at": "2025-05-05T13:13:03Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-09T16:28:49Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-05-12T18:03:27Z"
      }
    ]
  },
  {
    "number": 5502,
    "title": "Office.context.mailbox.item.removeAttachmentAsync() call fails when removing attachments from multiple drafts",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Office on the web\n* Host [Excel, Word, PowerPoint, etc.]: ______\n* Office version number: ______\n* Operating System: Mac\n* Browser (if using Office on the web): Chrome\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\n\nThe attachments should be removed successfully from each draft.\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nCurrently the attachments fail randomly, and the following error shows up on Outlook: \"The following attachments couldn't be deleted: <Attachment_Name>. Please try again later.\" when we check the errors with the api (https://outlook.office.com/owa/service.svc?action=DeleteAttachment&app=Mail&n=<x>), the response status code is **200** however when we take a look at the response there is a mismatch in the change key **\"The send or update operation could not be performed because the change key passed in the request does not match the current change key for the item., Cannot save changes made to an item to store.SaveStatus: IrresolvableConflict\\r\\nPropertyConflicts:\\r\\n\"**\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1.  Create multiple drafts \n2. Add attachments in each draft 4+\n3. Switch between drafts\n4. Open a draft and remove all attachments\n5. Open another draft and remove attachments till you run into the problem\n\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\n\nThe attachments are automatically removed by our add-in when the user clicks send. However, with this error the send button remains greyed out and the user remains stuck. This is negatively impacting a significant user base for our add-in. \n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [x] Screenshots\n- [ ] Test file (if only happens on a particular file)\n\n![Image](https://github.com/user-attachments/assets/f76d4ce8-94ad-422d-b99b-e44c0786f4f2)\n\n![Image](https://github.com/user-attachments/assets/abd73611-aae8-4724-a80a-1d51a26bb5a0)\n\n<img width=\"760\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/19ab4960-27b0-4245-b221-83971d080020\" />\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-03-18T13:09:08Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Outlook",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "MehakFatima24",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #5309\n- #1746\n- #4610\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nThis issue is mostly happening because the mail item is being saved by two entities (removeAttachments and setCustomProperties), sometimes causing a conflict at the server side. Implement the logic of retries while removing the attachments. Run a loop for 3 retries, if successful exit the loop, else delay the next retry by 1 or 2 seconds. This should resolve the issue.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4610#issuecomment-2430899699\n- https://github.com/officedev/office-js/issues/4610#issuecomment-2446356541\n### Solution 2:\nThe issue may be related to notification messages not having a unique ID across different drafts. Ensure that each notification message has a unique ID to avoid conflicts.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/1746#issuecomment-805276917\n- https://github.com/officedev/office-js/issues/1746#issuecomment-805279996\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-18T13:09:49Z"
      },
      {
        "author": "arpitsangwanmsft",
        "body": "Hey @MehakFatima24 !\nCan you please help with a couple of questions for better understanding the issue: \n\n- Does your Add-in use onMessageSend event?\n- When do you fetch the attachmentIds(assuming through getAttachmentssync()) used to call removeAttachmentAsync()?\n- Does the Add-in have a retry logic to delete attachments? (Though I acknowledge that the 200 response might be misleading in that scenario), if yes, are you able to delete the attachment after retrying ?\n\nIt would be really helpful If you can provide us with a sample addin through which we can repro this scenario, if not possible can you please provide sample code of how your Add-in is setup and has been calling above mentioned APIs?\n\nThanks\n",
        "created_at": "2025-03-19T05:09:12Z"
      },
      {
        "author": "MehakFatima24",
        "body": "Hi @arpitsangwanmsft \n\n- The addin doesn't use onMessageSend event, it uses onItemSend\n- Yes we use getAttachmentasync to fetch the attachments and removeAttachmentAsync to remove them\n- The addin does not have a retry logic in place but since we can reproduce this issue when we try to retry manually to remove these attachments it does not work in many cases specially with images. Also as you mentioned the 200 response is misleading since the method does not fail and its hard to know when something went wrong.\n\nHere's a snippet of the code that we use to remove the attachments once the message is sent.\n\n<img width=\"682\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/cb1526df-06b4-4172-8bdb-a71a6d15e534\" />",
        "created_at": "2025-03-19T11:02:18Z"
      },
      {
        "author": "lnnrtngl",
        "body": "@exextoc, @arpitsangwanmsft \n\nThis issue is a critical blocker for our users transitioning from Outlook classic to OWA. The inability to reliably remove attachments from drafts is causing significant disruption, as users are unable to send these emails\n\nThe problem persists even with manual retries, especially with image attachments, and the misleading 200 response complicates debugging..\n\nCurrently this is undermining user confidence in the new OWA interface and impacting productivity significantly for our users\n\nWe need a resolution or workaround. Any updates or tips on this would be greatly appreciated",
        "created_at": "2025-03-19T11:53:02Z"
      },
      {
        "author": "arpitsangwanmsft",
        "body": "Hey @lnnrtngl/ @MehakFatima24!\nWe tried to repro above mentioned scenario with multiple drafts containing multiple attachments as mentioned in the repro step with the provided code snippet but could not repro it. \n\nFor faster diagnosis could you please create a sample addin with which you can repro and share the addin with us. Also please include a screen recording of the repro scenario if possible. \nWithout the sample addin and recording, I am not sure where event.completed has been called, what kind of attachments are involved and a few other ambiguities. \n\nAlso, can you please confirm, does the office.js removeAttachmentAsync api also return success in case attachment deletion fails?\n\nThanks \n",
        "created_at": "2025-03-19T18:53:48Z"
      },
      {
        "author": "MehakFatima24",
        "body": "@arpitsangwanmsft I have shared a private [repo](https://github.com/MehakFatima24/office-js) with you, it has the video with reproduction steps. I am  also creating a scriptlab snippet for you to reproduce the issue \n\nto answer your question. Yes,  office.js removeAttachmentAsync returns success. ",
        "created_at": "2025-03-20T12:48:39Z"
      },
      {
        "author": "arpitsangwanmsft",
        "body": "Hey @MehakFatima24!\nGeneral attachment deletion failure as showcased in shared video, is not governed by office.js APIs.\nThis forum is limited to office-js related queries. For Outlook specific queries and support please post your questions here -  https://support.microsoft.com/home/contact.\n\nHowever, we can assist if removeAttachmentAsync is returning success in this scenario. On basis of which, retry logic can be implemented. \n",
        "created_at": "2025-03-20T13:05:58Z"
      },
      {
        "author": "MehakFatima24",
        "body": "@arpitsangwanmsft as shared in the screenshots above this is an office.js api failure but it returns a 200 status, I have also attached screenshots of the response from office js above.\n\nKindly elaborate on how to implement the retry mechanism when the removeAttachmentAsync is successful? \n\nthis is the api endpoint (\nhttps://outlook.office.com/owa/service.svc?action=DeleteAttachment&app=Mail&n=179) and the error I get is \"The send or update operation could not be performed because the change key passed in the request does not match the current change key for the item., Cannot save changes made to an item to store.SaveStatus: IrresolvableConflict\\r\\nPropertyConflicts:\\r\\n\", in the request response with 200 status.\n\n<img width=\"846\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/4119d4ba-274f-45fb-9e77-759c84624db4\" />\n\n",
        "created_at": "2025-03-20T14:33:09Z"
      },
      {
        "author": "MehakFatima24",
        "body": "@arpitsangwanmsft I have uploaded the code for a sample addin in the same [repository](https://github.com/MehakFatima24/office-js). ",
        "created_at": "2025-03-20T14:53:30Z"
      },
      {
        "author": "rajjha-msft",
        "body": "Hey @MehakFatima24 \n\nCan you please share it with @exextoc ?",
        "created_at": "2025-03-25T05:57:00Z"
      },
      {
        "author": "rajjha-msft",
        "body": "I went through the shared add-in and it has no OnSend logic. The only extension point it covers is read. \nPlease share an add-in which can be used to repro the issue. ",
        "created_at": "2025-03-25T06:38:03Z"
      },
      {
        "author": "MehakFatima24",
        "body": "@rajjha-msft , the original add-in does have the on-send logic but as you see in the video, the on-send event is not triggered and the bug can be reproduced without the user clicking send button. ",
        "created_at": "2025-03-25T09:31:34Z"
      },
      {
        "author": "MehakFatima24",
        "body": "I have shared the access with @exextoc and @rajjha-msft!",
        "created_at": "2025-03-25T09:39:50Z"
      },
      {
        "author": "lnnrtngl",
        "body": "Hey @exextoc, @rajjha-msft, can we have an update on this?\n\nThis is impacting productivity significantly for our end users.. It would be great if there is a workaround or fix on this",
        "created_at": "2025-03-27T15:23:02Z"
      },
      {
        "author": "rajjha-msft",
        "body": "Hey @lnnrtngl \n\nI did see the video and receive the add-in. \nI can see the error happens when we try to remove attachments form the drafts. \nAnd I unsderstand the use case, due to the same there are issues with ItemSend. \n\nUnfortunately, we are not able to reprouce the issue at our end, and we do not own the internal atatchment Apis. \nBut are working to loop in the right set of people for the same. \n\nBefore that, can you please answer the questions below \n- Does this happen always, and is a consistent repro ?\n- Was this working fine before ?\n- Does the add-in work fine for other clients ?\n\nApologies for the delay here.",
        "created_at": "2025-03-27T15:46:50Z"
      },
      {
        "author": "MehakFatima24",
        "body": "Hi @rajjha-msft ,\n\n- yes this happens always, when you try to remove multiple attachments from an email draft\n- This issue has become more noticeable in the recent past, not entirely sure when this started happening\n- The issue is even worse for the new outlook\n",
        "created_at": "2025-03-27T15:57:16Z"
      },
      {
        "author": "lnnrtngl",
        "body": "Hey @rajjha-msft, can we have a follow-up on this?",
        "created_at": "2025-04-03T09:44:16Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @MehakFatima24,\n\nWe were able to reproduce this bug. Upon investigation, we identified this as a manifestation of bug #4610. I am closing this as duplicate, you can folllow #4610 for future updates. \n\nTo help you get unblocked in the meantime, can you add a callback in the `removeAttachmentAsync` API where you can call `getAttachmentsAsync` to fetch list of available IDs to check if any of the attachments which should have been removed still persist, and subsequenlty remove them?",
        "created_at": "2025-04-04T07:54:59Z"
      }
    ]
  },
  {
    "number": 5501,
    "title": "Issue: getAsync Returns <span> Instead of <div> When Retrieving Long Email Body in Outlook Add-in (Modern Browsers)",
    "body": "**Description:**\nWe are encountering an intermittent issue with `Office.context.mailbox.item.body.getAsync` when retrieving email body content after composing a new email with a long text input (e.g., 99,999 characters). Instead of maintaining the original `<div>` structure, the content is sometimes unexpectedly wrapped inside a `<span>` element. However, in some cases, it works fine and retains the expected `<div>` structure.\n\n**Steps to Reproduce:**\n\n1. Compose a new email manually in Outlook.\n2. Add long text (99,999 characters) in the email body, ensuring it is formatted inside `<div>` elements.\n3. Call `getAsync` to retrieve the email body:\n\n`Office.context.mailbox.item.body.getAsync(Office.CoercionType.Html, (result) => {  `\n   ` console.log(result.value);  `\n`});`\n\n**Actual Output (In Modern Browsers) (Mostly Happens):**\n\n`<span style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);\">`\n  `Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis `\n ` parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem...`\n`</span>`\n\n**Expected Output  (Sometimes Works Fine as Expected):**\n\nThe original `<div>` structure should be retained:\n\n`<div style=\"color: black;\">`\n ` <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor...</p>`\n`</div>`\n \n\n**Environment Details:**\n**Browser:** Chrome, Edge, Safari (Modern Browsers)\n**Platform:** Outlook Web Add-in\n\n**Observations:**\nThis issue only occurs in browsers and not in desktop Outlook.\nThe `<div>` structure is maintained for smaller email bodies.\nFor very long email content (99,999 characters), `<div>` elements are sometimes replaced with `<span>`, but other times they are retained correctly.\n\n**Request for Support:**\n- Is this behavior expected when retrieving long email content in browsers?\n- If this is a bug, can it be addressed in an upcoming release?\n- Is there an official workaround to ensure `<div>` elements are retained when using getAsync?\n\nLooking forward to your response.",
    "created_at": "2025-03-18T12:09:42Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "harshitgoyal1711",
    "comments": [
      {
        "author": "arpitsangwanmsft",
        "body": "Hey @harshitgoyal1711!\nIt is not expected for the Html structure to be the same when body is retrieved. Please refer to the [public docs for body.getAsync ](https://learn.microsoft.com/en-us/javascript/api/outlook/office.body?view=outlook-js-preview#outlook-office-body-getasync-member(2)) for more context. \nFor reference: \n![Image](https://github.com/user-attachments/assets/228cf727-44ce-4b42-a491-c0b56a2797d3)",
        "created_at": "2025-03-19T15:41:44Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-03-23T17:40:26Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-03-26T19:21:15Z"
      }
    ]
  },
  {
    "number": 5499,
    "title": "Syncing EWS UpdateItem Changes to Compose Pane in Exchange On-Prem Outlook Add-in (Office JS ≤ 1.5)",
    "body": "I am developing an Outlook add-in for Exchange On-Premise accounts using Office JS. However, since Exchange On-Prem only supports Office JS versions ≤ 1.5, many Office JS APIs are unavailable for certain tasks. As a workaround, I’m using the EWS API to perform operations like adding attachments to an email, and I trigger this EWS API call using Office.context.mailbox.makeEwsRequestAsync. While I receive a successful response from the EWS API, indicating that the changes are applied on the Exchange server, the updates are not reflected in the Outlook compose pane UI. For example, when using the UpdateItem API to add attachments, the attachments are successfully added on the server, but they do not appear in the compose pane. Is there a way to sync or refresh the compose pane after performing operations like UpdateItem in EWS so that changes, such as attachments, are immediately visible in the UI? Any suggestions or workarounds would be greatly appreciated.",
    "created_at": "2025-03-17T16:40:24Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Resolution: question answered"
    ],
    "author": "backupsdkjjdie",
    "comments": [
      {
        "author": "Oleg-O",
        "body": "Unfortunately, no, there is no way to force sync or refresh. This is one of the reasons we've been adding more capabilities in the JS API in compose so that add-in developers wouldn't have to deal with this kind of issues. But new JS APIs are only available online.",
        "created_at": "2025-03-17T19:16:18Z"
      }
    ]
  },
  {
    "number": 5496,
    "title": "Can't upload manifest.xml to 365 admin Center",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\nHello everyone, and thank you in advance for your help. I've been working all week on a manifest.xml and a function.js. The goal is simple: create a button in the Outlook ribbon to open a predefined URL.\n\nAfter having my manifest validated twice by Yeoman, I tried to upload it via the admin console. I can see the project appear. I only selected my user to run a test before pushing it to all the company's users. I can see the logo, the publisher's name, etc., but when it came time to deploy, here's the error code: \"This operation failed. Here are the possible reasons: Learn more about the eligibility requirements.\" I've seen a lot of posts on this topic but no clear answer. Can you help me?\n\n\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: Office on web\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Operating System: Windows\n* Browser (if using Office on the web): Chrome\n \n## Expected behavior\nTell us what you expected to happen --> Can i say work?\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. Upload Manifest\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? --> Upload manifest.xml \n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [x] Console errors\n- [ ] Screenshots\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends.",
    "created_at": "2025-03-15T15:33:22Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Resolution: question answered",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "PierreAdmin",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #4335\n- #3214\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nHi @FreeSoftwareServers! Apologies for the delay in response here. It helps our team to debug the issue if we have a network trace. However, we understand the limitations you might have on your side to get new software deployed. In such case, we'll try to trace the issue from our back end logs. For that could you please try this again and share error message with ID? Appreciate your patience and collaboration!\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3214#issuecomment-1590489375\n### Solution 2:\nHi @FreeSoftwareServers, Update on this one: I checked logs around that date \"July 19 2023 12:38 Vancouver time\", and I found the root cause of the issue being the tenant is a multi-forest tenant and the org mailbox is in some different forest and the admin's mailbox is in some different forest. This caused failure in deployment as we didn't have support for this scenario. Good news is that, this week only, we rolled out the changes which allows the above scenario to work. So, the deployment should work fine now for your admin user. Please try again and let us know if there are still any issues, otherwise we can mark this issue as closed.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3214#issuecomment-1683414488\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-15T15:34:20Z"
      },
      {
        "author": "PierreAdmin",
        "body": "I already dead everything on this.. Never resolve my problem.. 🥲",
        "created_at": "2025-03-15T17:07:31Z"
      },
      {
        "author": "PierreAdmin",
        "body": "Update, \n\nI contacted the tenant admin, who was able to upload the file but encountered an error (Echec, manifest not OK): \n\n![Image](https://github.com/user-attachments/assets/5fad604d-76f3-42c5-8bf3-7026bdf09a25)\n\nI don't understand how the file can have this error when it was configured AND validated by Yeoman...\n\nYou can find the manifest.xml file on my Github/addin\n",
        "created_at": "2025-03-17T13:02:20Z"
      },
      {
        "author": "Oleg-O",
        "body": "It appears there are a few things wrong with your manifest:\n1. there is an unexpected requirement set with name \"OpenBrowserWindowApi\" - please remove it\n2. all 3 icon resid values (e.g., \"Icon16\") don't match the id values in the Resources section (e.g. \"Icon.16x16\")\n3. SuperTipDescription appears in ShortStrings resources but should be in LongStrings resources\n\nHave you made these modifications in your manifest by any chance? Once I fix these, your manifest installs successfully.\n\nHope this helps.\n\nUnfortunately, the validator tool only mainly checks the XML schema and does not check all the things that actual ingestion pipeline checks, and mismatched IDs and unexpected requirement sets are among them.",
        "created_at": "2025-03-17T21:07:35Z"
      },
      {
        "author": "PierreAdmin",
        "body": "Hello @Oleg-O \n\nThanks for help, i appreciate. \n\nI'm a complete novice with XML; the OpenBrowser API part was taken from another codebase...\n\nFor the images, it's a format error. I had modified it in my version 4. However, the LongStrings are a good idea. I'll upload it to the office tomorrow and will be sure to keep you informed if everything is OK.\n\nFor the process, I found some great inspiration here:\n\nhttps://medium.com/nexl-engineering/part-3-open-link-from-a-ribbon-button-building-outlook-add-in-with-react-a49fc130810",
        "created_at": "2025-03-17T22:34:49Z"
      },
      {
        "author": "PierreAdmin",
        "body": "@Oleg-O \n\nSorry for the inconvenience, I had also made another modification, FunctionFileUrl pointing directly to the JS, it was not a problem? Because in my last version, I pointed it to a .html (as indicated on the microsoft website, and in the html, there is the JS path.",
        "created_at": "2025-03-17T23:11:29Z"
      },
      {
        "author": "Oleg-O",
        "body": "That would be a problem at runtime, it's not something we check and enforce at installation. Yes, it should be pointing at an HTML as described in the [FunctionFile element documentation](https://learn.microsoft.com/en-us/javascript/api/manifest/functionfile?view=common-js-preview).",
        "created_at": "2025-03-18T00:09:51Z"
      },
      {
        "author": "PierreAdmin",
        "body": "@Oleg-O Thanks for your help, indeed, the add-in uploads fine!!\n\nHowever, nothing happens when I click the button, so I think I did it all for nothing...\n\nI have no knowledge of .js, even me with HTML that redirects to a .js file. If you have any ideas (even if you're not here for that, I know)",
        "created_at": "2025-03-18T10:24:20Z"
      },
      {
        "author": "PierreAdmin",
        "body": "Update : The software did not appear even though it was deployed via the admin console... So I uploaded the manifest.xml manually, it appeared only once, since then I no longer see it :'(",
        "created_at": "2025-03-18T10:54:36Z"
      },
      {
        "author": "Oleg-O",
        "body": "In the JS file, the function you defined is called `openTicketing`, but in the `associate `call, the 2nd parameter has the value of `openTicketingTool`. These should match for things to work. This is described in the documentation I mentioned.\n\nRegarding admin deployment, those can take up to 3 days, depending on deployment method, to appear for users in your tenant. Manual deployment by a user should work. Does it still not appear? Which Outlook client are you using?",
        "created_at": "2025-03-18T17:44:58Z"
      },
      {
        "author": "PierreAdmin",
        "body": "Hello @Oleg-O Thank you for your help. I noticed the error in the \"Opening...\" wording. It's been corrected, and it should work. Unfortunately, no, the deployment via the admin console still doesn't appear (I know this because I put myself and a tech in the deployment, and neither of us has it). So I tried uploading it manually. It worked once, but since the button wasn't working, I deleted and re-added the component. Since then, the button hasn't appeared. 😢\n\nWe use Outlook 2016 client",
        "created_at": "2025-03-18T19:37:41Z"
      },
      {
        "author": "PierreAdmin",
        "body": "Hello @Oleg-O  It's good, the button is deployed! But once again, when you click on it, nothing happens, I don't know if it's an error in the manifest, or something else, I'm lost, too bad this project is going to fall through",
        "created_at": "2025-03-19T12:59:19Z"
      },
      {
        "author": "Oleg-O",
        "body": "@PierreAdmin the manifest is not in your repo anymore - can you share the latest, I can take a look and maybe find out why nothing happens?",
        "created_at": "2025-03-21T22:00:51Z"
      },
      {
        "author": "PierreAdmin",
        "body": "> @PierreAdmin the manifest is not in your repo anymore - can you share the latest, I can take a look and maybe find out why nothing happens?\n\nHello @Oleg-O My bad, everything is fine now. I've made the product available on my production Github -> https://github.com/Grujowmi/Outlook-OURB Thank you for your help.",
        "created_at": "2025-03-21T22:15:26Z"
      },
      {
        "author": "Oleg-O",
        "body": "Do you have a deployed version too, by any chance? The manifest and sources have placeholders in it like \"target-url\", etc. For example, in your html, the placeholder reference to the JS looks like this: \"https://URL-JS-SCRIPT.com\". Note, it should be full path to JS not just the domain. Is that the problem? It's a bit hard to say what's wrong by looking at code before some processing happens on it - does this make sense?",
        "created_at": "2025-03-24T23:07:01Z"
      },
      {
        "author": "PierreAdmin",
        "body": "Hey @Oleg-O , I have a deployed version that works perfectly. I'll change the placeholders today to make the code more readable.",
        "created_at": "2025-03-25T06:11:53Z"
      },
      {
        "author": "Oleg-O",
        "body": "> deployed version that works perfectly\n\nare you saying this is now working for you? Can you clarify?",
        "created_at": "2025-03-25T21:05:02Z"
      }
    ]
  },
  {
    "number": 5492,
    "title": "Insert a texture or picture as a fill inside a geometric object.",
    "body": "# Issue\nThe issue I am facing is that I am unable to set the type of the shape fill. Additionally, even if I were able to change the fill type, I would like to set it to a picture or texture.\n\nI am attaching the document that explains the use case:\n\n[https://docs.google.com/document/d/1bSETTuQnZMRzT5W_kQr4AT1OKyWrJAUcBXSqCjQtKqg/edit?usp=sharing](url)",
    "created_at": "2025-03-14T13:00:34Z",
    "state": "closed",
    "labels": [
      "Needs: author feedback",
      "Type: product feature request",
      "Area: PowerPoint"
    ],
    "author": "anmirza",
    "comments": [
      {
        "author": "guoms1",
        "body": "Hi, @anmirza \n\nThanks for reaching out! Currently, the information provided is a bit limited, making it difficult for us to clearly identify or reproduce your issue.\n\nTo better assist you, could you please provide additional details following the issue template, particularly:\n- Which specific Office app you're experiencing this issue with (e.g., PowerPoint, Word, Excel)?\n- The platform you're experiencing this issue on (e.g., Web, Windows, Mac).\n- A clear description of the repro steps, expected vs. actual behavior.\n- A minimal demo project or Script Lab snippet demonstrating the issue would be very helpful.\n\nThanks for your cooperation—we look forward to resolving this quickly for you!\n\nBest,",
        "created_at": "2025-03-17T02:03:57Z"
      },
      {
        "author": "anmirza",
        "body": "Hi, @guoms1\n\n- For all OS and web\n- The application is Powerpoint\n- I was doing it with shapefill and I did not find any fill other than solid\n- I cant provide a snipit right now.",
        "created_at": "2025-03-17T16:45:17Z"
      },
      {
        "author": "guoms1",
        "body": "Hi, @anmirza \n\nOh, got it! You're saying the Office JavaScript API doesn't currently support this functionality.\n\nIf that's the case, we track Office Add-in feature requests on our [Microsoft 365 Developer Platform Ideas Forum]( https://aka.ms/m365dev-suggestions). You can check if someone else has already requested this feature. If not, feel free to submit your request there! Feature requests on are considered when we go through our planning process. \n\nThanks",
        "created_at": "2025-03-18T06:03:33Z"
      },
      {
        "author": "guoms1",
        "body": "Close it as it is a feature request and directed customer to our [Microsoft 365 Developer Platform Ideas Forum](https://aka.ms/m365dev-suggestions).",
        "created_at": "2025-03-24T06:47:49Z"
      }
    ]
  },
  {
    "number": 5488,
    "title": "Upload a file from the PC",
    "body": "Hello team,\n\nWe make Excel add-ins by JavaScript API.\n\nWe would like to build a feature which enables users to upload their (Excel or word or PDF) files from their PC to the add-in: Users click on a button \"upload\" in the add-in, a window popups where users can navigate the file system of their PC, then users choose the file, then the file is uploaded to their account of the add-in.\n\nIs there any API to do so?\n\nThank you\n\nTie",
    "created_at": "2025-03-14T04:00:42Z",
    "state": "closed",
    "labels": [
      "Needs: triage :mag:"
    ],
    "author": "chengtie",
    "comments": [
      {
        "author": "guoms1",
        "body": "Hi, @chengtie \n\nThank you for this question. \n\nTo better assist you in the future, we suggest you go to [Stack Overflow](https://stackoverflow.com/questions/tagged/office-js) <change tag if appropriate> and see if your question has already been asked or ask a new question. This will allow both the community to help, and allow us to ensure the community can see our answer. When added, please let us know and we will follow up there.  Thanks, Microsoft 365 Developer Platform team. \n\nBests,",
        "created_at": "2025-03-14T09:08:37Z"
      }
    ]
  },
  {
    "number": 5487,
    "title": "Outlook Add-in - Call to mailbox.getUserIdentityTokenAsync returning undefined token for only some Outlook accounts",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\nI am working on a previously fully-functional Outlook Add-in that is having issues retrieving the mailbox.getUserIdentityTokenAsync only for some Outlook accounts.\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform: PC desktop, Mac\n* Host: Outlook\n* Outlook version number: 16.95\n* Operating System: MacOS Sequoia\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nAll Outlook accounts are able to successfully retrieve an ExchangeIdentityToken upon calling: Office.context.mailbox.getUserIdentityTokenAsync()\n\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nSome accounts (no discernable pattern) fail to retrieve the token and produce the following error response:\n\"Internal protocol error: '-2147467259'.\"\nand \"AccessRestricted\".\n\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. Use a random Outlook test account\n2. Initialize add-on with call to Office.context.mailbox.getUserIdentityTokenAsync()\n3. Check (using web inspector or debugger) to see if a token has sent in the response.\n",
    "created_at": "2025-03-13T23:12:30Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "madhukar4e",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #3299\n- #1692\n- #3845\n- #4583\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nThis should be resolved. Please let us know how that looks for you now. Apologies for the disruption.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4583#issuecomment-2207447721\n### Solution 2:\nFrom your sample code you do not appear to be registered for item change events. If you want to support pinning, you need to call addHandlerAsync() with the itemChanged event. I've created a short ScriptLab gist file with an example here: https://gist.github.com/exextoc/cdda502b27dbb69bfd98a9e5b12f4767\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/1692#issuecomment-791763355\n### Solution 3:\nDepending on your scenario, you can have `useEffect` in both initialize and the addHandlerAsync. A number of things could stop working if AddHandlerAsync / ItemChanged is not included with a pinnable taskpane, even though `getUserIdentityTokenAsync()` does not depend on the item. Calls to `getUserIdentityToken` should succeed once you include `addHandlerAsync()` no matter when they were called.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/1692#issuecomment-796300658\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-13T23:13:17Z"
      },
      {
        "author": "madhukar4e",
        "body": "<img width=\"413\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/f2f60029-86ea-4328-a339-a4caed43d723\" />",
        "created_at": "2025-03-14T00:02:32Z"
      },
      {
        "author": "jedmonsanto",
        "body": "any news about the error? Mine has something like this:\n\n![Image](https://github.com/user-attachments/assets/0a02c6f7-5359-4e15-9fa0-a0c5fa79ddd9)",
        "created_at": "2025-03-17T08:37:51Z"
      },
      {
        "author": "davidchesnut",
        "body": "Hi @madhukar4e and @jedmonsanto,\n\nWe're currently turning off legacy Exchange Online tokens across all tenants (unless admins have opted to keep tokens on.) The rollout is user by user, so you will see some requests fail while working for other users. It's possible this is why you are seeing the behavior. \n\nYou can confirm if this is the case by having the user load Script Lab and run a snippet that calls getUserIdentityTokenAsync (see the [instructions in the FAQ](https://learn.microsoft.com/office/dev/add-ins/outlook/faq-nested-app-auth-outlook-legacy-tokens#check-if-tokens-are-off-by-using-script-lab)). \n\nYou need to move your add-in off of Exchange Online tokens and use Entra ID tokens with Microsoft Graph. For now you can ask the admin to turn tokens back on (see [Turn legacy Exchange Online tokens on or off](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/turn-exchange-tokens-on-off). But this will only leave tokens on until June 2025. \n\nFor complete details on the timeline and actions to take, see the [Nested app authentication and Outlook legacy tokens deprecation FAQ](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/faq-nested-app-auth-outlook-legacy-tokens).\n\nLet us know if you have any questions about migrating to Entra ID. \n\nThanks!\nDavid",
        "created_at": "2025-03-21T23:25:52Z"
      },
      {
        "author": "davidchesnut",
        "body": "Will close this issue, but please let us know if you have any further questions. Thanks!",
        "created_at": "2025-03-27T16:59:28Z"
      }
    ]
  },
  {
    "number": 5483,
    "title": "Outlook, setSignatureAsync method adds a new signature but does not replace the existing one",
    "body": "# Provide required information needed to triage your issue\nIn an Outlook add-in for Compose mode, we use the setSignatureAsync method to add a new signature, or replace the existing one. In practice, it adds a new signature to an email draft without removing the existing one, if the draft already contains a signature created with the same method but in another Outlook platform, e.g. Outlook Online.\n\n## Your Environment\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC desktop, Mac, Office on the web\n* Host: Outlook\n* Office version number: \n* Operating System: Windows & MacOS\n* Browser (if using Office on the web): Google Chrome\n \n## Expected behavior\nAccording to documentation, the setSignatureAsync method shall replace an existing signature.\nhttps://learn.microsoft.com/en-us/javascript/api/outlook/office.body?view=outlook-js-preview#outlook-office-body-setsignatureasync-member(1)\n\n## Current behavior\nThe setSignatureAsync method adds signatures, but not replaces the existing one.\n\n## Steps to reproduce\n1. Open Outlook Online, create a new email, open the add-in pane and execute the following code:\n`Office.context.mailbox.item.body.setSignatureAsync(\"<div>My signature \" + (new Date().toString()) + \"</div>\", { coercionType: Office.CoercionType.Html }, () => { });`\n\n2. Make sure the draft with the signature is saved, and then close the draft.\n3. Start classic Outlook, open that draft email, open the add-in pane and execute the code above. As you can see, now you have 2 signatures. Save draft, close it.\n4. Start the new Outlook, execute the code above for the same draft. Now you have 3 signatures, please see my screenshot below.\n\n# Provide additional details\n1. The steps above are taken on Windows, but you can do the same on Mac using Outlook Online and Outlook for Mac.\n\n## Useful logs\n- [ X ] Screenshots\n\n![Image](https://github.com/user-attachments/assets/ebe82bc3-409b-46f0-bb96-40ea06d18c5f)\n\n",
    "created_at": "2025-03-13T13:39:14Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity",
      "Similar-Issue"
    ],
    "author": "DmitryKostochko",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #4758\n- #1272\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-13T13:40:20Z"
      },
      {
        "author": "arpitsangwanmsft",
        "body": "Hey @DmitryKostochko!\nNative signatures are also appended and not replaced across clients (web/mac/classic), so this behavior is not governed/controlled by the setSignatureAsync office.js API. Irrespective of whether the setSignatureAsync api is used or not, same behavior can be observed.\n\nThis forum is limited to office-js related issues. For Outlook specific queries and support please post your questions here- https://support.microsoft.com/home/contact.\n\nMeanwhile for identifying if signature has been appended across clients please explore [RoamingSettings](https://learn.microsoft.com/en-us/javascript/api/outlook/office.roamingsettings?view=outlook-js-preview) if it suits your use case.\n\nThanks\n\n ",
        "created_at": "2025-03-18T11:22:43Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-03-23T17:40:28Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-03-26T19:21:17Z"
      }
    ]
  },
  {
    "number": 5482,
    "title": "Issue with setAsync and getAsync Modifying <div> Elements in Outlook Add-in (Modern Browsers)",
    "body": "**Description:**\nWe are encountering an issue with the Office.js APIs when setting and retrieving email body content in our Outlook add-in in modern browsers:\n\n`Office.context.mailbox.item.body.setAsync(pMailBody);`\n`Office.context.mailbox.item.body.getAsync(callback);`\n\n**Issue Details:**\nWhen setting the email body using `setAsync`, if the content contains a `<div>` element, it is altered upon retrieval using `getAsync`. The `<div>` element is either removed or modified unexpectedly in modern browsers.\n\n**Steps to Reproduce:**\n1. Without `id` Attribute\nSet the body using `setAsync`:\n\n`Office.context.mailbox.item.body.setAsync('<div style=\"color: red\"><p>Hello</p></div>');`\n\n**Retrieve the body using getAsync:**\n\n\n`Office.context.mailbox.item.body.getAsync((result) => {\n    console.log(result.value);\n});`\n\n**Actual Output:**\n\n\n`<p class=\"elementToProof\">`\n    `<span style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: red;\">Hello</span>`\n`</p>`\n`<div class=\"elementToProof\" style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);\"><br></div>`\n\n**Observation:**\n\nThe `<div>` is removed, and the styling is instead applied to a `<p>` tag.\n\n**2. With id Attribute**\nSet the body using `setAsync`:\n\n\n`Office.context.mailbox.item.body.setAsync('<div id=\"x_red\" style=\"color: red;\"><p>Hello</p></div>');`\n\n**Retrieve the body using getAsync:**\n\n\n`<div style=\"color: red;\" id=\"x_red\"><p>Hello</p></div>`\n`<div class=\"elementToProof\" style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);\"><br></div>`\n\n**Observation:**\n\nThe `<div>` is retained when an id is present.\nHowever, an extra `<div class=\"elementToProof\">` is still being added.\n\n**Reproducible Code Example:**\n\nThe following snippet reproduces the issue using jQuery and Office.js:\n\n\n\n$(\"#run\").on(\"click\", run);\n\nasync function run() {\n  var body;\n  await setbody(`<div style=\"color: red\"><p>Hello</p></div>`);\n  body = await getbody();\n  console.log(body.value);\n}\n\nasync function getbody() {\n  return new Promise(resolve => {\n    Office.context.mailbox.item.body.getAsync(Office.CoercionType.Html, res => {\n      resolve(res);\n    });\n  });\n}\n\nasync function setbody(body) {\n  return new Promise(resolve => {\n    Office.context.mailbox.item.body.setAsync(body, { coercionType: Office.CoercionType.Html }, res => {\n      resolve(res);\n    });\n  });\n}\n**Environment Details:**\nBrowser: Modern Browsers (e.g., Chrome, Safari)\n\n**Request for Support:**\nCould you confirm if this behavior is expected in modern browsers?\nIf this is a bug, can this be fixed in an upcoming release?\nIs there an official workaround recommended by Microsoft?\nLooking forward to your response.\n",
    "created_at": "2025-03-13T12:29:29Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Resolution: by design",
      "Status: no recent activity"
    ],
    "author": "harshitgoyal1711",
    "comments": [
      {
        "author": "rkpathak",
        "body": "@harshitgoyal1711 We are able to repro this at our end. Thanks for reporting this issue. It has been put on our backlog. We unfortunately have no timelines to share at this point\n\nInternal tracking id: Office: 5531000\n",
        "created_at": "2025-03-16T13:15:14Z"
      },
      {
        "author": "thad0ctor",
        "body": "I can confirm I am having this issue as well with outlook stripping divs and classes when I insert them into an email with Office.context.mailbox.item.body.setAsync",
        "created_at": "2025-03-17T18:28:53Z"
      },
      {
        "author": "mmanjaree-msft",
        "body": "@harshitgoyal1711 @thad0ctor We looked into this issue and unfortunately figured out that it is not expected for the Html structure to be the same when body is retrieved. Please refer to the [public docs for body.getAsync ](https://learn.microsoft.com/en-us/javascript/api/outlook/office.body?view=outlook-js-preview#outlook-office-body-getasync-member(2))for more context.\nFor reference:\n\n![Image](https://github.com/user-attachments/assets/202bc8db-4472-4ce8-9fa0-2bc3c318f2eb)\n\nAs this behavior is by design, this could be considered as a new feature request. \n\nWe track Outlook add-in feature requests on our [Tech Community Page](http://aka.ms/M365dev-suggestions). Please submit your request there and choose the appropriate label(s). Feature requests on Tech Community are considered when we go through our planning process.",
        "created_at": "2025-04-10T06:53:13Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-14T10:15:32Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-04-17T13:39:50Z"
      }
    ]
  },
  {
    "number": 5481,
    "title": "Office.context.mailbox.makeEwsRequestAsync return error code 9020",
    "body": "Since 12 March 2025, in our development mode, the makeEwsRequestAsync return fail with error  code 9020\nbut it still work on production so my question it is related NAA?\n\n\nhttps://learn.microsoft.com/en-us/office/dev/add-ins/outlook/faq-nested-app-auth-outlook-legacy-tokens\n\n`\n```\n\n<img width=\"355\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/011aa86f-6836-45d5-8695-6f736036fc75\" />\n\n```\nI would appreciated if you can quick reply. \n\n",
    "created_at": "2025-03-13T11:07:07Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "thanhtungka91",
    "comments": [
      {
        "author": "thanhtungka91",
        "body": "<img width=\"355\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/1d9065f9-80ac-43b4-b10c-ddd48de71fb7\" />",
        "created_at": "2025-03-13T11:07:47Z"
      },
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #4124\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\nThis issue is now resolved.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4124#issuecomment-1972615590\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-13T11:07:56Z"
      },
      {
        "author": "rkpathak",
        "body": "Follow this page to get the status of Exchange tokens:\nhttps://learn.microsoft.com/en-in/office/dev/add-ins/outlook/turn-exchange-tokens-on-off#get-the-status-of-legacy-exchange-online-tokens-and-add-ins-that-use-them\nIf AllowLegacyExchangeTokens is false, then this would cause the failure.",
        "created_at": "2025-03-13T11:32:55Z"
      },
      {
        "author": "thanhtungka91",
        "body": "@rkpathak \nthank you for the reply \nhere is my case \n```\nGet-AuthenticationPolicy -AllowLegacyExchangeTokens\nAllowLegacyExchangeTokens: (Not Set)\nAllowed: []\nBlocked: []\n```\nbase on the document mean it is off, so why it happened since 12 March (base on the document i should be invalid from February) and why it still work on production mode?\n",
        "created_at": "2025-03-13T14:35:45Z"
      },
      {
        "author": "pmasekito",
        "body": "Getting that same issue now when just last week that same unaltered ews request being sent was working just fine.",
        "created_at": "2025-03-13T20:18:48Z"
      },
      {
        "author": "thanhtungka91",
        "body": "event i set to true still same \n```\nSet-AuthenticationPolicy -AllowLegacyExchangeTokens -Identity \"LegacyExchangeTokens\"\nSuccess\n\nGet-AuthenticationPolicy -AllowLegacyExchangeTokens\nAllowLegacyExchangeTokens: True\nAllowed: []\nBlocked: []\n```",
        "created_at": "2025-03-14T01:47:55Z"
      },
      {
        "author": "thanhtungka91",
        "body": "@rkpathak \ni would like to know  the setting -AllowLegacyExchangeTokens  have to done in every  outlook user side or from our developer account?",
        "created_at": "2025-03-14T02:33:14Z"
      },
      {
        "author": "rkpathak",
        "body": "@thanhtungka91 Its been called out in the [FAQ](https://learn.microsoft.com/en-in/office/dev/add-ins/outlook/faq-nested-app-auth-outlook-legacy-tokens#what-happens-on-february-17th) that deprecation could take  several weeks to deploy to all users.\nRegarding Set-AuthenticationPolicy, it needs to be done for every tenant where the addin is deployed. After setting, it can take up to 24 hours before all requests from Outlook add-ins for legacy tokens are allowed.",
        "created_at": "2025-03-16T12:35:35Z"
      }
    ]
  },
  {
    "number": 5479,
    "title": "Outlook on Mac: `messageParent` Fails on Some Machines, Potentially Linked to `&action=displayDialog` vs. `_host_Info`",
    "body": "# Provide required information needed to triage your issue\nIn an Outlook add-in on Mac, `Office.context.ui.displayDialogAsync` sometimes appends `&action=displayDialog` to the dialog URL instead of the expected `&_host_Info=...`, which we see on all other platforms. On machines where `&action=displayDialog` appears, `messageParent` consistently fails to send messages from the child dialog to the parent task pane. On identical setups where `_host_Info` is used, `messageParent` works as expected. One machine consistently uses `&action=displayDialog` (and fails), while another uses `_host_Info` (and succeeds), despite matching Outlook versions, builds, add-ins, and URLs. This suggests an environmental factor, but we’re unsure if `&action=displayDialog` directly causes the `messageParent` failure or is just a symptom.\n\n## Your Environment\n* Platform [PC desktop, Mac, iOS, Office on the web]: Mac\n* Host [Excel, Word, PowerPoint, etc.]: Outlook\n* Office version number: 16.94.2 Build 25022327 (Latest)\n* Operating System: macOS Sequoia 15.3.1 (Latest)\n* Browser (if using Office on the web): N/A\n \n## Expected behavior\nI expect `Office.context.ui.displayDialogAsync` to consistently append `_host_Info` (e.g., `Outlook$Mac$16.00$nl-TR$telemetry$isDialog$$0`) to the dialog URL across all machines, enabling `messageParent` to reliably communicate from the child dialog to the parent task pane. If `&action=displayDialog` is intentional, I expect `messageParent` to still work.\n \n## Current behavior\nOn some machines, `&action=displayDialog` is appended to the dialog URL instead of `_host_Info`. On these machines, `messageParent` never sends messages from the child dialog to the parent task pane—no errors are logged, and the parent callback isn’t triggered. On machines where `_host_Info` is used, `messageParent` works correctly. While `&action=displayDialog` correlates with the failure, we’re not certain it’s the direct cause—it could be a related symptom of an underlying issue.\n\n## Steps to reproduce\nIt's hard to reproduce as it appears to be environment related.\n\n1. Open a dialog to remote page:\n```javascript\nconst authUrl = '<url to authentication page>';\nOffice.context.ui.displayDialogAsync(authUrl, {\n        height: resolution.y,\n        width: resolution.x,\n        displayInIframe: false,\n        promptBeforeOpen: false,\n    }, (result) => {\n        if (result.status !== Office.AsyncResultStatus.Succeeded) {\n            return;\n        }\n\n        let dialog = result.value;\n        dialog.addEventHandler(Office.EventType.DialogMessageReceived, async (arg) => {\n\t\tconsole.log('Message received from child', arg);\n        });\n    });\n```\n\n2. Perform a few internal redirects and call messageParent() from authUrl:\n\n```javascript\nOffice.onReady(() => {\n    Office.context.ui.messageParent(JSON.stringify({ message: \"Hello\" }), { targetOrigin: \"*\" });\n})\n```\n\n3. On one Mac, the URL becomes https://<url>?action=displayDialog, and no message is logged in the parent. On another identical setup, it becomes https://<url>?_host_Info=..., and the message is received by the parent.\n\n## Link to live example(s)\nNone.\n\n# Provide additional details\n* On Mac, messageParent fails when the dialog URL uses &action=displayDialog, but works with _host_Info.\n* On a failing machine + account combo, it always fails; on others, it always works.\n* Reproduction is rare and hard to debug, pointing to an environmental factor.\n* Outlook version/build is identical across machines, suggesting it’s not version-specific.\n* displayInIframe: true isn’t viable due to CSP/X-Frame-Options restrictions on the auth URL.\n\nQuestions:\n\n1. What triggers &action=displayDialog instead of _host_Info? Is it environmental (e.g., cache, account state), legacy behavior, or configurable?\n2. Does &action=displayDialog directly break messageParent, or is it a symptom of a deeper issue?\n3. Can we force _host_Info to ensure messageParent works?\n\n## Context\nOur Outlook add-in provides email encryption, requiring authentication via a remote website (Azure AD). This works across platforms, but on some Macs, messageParent fails, preventing authentication data from reaching the add-in. This blocks affected customers from using the service, and the inconsistency undermines reliability.\n\n* Edit:\nClarified the reproduction paragraph",
    "created_at": "2025-03-12T08:46:10Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "Visualq",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #1843\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\nI see the problem. On Excel desktop for the mac, you can't send a boolean value in the message. I changed true to \"true\" for my message and it worked. The docs say you can send either a boolean or a string so you might want to leave this open to fix or change the docs. booleans do work everywhere else.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/1843#issuecomment-837267868\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-12T09:44:04Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @Visualq,\n\nFirslty thanks a lot for sharing the details of the issue. We tried reproducing the issue at our end using the code snippet you provided but unfortunately we have been unable to get a repro so far. As you mentioned, it might be an environmental factor causing this, but as we are unable to reproduce the bug, it will be difficult for us to comment at this moment.\n\nIn the meantime: \n1. Can we collect logs from any of the impacted users following this [wiki](https://github.com/OfficeDev/office-js/wiki/Collecting-log-files-for-Outlook-Add%E2%80%90ins-issues#outlook-mac)\n2. Is it possible for you to share the sample manifest with @exextoc ? \n3. Do we know how frequent this scenario is?",
        "created_at": "2025-03-19T07:09:22Z"
      },
      {
        "author": "Visualq",
        "body": "Hi @kumarshrey-msft , \n\nThank you for investigating, I expected it would be a tough one to debug. Regarding your request:\n\n1. I will have to discuss this with the customer. It's good to know that it appears that all the users in that specific organisation/tenant (only the Mac users) suffer from the same problem. Also this does not appear to be a Microsoft account issue as we tried it with our own credentials on the customers machine and encountered the same problem. Will respond to this point regarding the logs tomorrow.\n\n2. Yes, @exextoc [manifest.xml](https://outlook.sm.secudoc.app/manifest.xml) in order to observe the dialog being opened. In order to test if messageParent is not working, credentials are required which I can provide privately. \n\n3. Not very often, so far this is the only customer suffering from the problem. We had it happen before much more frequent but that problem was due to an instant redirect (initiated from the backend) to another domain before initializing Office.js. Moving the redirect to client side and after the initialization of Office.js solved that problem for most Mac users. Perhaps this might give you some ideas. \n\nJust a quick question, what makes office.js open a dialog with &action=displayDialog?\n",
        "created_at": "2025-03-19T08:11:05Z"
      },
      {
        "author": "Visualq",
        "body": "@kumarshrey-msft We are unable to retrieve the diagnostics due to the missing \"Collect Diagnostics\". Nor do we have a windows machine nearby to 'remote' collect the diagnostics. We'll see what we we can do.",
        "created_at": "2025-03-20T07:27:23Z"
      },
      {
        "author": "Visualq",
        "body": "@exextoc we managed to obtain the incident ID:\n\nThese are two failed incident IDs:  9ASHZYQ7 / UMPPV92D \n\nAfter we made a new profile on the Mac it first didn't work however when we tried again on the new profile it suddenly worked. However switching back to the customers main profile it was still broken. This is the incident ID that did work in the new profile: AMVYNWUS (working)\n\n",
        "created_at": "2025-03-28T08:19:42Z"
      },
      {
        "author": "kumarshrey-msft",
        "body": "Hi @Visualq, \n\nThanks for sharing the incident ID. We are still not able to reproduce this bug at our end. Can you confirm if your add-in is hard-coding the re-direct URLs at any stage? Additionally, are you setting any property like [window.name](https://developer.mozilla.org/en-US/docs/Web/API/Window/name) explicitly in your flow? This can be one of the reasons behind this unexpected scenario. \n\nIn the meantime, will it be possible for you to share the repro video as well with @exextoc in a private GitHub repo?",
        "created_at": "2025-04-01T07:41:41Z"
      },
      {
        "author": "Visualq",
        "body": "@kumarshrey-msft the base url is always the same, once the url is loaded in the dialog we check if a redirect is needed (to a different domain). If it is we redirect the user to that domain to complete authentication. However even without the domain redirect it doesn't work for that customer. \n\nWindow.name is not touched. Keep in mind that it works pretty much everywhere except for that customer's Mac.\n\nHave to get back to it with the videos, we have to ask our customer to make the videe.\n",
        "created_at": "2025-04-07T12:46:06Z"
      },
      {
        "author": "sanchitagarwal-msft",
        "body": "This issue has been fixed. Can you confirm on your side?",
        "created_at": "2025-04-18T09:43:24Z"
      },
      {
        "author": "Visualq",
        "body": "We can confirm it works now. Thank you for your effort.\n\nWas it something we could have prevented?",
        "created_at": "2025-04-18T13:08:58Z"
      }
    ]
  },
  {
    "number": 5478,
    "title": "Excel Add-In Input Text Fields Not focusing after click",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\nIn Excel Office Add-In all input text fields not focusing than you click on them, all fields switch you to the main sheet.\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform: PC desktop,\n* Host: Excel\n* Office version number: Version 2502\n* Operating System: Windows 11 Enterprise\n \n## Expected behavior\nInput text box should be able to focus\n\n## Current behavior\nIn Excel Office Add-In all input text fields not focusing than you click on them, all fields switch you to the main sheet.\n![Image](https://github.com/user-attachments/assets/e08fff60-51e7-4b64-a990-610fb29df241)\n\n## Steps to reproduce\nIn excel add-in create taskpane.html file and add any <input>\n\n\n![Image](https://github.com/user-attachments/assets/014b84cf-0df9-4d4f-a36d-2c67900fe225)\n\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\n1. Similar issue to https://github.com/OfficeDev/office-js/issues/5476\n2. Also here similar https://github.com/OfficeDev/office-js/issues/5471\n\n## Context\nAfter Excel update our company excel add-in get this problems",
    "created_at": "2025-03-12T07:29:43Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Excel",
      "Platform: Desktop"
    ],
    "author": "ptrostianko",
    "comments": [
      {
        "author": "guoms1",
        "body": "Hi, @ptrostianko \n\nI'm sorry to hear you're experiencing this issue. I wasn't able to reproduce the problem on Excel Desktop build 5203, so it appears that the issue may have been resolved in this build. To help clarify, I recorded a video that shows both the HTML code I used and a live demo of the Excel add-in's Taskpane. I hope you find this helpful.\n\nPlease let me know if you have any further questions or need additional assistance.\n\nBest regards,\n\nhttps://github.com/user-attachments/assets/de7de56f-70af-4833-b295-11f2be699238",
        "created_at": "2025-03-12T08:53:51Z"
      },
      {
        "author": "ptrostianko",
        "body": "@guoms1 Our version is 2502. This currently last version we can update\n\n![Image](https://github.com/user-attachments/assets/fdef9e5e-29eb-4c00-813e-cd42089476b2)\n\nAlso please watch this video showing bug:\n\nhttps://streamable.com/nc0lvf\n\n[video](https://streamable.com/nc0lvf)",
        "created_at": "2025-03-12T09:11:50Z"
      },
      {
        "author": "guoms1",
        "body": "Hi, @ptrostianko \n\nThank you for the update.\n\nI've learned that this issue is impacting a significant number of users on build 5202, though not everyone is affected. This suggests that build 5203 might also be at risk. We're actively investigating the problem and working on a resolution, and we'll update you as soon as we have more information.\n\nBest regards,",
        "created_at": "2025-03-12T10:47:39Z"
      },
      {
        "author": "demkantor",
        "body": "we are finding this same issue only with outlook classic desktop addins - they work fin in new outlook and browser",
        "created_at": "2025-03-12T15:57:07Z"
      },
      {
        "author": "gmichaud",
        "body": "Same issue here as well getting reported by our clients.\n\nRecording: https://youtu.be/uKz9GQMQLaM\n\n",
        "created_at": "2025-03-12T18:06:03Z"
      },
      {
        "author": "gmichaud",
        "body": "For anyone facing this issue: this is related to Edge WebView, and a fix is being deployed today apparently: https://github.com/MicrosoftEdge/WebView2Feedback/issues/5144",
        "created_at": "2025-03-13T12:13:16Z"
      },
      {
        "author": "trigurl",
        "body": "Hello folks please refer to https://github.com/MicrosoftEdge/WebView2Feedback/issues/5144\n\n1) Try updating to yesterday's version of 134.0.3124.68 WebView2 Runtime.\nhttps://developer.microsoft.com/en-us/microsoft-edge/webview2/?form=MA13LH\n\n2) Try again after shutting down all WV2 instances by \"tskill msedgewebview2*\" or rebooting your machine.\n\nCan you see if this works?",
        "created_at": "2025-03-14T19:02:21Z"
      },
      {
        "author": "guoms1",
        "body": "Close this issue as it has could be fixed by patching with the latest Edge WebView runtime.",
        "created_at": "2025-03-18T06:34:56Z"
      }
    ]
  },
  {
    "number": 5477,
    "title": "Smart Alerts OnSend - OWA & New Outlook showing additional button when 'cancelLabel'/'commandId' set",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n\nIn OWA & New Outlook, when setting the `cancelLabel` property and `commandId`, an additional button is appearing instead of the `Don't Send` button being relabelled. In Mac and Classic Outlook, this works appropriately.\n\nOWA/New Outlook for Windows\n![Image](https://github.com/user-attachments/assets/e3d29eff-4a39-4a09-ace1-6fe1f790088a)\n\nMac:\n\n![Image](https://github.com/user-attachments/assets/70a62dd0-11e6-40f1-be5b-3ecc5b5baa4f)\n\nClassic Outlook for Windows\n\n<img width=\"417\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/9b9f2b9a-809b-4973-9c3f-1c8fc9b2da7b\" />\n\n\nPer the documentation, the `cancelLabel` property should relabel the button, not make a new button \n\nhttps://learn.microsoft.com/en-us/office/dev/add-ins/outlook/smart-alerts-onmessagesend-walkthrough?tabs=jsonmanifest#modify-the-dont-send-button-text-and-functionality\n\n## Your Environment\nOutlook on the Web\n\nNew Outlook details:\nMicrosoft Outlook Version: 1.2025.219.400 (Production)\nClient Version: 20250228007.08\nWebView2 Version: 133.0.3065.92 (Stable)\nSession ID: cadb4a8e-8a5d-0947-9f09-f47d18ad9798\nRelease Channel: Targeted Release\n \nClassic Outlook for Windows:\nMicrosoft® Outlook® for Microsoft 365 MSO (Version 2502 Build 16.0.18526.20144) 64-bit\n\nMac Outlook:\nVersion 16.94.1 (25021618)\n\n## Expected behavior\nWhen setting the `cancelLabel` and `commandId` properties, the `Don't Send` button should be relabelled and connected to the taskpane.\n\n## Current behavior\nFor OWA and New Outlook for Windows, the `Don't Send` button is not relabelled, a new button is added with the label.\n\n## Steps to reproduce\nHave an OnMessageSend smart alerts addin that calls `eventCompleted` with the `cancelLabel` and a `commandId` set. Notice in OWA and New Outlook this creates a new button on the dialog with the label, and in Mac and Classic Outlook for Windows this relabels the Don't Send button.\n\n\n\n## Context\nWe have our `Don't Send` button connected to a taskpane. We don't want users to have the option to don't send without opening the task pane, so the separate button showing up in OWA/New Outlook is hampering this as a user can bypass the task pane and click `Don't Send`.\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [ ] Screenshots\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-03-11T16:31:11Z",
    "state": "closed",
    "labels": [
      "Area: Outlook",
      "Needs: author feedback",
      "Status: no recent activity"
    ],
    "author": "alexm-plutoflume",
    "comments": [
      {
        "author": "alexm-plutoflume",
        "body": "I see documentation has been updated today with the new mailbox requirement set which includes this new behavior.\n\nI still question this - if we have a 'Block' add-in and have a taskpane connected, I really think think the user's only option should be to open the taskpane and view the required content there. With this new two button format, it's possible for users to bypass required information in a taskpane.",
        "created_at": "2025-03-12T09:48:43Z"
      },
      {
        "author": "rkpathak",
        "body": "@alexm-plutoflume We are checking on this UI difference. Will get back to you.",
        "created_at": "2025-03-16T12:28:38Z"
      },
      {
        "author": "arpitsangwanmsft",
        "body": "Hey @alexm-plutoflume!\n \nThis is an intentional change we have made so that \"Don't Send\" is always visible to the user. The documentation has been updated [here](https://learn.microsoft.com/en-us/office/dev/add-ins/outlook/smart-alerts-onmessagesend-walkthrough?tabs=jsonmanifest#customize-the-text-and-functionality-of-a-button-in-the-dialog-optional). Do note that this does not change any functionality from before, as users were able to dismiss the dialog (same as the \"Don't Send\" behaviour) by clicking on the cross button to close the dialog.\n\nFor reference: \n\n![Image](https://github.com/user-attachments/assets/4a7325ae-cd7f-49b5-91ef-6bb4a96c367a)\n\nThanks",
        "created_at": "2025-03-19T07:11:39Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it is marked as needing author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. Thank you for your interest in Office Add-ins!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-03-23T17:40:30Z"
      },
      {
        "author": "microsoft-github-policy-service[bot]",
        "body": "This issue has been closed due to inactivity. Please comment if you still need assistance and we'll re-open the issue.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "created_at": "2025-03-26T19:21:18Z"
      }
    ]
  },
  {
    "number": 5476,
    "title": "Input control not able to get focus",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\nIn office addin, input control is not able to get focus, when click on input box, focus goes to excel cell.\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n* Platform [PC desktop, Mac, iOS, Office on the web]: PC Desktop\n* Host [Excel, Word, PowerPoint, etc.]: Excel\n* Office version number: Microsoft® Excel® for Microsoft 365 MSO (Version 2502 Build 16.0.18526.20144) 64-bit \n* Operating System: windows 11 Pro\n* Browser (if using Office on the web): it works fine in web version\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nInput box should be able to get focus\n## Current behavior\n<!--- Tell us what happens instead of the expected behavior -->\n<!--- If suggesting a change/improvement, explain the difference from current behavior -->\nwhen click on input box and start typing, focus goes to Excel cell and key stroke typed in excel cells only\n## Steps to reproduce\n<!--- If we cannot reproduce the issue, we cannot triage -->\n1. npm install -g yo generator-office\n2. yo office\n3.choose project type - Office Add-in Task Pane project\n4. Script type - javascript\n5.  name your add-in - any name which you wish. e.g. \"My Office Addins\"\n6.  cd \"My Office Addins\"\n7. open taskpane.html file and remove all elements from body and add form and input\n8.  \n\n<img width=\"783\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/679ff1d6-e2a6-433c-ba94-a14c1b5209e6\" />\n\n9. start webpack by \"npm start\" on terminal\n10. it will open excel and plugin\n11. click on inputbox, focus will go to excel cell\n12. \n\n<img width=\"957\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/63f0bd14-4bea-488a-8333-c762423997dd\" />\n\n13. # Link to live example(s)<!--- Ideally, provide a link to a live example, created and shared using --><!--- [Script Lab](https://aka.ms/scriptlab). If relevant, create two buttons, --><!--- one that sets up data in the document, and another that exemplifies the issue. -->\n\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\n\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\nthis is blocker as it cannot handle any user input in excel addins\n\nhttps://github.com/user-attachments/assets/d64e9d8b-6f11-43b7-806d-09cb6da61201\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [ ] Screenshots\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-03-11T15:40:06Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Excel",
      "Platform: Desktop"
    ],
    "author": "djsakariya",
    "comments": [
      {
        "author": "graysenpack",
        "body": "We are seeing the same problem with our Microsoft Word Add-in. I'm attaching a video of some troubleshooting we did recently. This only appears to be happening with Windows users.\n\nhttps://www.loom.com/share/c4f05885ca8d4a89874a4418056a20de",
        "created_at": "2025-03-11T16:33:50Z"
      },
      {
        "author": "graysenpack",
        "body": "Another similar report to this: https://github.com/OfficeDev/office-js/issues/5471",
        "created_at": "2025-03-11T16:35:30Z"
      },
      {
        "author": "PauliusMilmantas",
        "body": "This is a critical issue for us and our clients also.",
        "created_at": "2025-03-12T06:58:48Z"
      },
      {
        "author": "ptrostianko",
        "body": "In our excel add-in we have same issue all input text fields not focusing, than you click on them.\n\n![Image](https://github.com/user-attachments/assets/8f6c5b03-e0c2-44fd-a43d-32250c19e238)",
        "created_at": "2025-03-12T07:15:21Z"
      },
      {
        "author": "guoms1",
        "body": "Hi, all\n\nI'm sorry to hear you're experiencing this issue. I wasn't able to reproduce the problem on Excel Desktop build 5203, so it appears that the issue may have been resolved in this build. To help clarify, I recorded a video that shows both the HTML code I used and a live demo of the Excel add-in's Taskpane. I hope you find this helpful.\n\nPlease let me know if you have any further questions or need additional assistance.\n\nBest regards,\n\nhttps://github.com/user-attachments/assets/b23565ab-78eb-4132-8c96-0de427b606ce",
        "created_at": "2025-03-12T08:52:50Z"
      },
      {
        "author": "djsakariya",
        "body": "@guoms1 \nmy excel version is up to date and i still facing this issue.\n\nThis works fine on my colleague's machine having same version.\n\n<img width=\"494\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/e10966c7-9039-46a9-8ce5-a466eedec2ad\" />",
        "created_at": "2025-03-12T10:41:00Z"
      },
      {
        "author": "guoms1",
        "body": "Hi, @djsakariya \n\nThank you for the update.\n\nI've learned that this issue is impacting a significant number of users on build 5202, though not everyone is affected. This suggests that build 5203 might also be at risk. We're actively investigating the problem and working on a resolution, and we'll update you as soon as we have more information.\n\nBest regards,",
        "created_at": "2025-03-12T10:53:05Z"
      },
      {
        "author": "trigurl",
        "body": "Hello folks please refer to https://github.com/MicrosoftEdge/WebView2Feedback/issues/5144\n\n1) Try updating to yesterday's version of 134.0.3124.68 WebView2 Runtime.\nhttps://developer.microsoft.com/en-us/microsoft-edge/webview2/?form=MA13LH\n\n2) Try again after shutting down all WV2 instances by \"tskill msedgewebview2*\" or rebooting your machine.\n\nCan you see if this works?",
        "created_at": "2025-03-14T19:01:26Z"
      },
      {
        "author": "djsakariya",
        "body": "@trigurl it works as expected with 134.0.3124.68 WebView2 Runtime.\nThanks",
        "created_at": "2025-03-17T04:20:27Z"
      },
      {
        "author": "Shukla-Dev",
        "body": "if I already have webview2 runtime in system how can I install fixed one in windows ?",
        "created_at": "2025-03-17T12:10:38Z"
      },
      {
        "author": "guoms1",
        "body": "Hi, @Shukla-Dev\n\nYou could patch your webview2 runtime with the instructions mentioned by [trigurl](https://github.com/trigurl). I copied the instructions here:\n\nHello folks please refer to https://github.com/MicrosoftEdge/WebView2Feedback/issues/5144\n\nTry updating to yesterday's version of 134.0.3124.68 WebView2 Runtime.\nhttps://developer.microsoft.com/en-us/microsoft-edge/webview2/?form=MA13LH\n\nTry again after shutting down all WV2 instances by \"tskill msedgewebview2*\" or rebooting your machine.",
        "created_at": "2025-03-18T06:30:59Z"
      }
    ]
  },
  {
    "number": 5475,
    "title": "Ability to Hide or Overlay Email Body for Categorized Emails in Outlook Read Mode",
    "body": "I am developing an Outlook add-in and my client wants to overlay or hide the email body when an email is categorized under a specific category (e.g., \"Red Category\") in read mode.\n\nCurrently, it seems that modifying the email body in read mode is not possible due to API limitations. I would like to request either:\n\nA feature that allows developers to overlay or blur the email body in read mode based on specific conditions.\nAn alternative approach to achieving the same functionality within the Outlook Add-in framework.\nThe primary goal is to restrict visibility of the email body for emails under certain categories while maintaining normal access to other email metadata.\n\nIs there any workaround or planned enhancement in Office.js that could help achieve this functionality?\n\nEnvironment:\n\nOutlook Add-in\nOffice.js API\nReact.js / TypeScript\nLooking forward to your guidance on this. Thank you!\n\n",
    "created_at": "2025-03-11T14:17:38Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Outlook"
    ],
    "author": "CodeWithAbuBakr",
    "comments": []
  },
  {
    "number": 5474,
    "title": "Cursor is below Embeded Signature whe using  SetSignatureAsync in New outlook  (in owa its work as expected)",
    "body": "<!--- Provide a general summary of the issue in the Title above -->\n# Provide required information needed to triage your issue\n\n## Your Environment\n<!--- Include as many relevant details about the environment so we can triage your issue -->\n*Pc Desktop \n* new outlook \nMicrosoft Outlook Version: 1.2025.219.400 (Production)\nClient Version: 20250228007.08\nWebView2 Version: 133.0.3065.92 (Stable)\nSession ID: 349d2f01-85ed-467e-8fe3-369e6be99bc5\n* Office version number:  365\n* Operating System: WIndows 10 \n* Browser (if using Office on the web): ______\n \n## Expected behavior\n<!--- Tell us what you expected to happen -->\nShould be working  the same as in web version:\nCursor need to be on first line of message after  Embeding Signature when reply all/forward is used  \n## Current behavior\nCursor is below Embeded Signature whe using  SetSignatureAsync in New outlook  in owa its work as expected\n\n## Steps to reproduce\nthis simple function is used to embed html content into signature this will work good on web version but on outlook (new) the cursosr is below the signature\n\n![Image](https://github.com/user-attachments/assets/c5cb3593-7dc4-4aa5-beb3-fd12c8821262)\n\nfunction saveBody(updatedContent, callback) {\n  Office.context.mailbox.item.body.setSignatureAsync(updatedContent, { coercionType: Office.CoercionType.Html }, function (asyncResult) {\n    if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\n      console.log(\"Signature updated successfully.\");\n    } else {\n      console.error(\"Failed to update signature:\", asyncResult.error.message);\n    }\n    // Always call the callback to complete the event\n    callback();\n  });\n\n## Link to live example(s)\n<!--- Ideally, provide a link to a live example, created and shared using -->\n<!--- [Script Lab](https://aka.ms/scriptlab). If relevant, create two buttons, -->\n<!--- one that sets up data in the document, and another that exemplifies the issue. -->\n1. ______\n2. ______\n3. ______\n\n# Provide additional details\n<!--- If the snippet requires extra explanation, provide repro steps: -->\n1. ______\n2. ______\n3. ______\n\n## Context\n<!--- How has this issue affected you? What are you trying to accomplish? -->\n<!--- Providing context helps us come up with a solution that is most useful in the real world -->\n\n## Useful logs\n<!--- Please include any of the following logs that may help us debugging your issue -->\n- [ ] Console errors\n- [ ] Screenshots\n- [ ] Test file (if only happens on a particular file)\n\nThank you for taking the time to report an issue. Our triage team will respond to you in less than 72 hours. Normally, response time is <10 hours Monday through Friday. We do not triage on weekends. \n",
    "created_at": "2025-03-11T09:16:32Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Outlook",
      "Similar-Issue",
      "Possible-Solution"
    ],
    "author": "zeeveladzim",
    "comments": [
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #4267\n- #4758\n- #1631\n- #1910\n- #3290\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nThanks for reporting this issue regarding Signature API. It has been put on our backlog. We unfortunately have no timelines to share at this point.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4758#issuecomment-2300969355\n### Solution 2:\nThe rollout for this fix is now complete and the change is available in client version [20240520053] or greater.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/4267#issuecomment-2151318239\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-11T09:17:32Z"
      },
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #4267\n- #1631\n- #1910\n- #3290\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nThanks for reporting the issue. It has been put on our backlog. We unfortunately have no timelines to share at this point.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3290#issuecomment-1506338995\n### Solution 2:\nWe have updated the documentation here: https://learn.microsoft.com/en-us/javascript/api/outlook/office.body?view=outlook-js-preview. Resolving the issue.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/3290#issuecomment-1841990925\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-11T09:18:43Z"
      },
      {
        "author": "github-actions[bot]",
        "body": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #1910\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\nWe have fixed the bug, and the fix should be available in the next ~2 weeks. Closing the bug, please feel free to reactivate the thread if you have any comments.\n\n**Reference**:\n- https://github.com/officedev/office-js/issues/1910#issuecomment-919718535\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
        "created_at": "2025-03-11T09:18:49Z"
      },
      {
        "author": "arpitsangwanmsft",
        "body": "Hey @zeeveladzim!\nWe could not repro the mentioned issue in New Outlook. We've tried reproducing with following assuming that setSignatureAsync is being called with a onNewMessageCompose type of addin here but the cursor focus stays on first line. Its not a repro in owa/ New outlook for any of the new message compose / reply / replyAll / forward scenarios.\n\nCan you please provide us with a recording of the repro scenario for clear steps along with a sample addin (if possible), where the issue can be reproduced?\n",
        "created_at": "2025-03-12T08:40:13Z"
      },
      {
        "author": "zeeveladzim",
        "body": "https://github.com/user-attachments/assets/4dacd3e6-d087-40cc-af09-88cafacc8cc7",
        "created_at": "2025-03-12T10:13:30Z"
      },
      {
        "author": "zeeveladzim",
        "body": "I was able  to solve  this issue  was related to cache ,but not outlook cache  \nthere was a cache issue coming from webedge process \nthis was located here:\n%AppData%\\Local\\Microsoft\\Olk\\EBWebView\nthis was  only hapening on my device which was also the device I was developing on so might be related to some debug deployment that was cached  ",
        "created_at": "2025-03-16T07:43:46Z"
      }
    ]
  },
  {
    "number": 5473,
    "title": "Office.js for Excel addin",
    "body": "We are using Office.js for our add-in in Excel. We are trying to use getFileAsync like in this method and we are using Office online\n\n\nIn word it works fine but in Excel it gives a status succeed but the size is 0 and slice still 0 \n\n-Office.FileType.Pdf -> it doesn't work , but it what we need and in docs it's written that is supported.\n\n-Office.FileType.Compressed -> it works but we don't need it .\n\n`async loadFileBlob(officeDoc: OfficeDoc): Promise<OfficeDoc> {\n        const Office = (window as any).Office;\n\n        return new Promise((resolve, reject) => {\n            Office.context.document.getFileAsync(\n                Office.FileType.Pdf,\n                { sliceSize: 65536 },\n                async (asyncResult: any) => {\n                    if (asyncResult.status === Office.AsyncResultStatus.Failed) {\n                        reject(asyncResult);\n                        return;\n                    }\n                    console.log(asyncResult)\n                    const file = await asyncResult.value;\n\n                    if(file.size === 0) {\n                        this.stateService.setErrorMessage($localize`We couldn't retrieve the file`)\n                        return\n                    }\n\n                    // Prevent files larger than 10MB\n                    if (file.size > 10485760) {\n                        file.closeAsync();\n                        reject({ error: 'File too large', size: file.size });\n                        return;\n                    } \n                    try {\n                        const docData = await this.getAllSlices(file);\n                        const mergedData = this.mergeUint8Arrays(docData);\n\n                        //Ensure the PDF blob is properly created\n                        officeDoc.blob = new Blob([mergedData], { type: 'application/pdf' });\n\n                        resolve(officeDoc);\n                    } catch (err) {\n                        reject(err);\n                    } finally {\n                        file.closeAsync();\n                    }\n                }\n            );\n        });\n    }`\n\n\n\nThis is the result , I tried with different files.\n\n`{\n    \"status\": \"succeeded\"\n    \"value\": {\n        \"size\": 0,\n        \"sliceCount\": 0\n    },\n    \"status\": \"succeeded\"\n}`",
    "created_at": "2025-03-11T09:10:36Z",
    "state": "closed",
    "labels": [
      "Needs: attention :wave:",
      "Area: Excel",
      "Platform: Online"
    ],
    "author": "cristrasp",
    "comments": [
      {
        "author": "guoms1",
        "body": "Hi, @cristrasp \n\nI'm sorry, but I wasn't able to reproduce your issue. In Excel Online, even with the PDF format, I get the correct size and sliceCount. \n\nI've recorded a video to give you a clear view of the behavior at my side, and I've attached [my demo project](https://github.com/user-attachments/files/19181658/GH5473.zip) to help you quickly pinpoint the problem.\n\nIf you have any further questions, please feel free to let me know. If everything seems to be working fine on your end, kindly close the issue or leave a note confirming that it's resolved.\n\nBest regards,\n\nhttps://github.com/user-attachments/assets/048e742b-bb4b-470b-b610-ab50e34a54c1\n\n",
        "created_at": "2025-03-11T11:12:16Z"
      },
      {
        "author": "cristrasp",
        "body": "thank you very much , will come back soon ",
        "created_at": "2025-03-11T11:59:41Z"
      },
      {
        "author": "cristrasp",
        "body": "Hi @guoms1  can you tell me please what build of excel are you using? ",
        "created_at": "2025-03-11T12:21:33Z"
      },
      {
        "author": "guoms1",
        "body": "I am using Excel Online and its version is:\n\n![Image](https://github.com/user-attachments/assets/2c5d831c-a0bb-4597-b87d-e6667188b3e7)",
        "created_at": "2025-03-11T13:05:59Z"
      },
      {
        "author": "cristrasp",
        "body": "Solved the issue , our organization had an old build version. issue closed",
        "created_at": "2025-03-11T13:17:39Z"
      }
    ]
  }
]